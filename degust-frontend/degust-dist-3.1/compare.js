!function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0](function(b){var e=a[c][1][b];return d(e||b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f])}({1:[function(a,b,c){(function(){a("./lib/bootstrap-tour.js"),a("./lib/numeric-1.2.6.js"),a("./print.coffee"),a("./slider.coffee"),a("./gene_table.coffee"),a("./parcoords.coffee"),a("./scatter-plot.coffee"),a("./ma-plot.coffee"),a("./volcano-plot.coffee"),a("./heatmap.coffee"),a("./bargraph.coffee"),a("./scatter3d.coffee"),a("./pca.coffee"),a("./kegg.coffee"),a("./tour.coffee"),a("./edit-list.coffee"),a("./normalize.coffee"),a("./qc.coffee"),a("./gene-expression.coffee"),a("./compare.coffee")}).call(this)},{"./lib/bootstrap-tour.js":2,"./lib/numeric-1.2.6.js":3,"./slider.coffee":4,"./print.coffee":5,"./gene_table.coffee":6,"./parcoords.coffee":7,"./scatter-plot.coffee":8,"./ma-plot.coffee":9,"./volcano-plot.coffee":10,"./heatmap.coffee":11,"./bargraph.coffee":12,"./scatter3d.coffee":13,"./pca.coffee":14,"./tour.coffee":15,"./kegg.coffee":16,"./edit-list.coffee":17,"./normalize.coffee":18,"./qc.coffee":19,"./gene-expression.coffee":20,"./compare.coffee":21}],4:[function(a,b,c){(function(){var a;a=function(){function a(a){var b,c=this;this.opts=a,this.stepValues=this.opts.step_values||[0,1,2,3,4,5,6,7,8,9,10],this.slider=$(this.opts.id).slider({animate:!0,min:0,max:this.stepValues.length-1,value:1,slide:function(a,b){var d;return d=c.stepValues[b.value],$(c.opts.input_id).val(c.fmt(d)),c.opts.on_change(d)}}),null!=this.opts.val&&this.set_val(this.opts.val),b=this,$(this.opts.input_id).keyup(function(){var a;return a=$(this).val(),b.opts.validator(a)?($(this).removeClass("error"),b.set_slider(a),b.opts.on_change(a)):$(this).addClass("error")})}return a.prototype.set_slider=function(a){var b;return b=0,$.each(this.stepValues,function(c,d){if(d<=a)return b=c}),this.slider.slider("value",b)},a.prototype.fmt=function(a){var b;return null!=this.opts.fmt?this.opts.fmt(a):(b=Number(a),void 0===b?a:b>0&&b<.001?b.toExponential(0):a)},a.prototype.set_max=function(a,b,c,d){var e;return d?(this.stepValues=[0,1,2,3,4,5,10,20,100,200,Math.floor(c/3),Math.floor(c/2),c],this.stepValues=this.stepValues.filter(function(a){return a>=b&&a<=c})):this.stepValues=function(){var a,d;for(d=[],e=a=b;a<=c;e=a+=10)d.push(e);return d}(),this.slider.slider("option","max",this.stepValues.length-1),this.set_slider(a),$(this.opts.input_id).val(this.fmt(a)),this.opts.on_change(a)},a.prototype.set_val=function(a,b){if($(this.opts.input_id).val(this.fmt(a)),this.set_slider(a),null!=b)return this.opts.on_change(a)},a}(),window.Slider=a}).call(this)},{}],5:[function(a,b,c){(function(){var a;a=function(){function a(a,b){this.svg=a,this.name=b}return a.prototype.menu=function(){var a=this;return[{title:"Save as SVG",action:function(){return a._to_svg()}},{title:"Save as PNG",action:function(){return a._to_png()}}]},a.prototype._get_svg=function(){var a;return a=this.svg,"function"==typeof a&&(a=a()),a instanceof d3.selection&&(a=a.node()),"svg"in a?[a.svg,a.width,a.height]:[a,a.clientWidth,a.clientHeight]},a.prototype._to_svg=function(){var a,b,c,d,e;return b='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',d=(new XMLSerializer).serializeToString(this._get_svg()[0]),a=new Blob([b+d],{type:"image/svg+xml;charset=utf-8"}),e=window.URL.createObjectURL(a),c=document.createElement("a"),c.href=e,c.download=this.name+".svg",document.body.appendChild(c),c.click(),document.body.removeChild(c)},a.prototype._to_png=function(){var a,b,c,d,e,f,g=this;return a=d3.selectAll(".print-backdrop").data([1]).enter().append("div").attr("class","print-backdrop"),b=d3.selectAll(".print-popup").data([1]).enter().append("div").attr("class","print-popup").style("display","block"),f=this._get_svg(),f[0],e=f[1],d=f[2],e||(e=300),d||(d=300),b.html("<form>                   <div><label>File name</label><input class='pr-name' value='"+this.name+"'/></div>                   <div><label>Width</label><input class='pr-width' value='"+e+"'/></div>                   <div><label>Height</label><input class='pr-height' value='"+d+"'/></div>                   <div><button class='submit' type='submit'>Save</button><button class='cancel' type='submit'>Cancel</button></div>                 </form>"),c=function(){return b.remove(),a.remove()},a.on("click",function(){return d3.event.preventDefault(),c()}),b.select(".submit").on("click",function(){var a;return d3.event.preventDefault(),a=b.select(".pr-name").node().value,e=b.select(".pr-width").node().value,d=b.select(".pr-height").node().value,c(),g._to_png_finish(a,e,d)}),b.select(".cancel").on("click",function(){return d3.event.preventDefault(),c()})},a.prototype._to_png_finish=function(a,b,c){var d,e,f,g;return g=(new XMLSerializer).serializeToString(this._get_svg()[0]),d=document.createElement("canvas"),e=d.getContext("2d"),f=document.createElement("img"),f.width=d.width=b,f.height=d.height=c,f.setAttribute("src","data:image/svg+xml;base64,"+btoa(g)),f.onload=function(){var b,c;return e.drawImage(f,0,0,f.width,f.height),c=d.toDataURL("image/png"),b=document.createElement("a"),b.download=a+".png",b.href=c,document.body.appendChild(b),b.click(),document.body.removeChild(b)}},a.copy_svg_style_deep=function(b,c){var d,e,f,g,h,i;for(a.copy_svg_style(b,c),f=b.node().childNodes,d=c.node().childNodes,f.length!==d.length&&console.log("Mismatch number of children!"),i=[],e=g=0,h=f.length;0<=h?g<h:g>h;e=0<=h?++g:--g)f[e].nodeType===Node.ELEMENT_NODE?i.push(a.copy_svg_style_deep(d3.select(f[e]),d3.select(d[e]))):i.push(void 0);return i},a.copy_svg_style=function(a,b){return"hidden"===a.style("visibility")?b.style("display","none"):"text"===a.node().tagName?(["font-size","font-family"].forEach(function(c){return b.style(c,a.style(c))}),["dx","dy"].forEach(function(a){var c;if(c=/(.*)em/.exec(b.attr(a)))return b.attr(a,10*c[1])})):["rect","line","path"].indexOf(a.node().tagName)>=0?["fill","stroke","fill-opacity","display"].forEach(function(c){return b.style(c,a.style(c))}):void 0},a}(),window.Print=a}).call(this)},{}],9:[function(a,b,c){(function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a){var c,d=this;this.opts=a,null==(c=this.opts).name&&(c.name="MA-plot"),b.__super__.constructor.call(this,this.opts),this.tooltip=d3.select(this.opts.elem).append("div").attr("class","tooltip").style("opacity",0),this.on("mouseover.tooltip",function(a,b,c){return d._show_info(a,b)}),this.on("mouseout.tooltip",function(){return d._hide_info()})}return c(b,a),b.prototype.update_data=function(a,c,d,e,f,g){return this.avg_col=c,this.logfc_col=d,this.info_cols=f,this.fdr_col=g,b.__super__.update_data.call(this,a,{name:"Ave Expr",get:function(a){return a[c.idx]}},{name:"log FC",get:function(a){return a[d.idx]}},e)},b.prototype._show_info=function(a,b){var c,d,e,f;return c=function(a){return a.toFixed(2)},d=function(a){return a<.01?a.toExponential(2):a.toFixed(2)},this.tooltip.transition().duration(200).style("opacity",.8),e="<table>",f=a[0],this.info_cols.forEach(function(a){return e+="<tr><td><b>"+a.name+"</b>:<td>"+f[a.idx]}),e+="<tr><td><b>Ave Expr</b>:<td>"+c(f[this.avg_col.idx]),e+="<tr><td><b>log FC</b>:<td>"+c(f[this.logfc_col.idx]),e+="<tr><td><b>FDR</b>:<td>"+d(f[this.fdr_col.idx]),e+="</table>",a.length>1&&(e+="(And "+(a.length-1)+" other"+(a.length>2?"s":"")+")"),this.tooltip.html(e).style("left",b[0]+40+"px").style("top",b[1]+35+"px")},b.prototype._hide_info=function(){return this.tooltip.style("opacity",0)},b}(ScatterPlot),window.MAPlot=a}).call(this)},{}],7:[function(a,b,c){(function(){var a;a=function(){function a(a){this.opts=a,null!=this.opts.width&&d3.select(this.opts.elem).style("width",this.opts.width),this.parcoords=d3.parcoords()(this.opts.elem).alpha(.4).reorderable().brushable().mode("queue"),this.parcoords.setFilter(this.opts.filter)}return a.prototype.update_data=function(b,c,d,e){var f,g,h=this;return f={},c.forEach(function(a){return f[a.idx]=a.name}),this.parcoords.data(b).dimensions(c.map(function(a){return a.idx})).dimension_names(f).autoscale(),e&&this.parcoords.color(e),null==d&&(d=a.calc_extent(b,c)),g=this.parcoords.height()-this.parcoords.margin().top-this.parcoords.margin().bottom,this.parcoords.dimensions().forEach(function(a){return h.parcoords.yscale[a]=d3.scale.linear().domain(d).range([g+1,1])}),this.parcoords.createAxes().render().reorderable().brushable(),this.parcoords.render(),this.parcoords.brush()},a.calc_extent=function(a,b){var c,d;return d=[],b.forEach(function(b){return d.push(d3.extent(a,function(a){return+a[b.idx]}))}),c=d3.extent(d3.merge(d)),c.map(function(a){return 1.05*a})},a.prototype.dimensions=function(){return this.parcoords.dimensions()},a.prototype.dimension_names=function(){return this.parcoords.dimension_names()},a.prototype.highlight=function(a){return this.parcoords.highlight(a)},a.prototype.unhighlight=function(){return this.parcoords.unhighlight()},a.prototype.on=function(a,b){return this.parcoords.on(a,b)},a.prototype.brush=function(){return this.parcoords.brush()},a}(),window.ParCoords=a}).call(this)},{}],6:[function(a,b,c){(function(){var a;a=function(){function a(a){var b,c=this;this.opts=a,b={enableCellNavigation:!0,enableColumnReorder:!1,multiColumnSort:!1,forceFitColumns:!0,enableTextSelectionOnCells:!0},this.dataView=new Slick.Data.DataView,this.grid=new Slick.Grid(this.opts.elem,this.dataView,[],b),this.opts.filter&&this.dataView.setFilter(this.opts.filter),this.dataView.onRowCountChanged.subscribe(function(a,b){return c.grid.updateRowCount(),c.grid.render(),c._update_info()}),this.dataView.onRowsChanged.subscribe(function(a,b){return c.grid.invalidateRows(b.rows),c.grid.render()}),this.grid.onSort.subscribe(function(a,b){return c.opts.sorter(b)}),this.grid.onViewportChanged.subscribe(function(a,b){return c._update_info()}),this.opts.mouseover&&this.grid.onMouseEnter.subscribe(function(a,b){var d,e;return e=c.grid.getCellFromEvent(a).row,d=c.dataView.getItem(e),c.opts.mouseover(d)}),this.opts.mouseout&&this.grid.onMouseLeave.subscribe(function(a,b){return c.opts.mouseout()}),this.opts.dblclick&&this.grid.onDblClick.subscribe(function(a,b){return c.opts.dblclick(c.grid.getDataItem(b.row))})}return a.prototype.resort=function(){return this.dataView.reSort()},a.prototype.sort=function(a){return this.dataView.sort(a)},a.prototype.get_data=function(){return this.dataView.getItems()},a.prototype.set_data=function(a,b){var c=this;return b?scheduler.schedule_now("gene_table",function(){return c.set_data_now(a,b)}):scheduler.schedule("gene_table",function(){return c.set_data_now(a)})},a.prototype.set_data_now=function(a,b){if(this.dataView.beginUpdate(),b&&this.grid.setColumns([]),this.dataView.setItems(a),this.dataView.reSort(),this.dataView.endUpdate(),b)return this.grid.setColumns(b),$("[title]",this.opts.elem).popover({trigger:"hover",placement:"top",container:"body",html:!0})},a.prototype.refresh=function(){return this.dataView.refresh()},a.prototype.invalidate=function(){return this.grid.invalidate()},a.prototype._update_info=function(){var a,b;return b=this.grid.getViewport(),a=d3.min([b.bottom,this.dataView.getLength()]),$(this.opts.elem_info).html("Showing "+b.top+".."+a+" of "+this.dataView.getLength())},a}(),window.GeneTable=a}).call(this)},{}],10:[function(a,b,c){(function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a){var c,d=this;this.opts=a,null==(c=this.opts).name&&(c.name="Volcano-plot"),b.__super__.constructor.call(this,this.opts),this.tooltip=d3.select(this.opts.elem).append("div").attr("class","tooltip").style("opacity",0),this.on("mouseover.tooltip",function(a,b,c){return d._show_info(a,b)}),this.on("mouseout.tooltip",function(){return d._hide_info()})}return c(b,a),b.prototype.update_data=function(a,c,d,e,f){return this.logfc_col=c,this.fdr_col=d,this.info_cols=f,b.__super__.update_data.call(this,a,{name:"log FC",get:function(a){return a[c.idx]}},{name:"-log10 FDR",get:function(a){return-Math.log10(a[d.idx])}},e)},b.prototype._show_info=function(a,b){var c,d,e,f;return c=function(a){return a.toFixed(2)},d=function(a){return a<.01?a.toExponential(2):a.toFixed(2)},this.tooltip.transition().duration(200).style("opacity",.8),e="<table>",f=a[0],this.info_cols.forEach(function(a){return e+="<tr><td><b>"+a.name+"</b>:<td>"+f[a.idx]}),e+="<tr><td><b>log FC</b>:<td>"+c(f[this.logfc_col.idx]),e+="<tr><td><b>FDR</b>:<td>"+d(f[this.fdr_col.idx]),e+="<tr><td><b>-log10 FDR</b>:<td>"+c(-Math.log10(f[this.fdr_col.idx])),e+="</table>",a.length>1&&(e+="(And "+(a.length-1)+" other"+(a.length>2?"s":"")+")"),this.tooltip.html(e).style("left",b[0]+40+"px").style("top",b[1]+35+"px")},b.prototype._hide_info=function(){return this.tooltip.style("opacity",0)},b}(ScatterPlot),window.VolcanoPlot=a}).call(this)},{}],8:[function(a,b,c){(function(){var a,b;b={axis:"axis",scatter:"scatter"},a=function(){function a(a){var c,d,e,f,g,h,i,j,k,l;this.opts=null!=a?a:{},null==(c=this.opts).name&&(c.name="scatter"),null==(d=this.opts).padding&&(d.padding=30),null==(e=this.opts).xaxis_loc&&(e.xaxis_loc="zero"),null==(f=this.opts).yaxis_loc&&(f.yaxis_loc="left"),null==(g=this.opts).colouring&&(g.colouring=function(){return"blue"}),null==(h=this.opts).alpha&&(h.alpha=function(){return.7}),null==(i=this.opts).size&&(i.size=function(){return 3}),null==(j=this.opts).filter&&(j.filter=function(){return!0}),null==(k=this.opts).brush_enable&&(k.brush_enable=!1),null==(l=this.opts).animate&&(l.animate=!1),this.elem=d3.select(this.opts.elem).append("div"),this.elem.attr("class",b.scatter),this.opts.width&&this.elem.style("width",this.opts.width+"px"),this.opts.height&&this.elem.style("height",this.opts.height+"px"),this.dispatch=d3.dispatch("brush","mouseover","mouseout"),this.opts.canvas?this.init_canvas():this.init_svg(),this.gHighlight=this.svg.append("g"),this.resize(),this._make_menu(this.opts.elem)}return a.prototype.resize=function(){return this.width=this.opts.width||this.elem.node().clientWidth,this.height=this.opts.height||this.elem.node().clientHeight,this.svg.attr("width",this.width).attr("height",this.height),this.gDot!==this.svg&&this.gDot.attr("width",this.width).attr("height",this.height),this.redraw()},a.prototype.init_canvas=function(){var a=this;return this._draw_dots=this._draw_dots_canvas,this.gDot=this.elem.append("canvas"),this.svg=this.elem.append("svg"),this.svg.style("pointer-events","none"),this.opts.brush_enable?(this.gBrush=this.svg.append("g"),this.gBrush.on("mousemove",function(){return a._mouse_move()}),this.gBrush.on("mouseout",function(){return a._mouse_out()})):(this.gDot.on("mousemove",function(){return a._mouse_move()}),this.gDot.on("mouseout",function(){return a._mouse_out()}))},a.prototype.init_svg=function(){var a=this;return this._draw_dots=this._draw_dots_svg,this.svg=this.elem.append("svg"),this.gDot=this.svg,this.opts.brush_enable?(this.svg.style("pointer-events","none"),this.gBrush=this.svg.append("g"),this.gBrush.on("mousemove",function(){return a._mouse_move()}),this.gBrush.on("mouseout",function(){return a._mouse_out()})):(this.gDot.on("mousemove",function(){return a._mouse_move()}),this.gDot.on("mouseout",function(){return a._mouse_out()}))},a.prototype.update_data=function(a,b,c,d){return this.data=a,this.xColumn=b,this.yColumn=c,this.colouring=d,this.redraw()},a.prototype.redraw=function(){var a,c,d,e,f,g,h,i,j=this;if(this.data)return this.svg.select("g.brush").remove(),this.svg.selectAll("."+b.axis).remove(),this.x_val=d=function(a){return j.xColumn.get(a)},this.y_val=h=function(a){return j.yColumn.get(a)},this.xScale=c=d3.scale.linear().domain(d3.extent(this.data,function(a){return d(a)}).map(function(a){return a})).range([this.opts.padding,this.width-this.opts.padding]),this.yScale=g=d3.scale.linear().domain(d3.extent(this.data,function(a){return h(a)}).map(function(a){return a})).range([this.height-this.opts.padding,this.opts.padding]),a=d3.svg.axis().scale(c).orient("bottom"),f=d3.svg.axis().scale(g).orient("left").ticks(5),this.opts.brush_enable&&(this.mybrush=d3.svg.brush().x(c).y(g).clamp([!1,!1]).on("brush",function(){return j._brushed()}),this.gBrush.call(this.mybrush)),this._draw_dots(this.colouring||this.opts.colouring),e=function(){switch(this.opts.xaxis_loc){case"bottom":return g.domain()[0];case"zero":return g.domain()[0]<0&&g.domain()[1]>0?0:g.domain()[0];default:return g.domain()[0]}}.call(this),i=function(){switch(this.opts.yaxis_loc){case"left":return c.domain()[0];case"zero":return c.domain()[0]<0&&c.domain()[1]>0?0:c.domain()[0];default:return c.domain()[0]}}.call(this),this.svg.append("g").attr("class",b.axis).attr("transform","translate(0,"+g(e)+")").call(a).append("text").attr("x",c.range()[1]).attr("y",-6).attr("fill","black").style("text-anchor","end").text(this._chooseOne(this.xColumn.name,this.opts.xLabel)),this.svg.append("g").attr("class",b.axis).attr("transform","translate("+c(i)+",0)").call(f).append("text").attr("transform","rotate(-90)").attr("x",-5).attr("y",5).attr("fill","black").attr("dy",".71em").style("text-anchor","end").text(this._chooseOne(this.yColumn.name,this.opts.yLabel))},a.prototype._make_menu=function(a){var b,c=this;return b=new Print(function(){return c._svg_for_print()},this.opts.name).menu(),d3.select(a).on("contextmenu",d3.contextMenu(b))},a.prototype._svg_for_print=function(){var b,c,d;return this.opts.canvas?(b=document.createElement("div"),b.setAttribute("id","scatter-print-holder"),document.body.appendChild(b),c=new a({elem:"#scatter-print-holder",filter:this.opts.filter,canvas:!1,height:300,width:600,xaxis_loc:this.opts.xaxis_loc,yaxis_loc:this.opts.yaxis_loc}),c.update_data(this.data,this.xColumn,this.yColumn,this.colouring),d=d3.select(c.svg.node().cloneNode(!0)),d.attr("class",""),Print.copy_svg_style_deep(c.svg,d),document.body.removeChild(b),{svg:d.node(),width:this.width,height:this.height}):this.svg.node()},a.prototype._chooseOne=function(a,b){return null!==a?"function"==typeof a?a():a:"function"==typeof b?b():b},a.prototype._draw_dots_canvas=function(a){var b,c,d,e=this;for(b=this.gDot.node().getContext("2d"),b.clearRect(0,0,this.opts.width,this.opts.height),c=this.data.length,d=[];c--;)d.push(function(c){var d,f,g,h;if(d=e.data[c],e.opts.filter(d)&&(b.fillStyle=a(d),b.globalAlpha=e.opts.alpha(d),h=[e.xScale(e.x_val(d)),e.yScale(e.y_val(d))],f=h[0],g=h[1],b.beginPath(),b.arc(f,g,e.opts.size(d),0,2*Math.PI),b.fill(),null!=e.opts.text))return b.font="12px sanserif",b.fillText(e.opts.text(d),f+2,g-2)}(c));return d},a.prototype._draw_dots_svg=function(a){var b,c,d,e,f=this;return e=this.data.filter(function(a){return f.opts.filter(a)}),d=this.svg.selectAll(".dot").data(e.reverse()),d.exit().remove(),c=d.enter().append("g").attr("class","dot"),c.append("circle").attr("cx",0).attr("cy",0),d.select("circle").attr("r",function(a){return f.opts.size(a)}).attr("opacity",function(a){return f.opts.alpha(a)}).style("fill",function(b,c){return a(b)}),null!=this.opts.text&&(c.append("text").attr("class","labels").attr("x",3).attr("y",-3),d.select("text").style("fill",function(b,c){return a(b)}).text(function(a,b){return f.opts.text(a)})),b=this.opts.animate?d.transition():d,b.attr("transform",function(a){return"translate("+f.xScale(f.x_val(a))+", "+f.yScale(f.y_val(a))+")"})},a.prototype._mouse_move=function(){var a,b,c=this;return a=d3.mouse(this.gDot.node()),b=d3.mouse(document.body),scheduler.schedule("scatterplot.tooltip",function(){return c._handle_mouseover(a,b)},20)},a.prototype._mouse_out=function(){if(scheduler.schedule("scatterplot.tooltip",function(){}),this.mouseover_sent)return this.mouseover_sent=!1,this.dispatch.mouseout()},a.prototype._handle_mouseover=function(a,b){var c,d,e,f,g;return f=a[0],g=a[1],e=3,c=[[this.xScale.invert(f-e),this.yScale.invert(g+e)],[this.xScale.invert(f+e),this.yScale.invert(g-e)]],d=this._in_extent(c),d.length>0?(this.mouseover_sent=!0,this.dispatch.mouseover(d,a,b)):this.mouseover_sent?(this.mouseover_sent=!1,this.dispatch.mouseout()):void 0},a.prototype._brush_empty=function(){return this.opts.brush_enable&&this.mybrush.empty()},a.prototype._brushed=function(){var a;return a=this._selected(),this.dispatch.brush(a,!this._brush_empty())},a.prototype._in_extent=function(a){var b=this;return this.data.filter(function(c){var d,e;return d=b.x_val(c),e=b.y_val(c),b.opts.filter(c)&&d>=a[0][0]&&d<=a[1][0]&&e>=a[0][1]&&e<=a[1][1]})},a.prototype._selected=function(){var a=this;return this._brush_empty()||!this.opts.brush_enable?this.data.filter(function(b){return a.opts.filter(b)}):this._in_extent(this.mybrush.extent())},a.prototype.highlight=function(a){var b,c=this;return b=this.gHighlight.selectAll(".highlight").data(a,function(a){return a.id}),b.exit().remove(),b.enter().insert("circle").attr("class","highlight").attr("opacity",1).style("fill-opacity",0).style("stroke","black").style("stroke-width",3),b.attr("r",15).attr("cx",function(a){return c.xScale(c.x_val(a))}).attr("cy",function(a){return c.yScale(c.y_val(a))}).transition().duration(500).attr("r",7)},a.prototype.unhighlight=function(){return this.svg.selectAll(".highlight").remove()},a.prototype.on=function(a,b){return this.dispatch.on(a,b)},a.prototype.brush=function(){return this._draw_dots(this.colouring||this.opts.colouring),this._brushed()},a}(),window.ScatterPlot=a}).call(this)},{}],13:[function(a,b,c){(function(){var a;a=function(){function a(a){var b,c,d,e,f,g=this;this.opts=a,this.el=c=this.opts.elem,this.colour=this.opts.colour||d3.scale.category10(),e=this.renderer=new THREE.WebGLRenderer({antialias:!0}),f=this.w=this.opts.tot_width||c.clientWidth,d=this.h=this.opts.tot_height||f,this.renderer.setSize(f,d),this.animating=!0,this._make_menu(e.domElement),c.appendChild(e.domElement),e.setClearColor(new THREE.Color(16777215)),this.camera=new THREE.PerspectiveCamera(45,f/d,1,1e4),this.camera.position.z=215,this.camera.position.x=0,this.camera.position.y=0,this.scene=new THREE.Scene,this.scatterPlot=new THREE.Object3D,this.scene.add(this.scatterPlot),this.axis_group=new THREE.Object3D,this.scene.add(this.axis_group),this.raycaster=new THREE.Raycaster,this.mouse=new THREE.Vector2,this.scene.add(new THREE.HemisphereLight(new THREE.Color("#888888"),new THREE.Color("#111111"))),b=new THREE.DirectionalLight(16777215,.7),b.position.set(0,1,1),this.scene.add(b),this.xScale=d3.scale.linear(),this.yScale=d3.scale.linear(),this.zScale=d3.scale.linear(),this.onResize(c,function(){return f=g.w=c.clientWidth,d=g.h=f,g.renderer.setSize(f,d),g.renderer.setViewport(0,0,f,d),g.camera.aspect=f/d,g.camera.updateProjectionMatrix()}),this.columns={x:{},y:{},z:{}},this.axis_type=1,this.setup_axis(),this.setup_events(),this.animate()}return a.prototype.update_data=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(d=c[0],e=c[1],f=c[2],this.columns={x:{name:"Dimension "+d},y:{name:"Dimension "+e},z:{name:"Dimension "+f}},k=d3.extent(a[d-1]),l=d3.extent(a[e-1]),m=d3.extent(a[f-1]),k=l=m=d3.extent(k.concat(l,m)),this.xScale.domain(k).nice().range([-50,50]),this.yScale.domain(l).nice().range([-50,50]),this.zScale.domain(m).nice().range([-50,50]),g=n=p=this.scatterPlot.children.length-1;p<=0?n<=0:n>=0;g=p<=0?++n:--n)this.scatterPlot.remove(this.scatterPlot.children[g]);for(i=new THREE.SphereGeometry(2,16,16),g=o=0,q=a.length;0<=q?o<q:o>q;g=0<=q?++o:--o)j=new THREE.MeshLambertMaterial({color:this.colour(b[g].parent)}),h=new THREE.Mesh(i,j),h.position.x=this.xScale(a[d-1][g]),h.position.y=this.yScale(a[e-1][g]),h.position.z=this.zScale(a[f-1][g]),h.userData={datapoint:g},this.scatterPlot.add(h);return this.setup_axis()},a.prototype.onResize=function(a,b){var c,d;return c=a.clientHeight,d=a.clientWidth,setInterval(function(){if(a.clientHeight!==c||a.clientWidth!==d)return c=a.clientHeight,d=a.clientWidth,b()},500)},a.prototype._make_menu=function(a){var b,c,d=this;return c=new Print(this.svg,"scatter3d").menu(),b=[{divider:!0},{title:"Reset view",action:function(a,b,c){return d.scatterPlot.rotation.x=d.scatterPlot.rotation.y=d.scatterPlot.rotation.z=0,d.axis_group.rotation.x=d.axis_group.rotation.y=d.axis_group.rotation.z=0,d.camera.fov=45,d.camera.projectionMatrix=(new THREE.Matrix4).makePerspective(d.camera.fov,d.renderer.domElement.width/d.renderer.domElement.height,d.camera.near,d.camera.far)}},{title:"Toggle animation",action:function(a,b,c){return d.animating=!d.animating}},{title:"Toggle axis",action:function(a,b,c){return d.axis_type=(d.axis_type+1)%4,d.setup_axis()}}],d3.select(a).on("contextmenu",d3.contextMenu(c.concat(b)))},a.prototype.addText=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;return i=document.createElement("canvas"),l=256,i.width=l,i.height=l,j=i.getContext("2d"),j.fillStyle="#"+g.getHexString(),j.textAlign="center",j.font="24px Arial",j.fillText(b,l/2,l/2),h=new THREE.Texture(i),h.needsUpdate=!0,k=new THREE.SpriteMaterial({map:h,transparent:!0,color:16777215}),m=new THREE.Sprite(k),m.scale.set(c,c,c),m.position.x=d,m.position.y=e,m.position.z=f,a.add(m)},a.prototype.setup_axis=function(){var a,b,c;for(a=b=c=this.axis_group.children.length-1;c<=0?b<=0:b>=0;a=c<=0?++b:--b)this.axis_group.remove(this.axis_group.children[a]);switch(this.axis_type){case 0:return"";case 1:return this.setup_axis_box();case 2:return this.setup_axis0();case 3:return this.setup_axis_box(),this.setup_axis0()}},a.prototype.setup_axis_box=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this;for(b=this.axis_group,a=new THREE.Color("#000000"),h=function(a,b,c){return new THREE.Vector3(a,b,c)},d=function(b,c,d,e,f,g){var i,j;return j=new THREE.Geometry,j.vertices.push(h(b,c,d),h(e,f,g)),i=new THREE.Line(j,new THREE.LineBasicMaterial({color:a,linewidth:1})),i.type=THREE.Lines,i},s=this.xScale.range(),i=s[0],j=s[1],t=this.yScale.range(),l=t[0],m=t[1],u=this.zScale.range(),n=u[0],o=u[1],b.add(d(i,l,n,j,l,n)),b.add(d(i,m,n,j,m,n)),b.add(d(i,l,o,j,l,o)),b.add(d(i,m,o,j,m,o)),b.add(d(i,l,n,i,m,n)),b.add(d(j,l,n,j,m,n)),b.add(d(i,l,o,i,m,o)),b.add(d(j,l,o,j,m,o)),b.add(d(i,l,n,i,l,o)),b.add(d(j,l,n,j,l,o)),b.add(d(i,m,n,i,m,o)),b.add(d(j,m,n,j,m,o)),k=this.xScale.ticks(5),c=q=0,v=k.length;0<=v?q<v:q>v;c=0<=v?++q:--q)e=this.xScale(k[c]),b.add(d(e,l,n,e,l,o));for(p=this.zScale.ticks(5),c=r=0,w=p.length;0<=w?r<w:r>w;c=0<=w?++r:--r)e=this.zScale(p[c]),b.add(d(i,l,e,j,l,e));return this.columns.x&&this.addText(b,this.columns.x.name,50,j+5,l,n,a),this.columns.y&&this.addText(b,this.columns.y.name,50,i,m+5,n,a),this.columns.z&&this.addText(b,this.columns.z.name,50,i,l,o+5,a),g=a,g.r=Math.min(g.r+.2,1),g.g=Math.min(g.g+.2,1),g.b=Math.min(g.b+.2,1),f=function(a,d,f,j){var k,m,o,p,q,r,s,t,u,v,w,y,z,A,B;for(w=j.ticks(5),v=j.tickFormat(),B=[],c=z=0,A=w.length;0<=A?z<A:z>A;c=0<=A?++z:--z){switch(e=new THREE.Geometry,f){case"x":k=m=o=x.xScale(w[c]),p=l+a,q=l-a,r=l-1.5*a,s=n+a,t=n-a,u=n-1.5*a;break;case"y":k=i+a,m=i-a,o=i-1.5*a,p=q=r=x.yScale(w[c]),s=n+a,t=n-a,u=n-1.5*a;break;case"z":k=i+a,m=i-a,o=i-1.5*a,p=l+a,q=l-a,r=l-1.5*a,s=t=u=x.zScale(w[c])}e.vertices.push(h(k,p,s),h(m,q,t)),0!==w[c]?(x.addText(b,v(w[c]),40,o,r,u,g),y=new THREE.Line(e,new THREE.LineBasicMaterial({color:g,linewidth:d})),y.type=THREE.Lines,B.push(b.add(y))):B.push(void 0)}return B},f(2,1,"x",this.xScale),f(2,1,"y",this.yScale),f(2,1,"z",this.zScale)},a.prototype.setup_axis0=function(){var a,b,c,d,e,f,g=this;return b=this.axis_group,a=new THREE.Color("#000000"),f=function(a,b,c){return new THREE.Vector3(a,b,c)},c=function(b,c,d){var e,g;return g=new THREE.Geometry,g.vertices.push(f(0,0,0),f(b,c,d)),e=new THREE.Line(g,new THREE.LineBasicMaterial({color:a,linewidth:1})),e.type=THREE.Lines,e},b.add(c(this.xScale.range()[0],0,0)),b.add(c(this.xScale.range()[1],0,0)),b.add(c(0,this.yScale.range()[0],0)),b.add(c(0,this.yScale.range()[1],0)),b.add(c(0,0,this.zScale.range()[0])),b.add(c(0,0,this.zScale.range()[1])),this.columns.x&&this.addText(b,this.columns.x.name,50,55,0,0,a),this.columns.y&&this.addText(b,this.columns.y.name,50,0,55,0,a),this.columns.z&&this.addText(b,this.columns.z.name,50,0,0,55,a),e=a,e.r=Math.min(e.r+.2,1),e.g=Math.min(e.g+.2,1),e.b=Math.min(e.b+.2,1),d=function(a,c,d,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(u=h.ticks(5),r=h.tickFormat(),y=[],s=w=0,x=u.length;0<=x?w<x:w>x;s=0<=x?++w:--w){switch(t=new THREE.Geometry,d){case"x":i=j=k=g.xScale(u[s]),l=a,m=-a,n=1.5*a,o=0,p=0,q=0;break;case"y":i=a,j=-a,k=1.5*a,l=m=n=g.yScale(u[s]),o=0,p=0,q=0;break;case"z":i=0,j=0,k=0,l=a,m=-a,n=1.5*a,o=p=q=g.zScale(u[s])}t.vertices.push(f(i,l,o),f(j,m,p)),0!==u[s]?(g.addText(b,r(u[s]),40,k,n,q,e),v=new THREE.Line(t,new THREE.LineBasicMaterial({color:e,linewidth:c})),v.type=THREE.Lines,y.push(b.add(v))):y.push(void 0)}return y},d(2,1,"x",this.xScale),d(2,1,"y",this.yScale),d(2,1,"z",this.zScale)},a.prototype.setup_events=function(){var a,b,c=this;return this.mousedown=!1,a=0,b=0,this.el.onmousedown=function(d){if(0===d.button&&!d.ctrlKey)return c.mousedown=!0,a=d.clientX,b=d.clientY},this.el.onmouseup=function(a){return c.mousedown=!1},this.el.onmousemove=function(d){var e,f,g;return c.mousedown?(f=d.clientX-a,g=d.clientY-b,c.scatterPlot.rotation.y+=.01*f,c.scatterPlot.rotation.x+=.01*g,c.axis_group.rotation.x=c.scatterPlot.rotation.x,c.axis_group.rotation.y=c.scatterPlot.rotation.y,a+=f,b+=g):(e=d.target.getBoundingClientRect(),c.mouse.x=2*(d.clientX-e.left)/e.width-1,c.mouse.y=-2*(d.clientY-e.top)/e.height+1,c.on_mouse_hover())},this.el.onmousewheel=function(a){return a.preventDefault()},this.el.addEventListener("DOMMouseScroll",function(a){return c.on_mouse_wheel(a)},!0),this.el.addEventListener("mousewheel",function(a){return c.on_mouse_wheel(a)},!0)},a.prototype.on_mouse_hover=function(){var a,b,c,d,e;for(this.raycaster.setFromCamera(this.mouse,this.camera),a=this.raycaster.intersectObject(this.scatterPlot,!0),e=[],c=0,d=a.length;c<d;c++)b=a[c],b.object.userData.datapoint?e.push(console.log("HOVER : ",b.object.userData)):e.push(void 0);return e},a.prototype.on_mouse_wheel=function(a){var b,c,d;return c=180,d=1,b=a.wheelDeltaY||-10*a.detail||a.wheelDelta,this.camera.fov-=.02*b,this.camera.fov=Math.max(Math.min(this.camera.fov,c),d),this.camera.projectionMatrix=(new THREE.Matrix4).makePerspective(this.camera.fov,this.renderer.domElement.width/this.renderer.domElement.height,this.camera.near,this.camera.far)},a.prototype.animate=function(){var a=this;return!this.mousedown&&this.animating&&(this.scatterPlot.rotation.z+=5e-4,this.scatterPlot.rotation.y+=.003,this.axis_group.rotation.x=this.scatterPlot.rotation.x,this.axis_group.rotation.y=this.scatterPlot.rotation.y,this.axis_group.rotation.z=this.scatterPlot.rotation.z),requestAnimationFrame(function(){return a.animate()}),this.renderer.render(this.scene,this.camera)},a}(),window.Scatter3d=a}).call(this)},{}],12:[function(a,b,c){(function(){var a;a=function(){function a(a){var b,c,d,e,f,g,h,i,j,k,l,m;this.opts=a,(c=this.opts).tot_width||(c.tot_width=200),(d=this.opts).tot_height||(d.tot_height=200),(f=this.opts).margin_t||(f.margin_t=20),(g=this.opts).margin_l||(g.margin_l=50),(h=this.opts).margin_r||(h.margin_r=10),(i=this.opts).margin_b||(i.margin_b=40),(j=this.opts).ylabel||(j.ylabel=""),(k=this.opts).xlabel||(k.xlabel=""),(l=this.opts).title||(l.title=""),(m=this.opts).fill||(m.fill=function(){return"steelblue"}),(e=this.opts).rotate_labels||(e.rotate_labels=!1),null==this.opts.xordinal&&(this.opts.xordinal=!0),b={top:this.opts.margin_t,right:this.opts.margin_r,bottom:this.opts.margin_b,left:this.opts.margin_l},
this.width=this.opts.tot_width-b.left-b.right,this.height=this.opts.tot_height-b.top-b.bottom,this.opts.xordinal?this.x=d3.scale.ordinal().rangeRoundBands([0,this.width],.1):this.x=d3.scale.linear().range([0,this.width]),this.y=d3.scale.linear().range([this.height,0]),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(8,1),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(8,1),this.svg_real=d3.select(this.opts.elem).append("svg").attr("class","bar-chart").attr("width",this.width+b.left+b.right).attr("height",this.height+b.top+b.bottom),this.svg=this.svg_real.append("g").attr("transform","translate("+b.left+","+b.top+")"),this._make_menu(this.opts.elem)}return a.prototype._make_menu=function(a){var b;return b=new Print(this.svg_real,this.opts.title).menu(),d3.select(a).on("contextmenu",d3.contextMenu(b))},a.prototype.draw=function(a){var b=this;return this.svg.selectAll("*").remove(),this.x.domain(null!=this.opts.xdomain?this.opts.xdomain:a.map(function(a){return a.lbl})),this.y.domain([0,d3.max(a,function(a){return a.val})]),this.svg.append("text").attr("class","title").attr("x",this.width/2).attr("y",-10).style("text-anchor","middle").text(this.opts.title),this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis).append("text").attr("class","label").attr("x",this.width/2).attr("y",this.opts.margin_b-10).style("text-anchor","middle").text(this.opts.xlabel),this.opts.rotate_labels&&this.svg.selectAll(".x.axis .tick text").attr("transform","rotate(-90) translate(-10,-15)").style("text-anchor","end"),this.svg.append("g").attr("class","y axis").call(this.yAxis).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-40).attr("y",20-this.opts.margin_l).style("text-anchor","end").text(this.opts.ylabel),this.svg.selectAll(".bar").data(a).enter().append("rect").attr("class","bar").attr("x",function(a){return b.x(a.lbl)}).attr("width",function(a){return a.width?b.x(a.width):b.x.rangeBand()}).attr("y",function(a){return b.y(a.val)}).attr("height",function(a){return b.height-b.y(a.val)}).attr("fill",function(a){return b.opts.fill(a)}).on("click",function(a){if(null!=b.opts.click)return b.opts.click(a)})},a}(),window.BarGraph=a}).call(this)},{}],14:[function(a,b,c){(function(){var a,b,c;c=function(){function a(a){var b,c,d,e;this.opts=a,b=this.opts.elem,e=this.opts.tot_width||570,d=this.opts.tot_height||400,c={top:20,right:180,bottom:40,left:60},this.width=e-c.left-c.right,this.height=d-c.top-c.bottom,this.colour=this.opts.colour||d3.scale.category10(),this.x=d3.scale.linear().range([0,this.width]),this.y=d3.scale.linear().range([this.height,0]),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(8,1),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(8,1),this.svg_real=d3.select(b).append("svg").attr("class","scatter").attr("width",this.width+c.left+c.right).attr("height",this.height+c.top+c.bottom),this.svg=this.svg_real.append("g").attr("transform","translate("+c.left+","+c.top+")"),this._make_menu(b)}return a.prototype._make_menu=function(a){var b;return b=new Print(this.svg_real,"MDS-plot").menu(),d3.select(a).on("contextmenu",d3.contextMenu(b))},a.prototype.draw=function(a,b,c){var d,e,f,g,h,i=this;return d=c[0],e=c[1],this.x.domain(d3.extent(a[d-1])),this.y.domain(d3.extent(a[e-1])),h=d3.transpose(a),this.svg.selectAll(".axis").remove(),this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(this.xAxis).append("text").attr("class","label").attr("x",this.width/2).attr("y",40).style("text-anchor","middle").text("MDS Dimension "+d),this.svg.append("g").attr("class","y axis").call(this.yAxis).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-100).attr("y",-50).style("text-anchor","end").text("MDS Dimension "+e),g=this.svg.selectAll(".dot").data(h),g.exit().remove(),f=g.enter().append("g").attr("class","dot"),f.append("circle").attr("r",3.5).attr("cx",0).attr("cy",0),f.append("text").attr("class","labels").attr("x",3).attr("y",-3),g.select("circle").style("fill",function(a,c){return i.colour(b[c].parent)}),g.select("text").style("fill",function(a,c){return i.colour(b[c].parent)}).text(function(a,c){return b[c].name}),g.transition().attr("transform",function(a){return"translate("+i.x(a[d-1])+","+i.y(a[e-1])+")"})},a}(),b=function(){function a(){}return a.pca=function(a){var b,c,d,e;return b=numeric.transpose(numeric.transpose(a).map(function(a){var b;return b=1*numeric.sum(a)/a.length,numeric.sub(a,b)})),d=numeric.dot(b,numeric.transpose(b)),e=numeric.svd(d),c=numeric.dot(e.V,numeric.sqrt(numeric.diag(e.S))),c=numeric.div(c,Math.sqrt(a[0].length)),{pts:c,eigenvalues:e.S}},a.variance=function(a){var b;return b=a.length,numeric.sum(numeric.pow(a,2))/b-Math.pow(numeric.sum(a),2)/(b*b)},a}(),a=function(){function a(a){var b,d=this;this.opts=a,this.div2d=d3.select(this.opts.elem).append("div"),this.div3d=d3.select(this.opts.elem).append("div"),b=d3.select(this.opts.elem).append("div"),this.scatter=new c({elem:this.div2d.node(),colour:this.opts.colour}),this.barGraph=new BarGraph({elem:b.node(),title:"% variance by MDS dimension",xlabel:"Dimension",ylabel:"% variance",click:function(a){if(null!=d.opts.sel_dimension)return d.opts.sel_dimension(a.lbl)}}),this.dispatch=d3.dispatch("top_genes")}return a.prototype.update_data=function(a,b){var c=this;return this.data=a,this.columns=b,this.norm_cols=Normalize.normalize(this.data,this.columns),this.variances={},this.rows=this.data.get_data(),this.rows.forEach(function(a){return c.variances[a.id]=c._compute_variance(a)}),this.redraw()},a.prototype._compute_variance=function(a){var c;return c=this.norm_cols.map(function(b){return a[b.idx]}),b.variance(c)},a.prototype.redraw=function(){var a,c,d,e,f,g,h,i,j,k,l,m,n=this;return m=this.opts.params(),i=m.skip,f=m.num,d=m.dims,h=m.plot_2d3d,e=this.rows.filter(function(a){return n.opts.filter(a)}),j=e.sort(function(a,b){return n.variances[b.id]-n.variances[a.id]}),j=j.slice(i,i+f),this.dispatch.top_genes(j),l=j.map(function(a){return n.norm_cols.map(function(b){return a[b.idx]})}),a=numeric.transpose(l),g=b.pca(a),c=numeric.transpose(g.pts),this.scatter_draw(h,c,this.columns,d),k=d3.sum(g.eigenvalues),this.barGraph.draw(c.slice(0,10).map(function(a,b){var c;return c=g.eigenvalues[b]/k*100,{lbl:""+(b+1),val:c}}))},a.prototype.scatter_draw=function(a,b,c,d){var e=this;return"2d"===a?(this.div2d.style("display","block"),this.div3d.style("display","none"),this.scatter.draw(b,c,d)):(this.div2d.style("display","none"),this.div3d.style("display","block"),DynamicJS.load("./three.js",function(){return e.scatter3d||(e.scatter3d=new Scatter3d({elem:e.div3d.node(),tot_height:400})),e.scatter3d.update_data(b,c,d)}))},a.prototype.brush=function(){return this.redraw()},a.prototype.highlight=function(){},a.prototype.unhighlight=function(){},a.prototype.on=function(a,b){return this.dispatch.on(a,b)},a}(),window.GenePCA=a}).call(this)},{}],18:[function(a,b,c){(function(){var a,b,c;b=10,c="_normalized_",a=function(){function a(){}return a.normalize=function(a,d){return d.map(function(d){var e,f,g;return f=c+d.idx,e=a.column_by_idx(f),e||(g=a.get_total(d)/1e6,e={idx:f,name:d.name+" (N)",type:"norm",parent:d.parent},a.add_column(e,function(a){return Math.log(b+a[d.idx]/g)/Math.log(2)})),e})},a}(),window.Normalize=a}).call(this)},{}],17:[function(a,b,c){(function(){var a;a=function(){function a(a){this.opts=a,this.elem=$(this.opts.elem),this.elem.data("edit")||this._enable()}return a.prototype._enable=function(){var a,b,c,d=this;return this.elem.data("edit",!0),this.elem.addClass("edit-elem"),b=$("<button class='btn btn-default btn-sm'>Cancel</button>"),a=$("<button class='btn btn-primary btn-sm'>Apply</button>"),this.buttons=$('<div class="edit-btns">'),this.buttons.append(b),this.buttons.append(a),this.elem.append(this.buttons),b.click(function(){return d._cancel()}),a.click(function(){return d._apply()}),this.over=$('<div class="edit-overlay">'),this.elem_back=$('<div class="edit-backdrop">'),c=this.elem.offset(),c.top=c.top-4,c.left=c.left-4,this.elem_back.width(this.elem.innerWidth()+8).height(this.elem.innerHeight()+8).offset(c),$("body").append(this.over),$("body").append(this.elem_back)},a.prototype._cancel=function(){return this._done(),this.opts.cancel()},a.prototype._apply=function(){return this._done(),this.opts.apply()},a.prototype._done=function(){return this.elem.data("edit",!1),this.elem.removeClass("edit-elem"),this.buttons.remove(),this.over.remove(),this.elem_back.remove()},a}(),window.EditList=a}).call(this)},{}],16:[function(a,b,c){(function(){var a;a=function(){function a(a){this.opts=a,this.ec_visible={}}return a.prototype.load=function(a,b,c){var d=this;return this.ec_colours=b,this.img_x=void 0,this.kegg_data=void 0,this.img_url="kegg/pathway/map/map"+a+".gif",$(this.opts.elem).html("<div id='kegg-container'></div>"),$("<img/>").attr("src",this.img_url).load(function(a){return d.img_x=a.target.width,d.img_y=a.target.height,d.draw_ec()}),d3.xml("kegg/kgml/map/map"+a+".xml",function(a){return d.xml_loaded(a,c)})},a.prototype.xml_loaded=function(a,b){var c;return this.kegg_data=this.xml_to_list(a),b&&(c=[],c=this.kegg_data.map(function(a){return a.id}),b&&b(c)),this.draw_ec()},a.prototype.draw_ec=function(){var a,b=this;if(this.kegg_data&&this.img_x)return d3.select("div#kegg-container").html(""),this.svg=d3.select("div#kegg-container").append("svg").attr("viewBox","1 1 "+this.img_x+" "+this.img_y).attr("width","100%").attr("height","100%"),this.svg.append("image").attr("xlink:href",this.img_url).attr("width",this.img_x).attr("height",this.img_y),a=this.svg.selectAll(".ec").data(this.kegg_data,function(a){return a.id}),a.enter().append("rect").attr("class","ec").attr("x",function(a){return a.x-a.width/2}).attr("y",function(a){return a.y-a.height/2}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("stroke","black").attr("fill-opacity",.3).attr("fill",function(a){return b.colour(a.id)}),a.exit().remove(),this.opts.mouseover&&a.on("mouseover",this.opts.mouseover),this.opts.mouseout?a.on("mouseout",this.opts.mouseout):void 0},a.prototype.rect=function(a){return g.append("rect")},a.prototype.xml_to_list=function(a){var b,c=this;return b=[],$("entry[type=enzyme] graphics[type=rectangle]",a).each(function(a,d){var e,f,g,h,i,j;if(e=$(d),g={id:e.attr("name")},g.id in c.ec_colours){for(j=["x","y","width","height"],h=0,i=j.length;h<i;h++)f=j[h],g[f]=e.attr(f);return b.push(g)}}),b},a.prototype.colour=function(a){switch(this.ec_colours[a]){case"same":return"green";case"mixed":return"yellow";case"up":return"red";case"down":return"blue";default:return"black"}},a.prototype.highlight=function(a){if(this.svg)return this.svg.selectAll(".ec").filter(function(b){return b.id===a}).attr("stroke-width",5).attr("stroke","red")},a.prototype.unhighlight=function(){if(this.svg)return this.svg.selectAll(".ec").attr("stroke-width",1).attr("stroke","black")},a}(),window.Kegg=a}).call(this)},{}],15:[function(a,b,c){(function(){var a,b;jQuery.fn.d3Click=function(){return this.each(function(a,b){var c;return c=document.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),b.dispatchEvent(c)})},a="<div class='popover'>          <div class='arrow'></div>          <h3 class='popover-title'></h3>          <div class='popover-content'></div>          <nav class='popover-navigation'>            <div class='btn-group'>              <button class='btn btn-sm btn-default' data-role='prev'>&laquo; Prev</button>              <button class='btn btn-sm btn-default' data-role='next'>Next &raquo;</button>            </div>            <button class='btn btn-sm btn-default' data-role='end'>End tour</button>          </nav>        </div>",b=[{title:"<strong>Degust</strong>",content:"Degust allows you to explore your Differential Gene Expression data.  You can apply various filters for significance, and see the MA-plot/parallel coordinates plot/heatmap update dynamically.  You can search for specific genes, and download a filtered gene-list.",orphan:!0,backdrop:!0},{element:".conditions",placement:"right",title:"<strong>Condition selector</strong>",content:"Select/deselect the conditions you wish to compare.  Changing these causes the server to re-analyse your data"},{element:"#expression .nav",placement:"bottom",title:"<strong>Select plot type</strong>",content:"Select 'Parallel Coordinates' or 'MA plot'.  An 'MA plot' is great for visualising data with just 2 conditions.  The parallel coordinates plot is particuarly useful for more than 2 conditions"},{element:"#heatmap",placement:"top",title:"<strong>Heatmap</strong>",content:"<p>The heatmap shows the log fold-change for each gene shown in the plot above.  Each 'vertical strip' corresonds to a gene.  The heatmap may be slow to display when there are many genes to cluster.</p><p>Hovering the mouse over the heatmap will show the corresponding gene in the plot above.</p>"},{element:"#grid",placement:"top",title:"<strong>Gene table</strong>",content:"A table of genes filtered to show the same genes as plotted above.  <ul><li>The table may be sorted by clicking on the column headers.<li>Specific genes may be found using the search box<li>Double click a row to open a page for that gene.</ul>",template:function(){return $(a).addClass("wide")}},{element:".fdr-fld",placement:"left",title:"<strong>FDR threshold</strong>",content:"Modify the threshold for False Discovery Rate.  This dynamically filters the plots and gene table below"},{element:".fc-fld",placement:"left",title:"<strong>Log fold-change threshold</strong>",content:"Modify the threshold for absolute log fold-change.  This dynamically filters the plots and gene table below.  For example, a setting of '1.0' will only show genes that have an absolute log fold-change greater than 1.0 (that is 2x up or down) between any pair of conditions."},{element:"#csv-download",placement:"left",backdrop:!0,title:"Gene list download",content:"Anything displayed in the gene list table can be downloaded as a CSV file."},{onShow:function(){return $("#select-ma a").click()},element:"#dge-ma",placement:"bottom",title:"<strong>MA plot</strong>",content:"<p>An MA plot shows expression for 2 conditions only (as selected in Options).  Each dot on this plot shows a gene.  The x-axis is the average expression, and the y-axis is the log fold-change between the conditions.</p><p>You can click and drag on the plot to select genes within a rectangle - the heatmap and table below will be filtered to only those genes. Click anywhere on the plot to remove a selection rectangle.</p><p>Each dot is coloured by FDR with red being more significant and blue less significant.</p>",template:function(){return $(a).addClass("wide")}},{onShow:function(){return $("#select-pc a").click()},element:"#dge-pc",placement:"bottom",title:"<strong>Parallel Coordinates</strong>",content:"<p>Each blue/red line on this plot shows a gene and each axis corresponds to a conditions.  So each line shows the relative expression for a gene across conditions.</p><p>You can select a region of an axis by clicking and dragging vertically on that axis.  This will filter for only genes that fall within the selected fold-change.  Click outside the selection to clear.  Each axis may have an active select region.</p><p>Conditions can be re-ordered by dragging the column header</p><p>Each line is coloured by FDR with red being more significant and blue less significant.</p>",template:function(){return $(a).addClass("wide")}},{element:".kegg-filter",placement:"left",title:"<strong>Kegg filter</strong>",content:'<p>Filter genes by an annotated KEGG pathway.</p><p>The numbers beside each pathway show the number of genes in your dataset annotated in that pathway.  Selecting a pathway will filter to show only those genes, and display the pathway image.  The image may be resized, and you can hover the mouse over EC elements to see genes annotated with that EC.</p><p>The EC elements are coloured: blue = unchanged, green = all up, red = all down, yellow = mixed.</p><p>This KEGG data is from 2007.  If you find this functionality useful, I recommend you purchase a <a href="http://www.bioinformatics.jp/en/keggftp.html">KEGG subscription</a> and run your own local degust server.</p>',template:function(){return $(a).addClass("wide")}}],window.setup_tour=function(a){var c;if(c=new Tour({steps:b}),c.init(),$("a#tour").click(function(){return c.restart()}),a)return c.start()}}).call(this)},{}],19:[function(a,b,c){(function(){var a,b;b=function(a){return function(b,c){var d,e,f,g;for(e=b.quartiles[0],f=b.quartiles[2],g=(f-e)*a,c=-1,d=b.length;b[++c]<e-g;)c=c;for(;b[--d]>f+g;)c=c;return[c,d]}},a=function(){function a(){}return a.pvalue_histogram=function(b){var c,d,e,f,g,h,i;return i=700,f=500,g=b.columns_by_type("p")[0],null==g&&(g=b.columns_by_type("fdr")[0]),h=b.get_data().map(function(a){return a[g.idx]}),d=d3.layout.histogram().bins(50)(h),e=$('<div class="pvalue-histogram">'),e.css({position:"absolute",top:"80px",left:($(window).width()-i)/2+"px",height:f+10+"px"}),$("body").append(e),c=new BarGraph({elem:e.get(0),tot_width:i,tot_height:f,margin_t:50,margin_r:50,margin_l:60,margin_b:50,title:"P-value histogram",xlabel:"p-value",ylabel:"number",xdomain:[0,1],xordinal:!1}),c.draw(d.map(function(a){return{lbl:a.x,val:a.y,width:a.dx}})),a.overlay(e,function(){return e.remove()})},a.library_size_bargraph=function(b,c){var d,e,f,g,h,i;return e=b.columns_by_type("count"),h=e.map(function(a){return{lbl:a.name,val:b.get_total(a),parent:a.parent}}),i=d3.min([30*e.length+200,700]),g=500,f=$('<div class="libsize-bargraph">'),f.css({position:"absolute",top:"80px",left:($(window).width()-i)/2+"px",height:g+10+"px"}),$("body").append(f),null==c&&(c=d3.scale.category10()),d=new BarGraph({elem:f.get(0),tot_width:i,tot_height:g,margin_t:50,margin_r:90,margin_l:100,margin_b:200,rotate_labels:!0,title:"Library Sizes",xlabel:"library",ylabel:"number of assigned reads",xordinal:!0,fill:function(a){return c(a.parent)}}),d.draw(h),a.overlay(f,function(){return f.remove()})},a.expression_boxplot=function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return g=a.get_cpm(c),l={top:40,right:50,bottom:150,left:50},p=40,o=p*g.length+l.left+l.right,e=400,k=e+l.top+l.bottom,h=$('<div class="expression-boxplot"><svg></svg></div>'),h.css({position:"absolute",top:"80px",left:($(window).width()-o)/2+"px",height:k+"px"}),$("body").append(h),null==d&&(d=d3.scale.category10()),f=d3.box().whiskers(b(1.5)).width(p/2).height(e).show_values(!1).fill(function(a){return d(a.parent)}),i=d3.extent([].concat.apply([],g.map(function(a){return d3.extent(a.vals)}))),f.domain(i),n=d3.select(h.get(0)).select("svg").attr("height",k).attr("width",o),n.append("text").attr("class","title").attr("x",o/2).attr("y",15).style("text-anchor","middle").text("Log CPM by library"),q=d3.scale.ordinal().domain(g.map(function(a){return a.name})).rangeRoundBands([0,p*(g.length-1)],.7,.3),n.selectAll("g.boxplot").data(g).enter().append("g").attr("class","boxplot").attr("transform",function(a){return"translate("+(l.left+q(a.name))+","+l.top+")"}).call(f),r=d3.svg.axis().scale(q).orient("bottom"),s=d3.scale.linear().domain(i).range([e+l.top,0+l.top]),t=d3.svg.axis().scale(s).orient("left"),n.append("g").attr("class","y axis").attr("transform","translate("+(l.left-20)+",0)").call(t).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").style("font-size","16px").text("log(cpm)"),n.append("g").attr("class","x axis").attr("transform","translate("+(l.left+5)+","+(e+l.top+10)+")").call(r),n.selectAll(".x.axis .tick text").attr("transform","rotate(-90) translate(-10,-15)").style("text-anchor","end"),j=function(){var a;return a=d3.select(n.node().cloneNode(!0)),a.attr("class",""),Print.copy_svg_style_deep(n,a),{svg:a.node(),width:n.node().clientWidth,height:n.node().clientHeight}},m=new Print(j,"expression-boxplot").menu(),d3.select(h.get(0)).on("contextmenu",d3.contextMenu(m)),a.overlay(h,function(){return h.remove()})},a.get_cpm=function(a){var b;return b=a.columns_by_type("count"),b.map(function(b,c){var d,e;return d=a.get_total(b)/1e6,e=a.get_data().map(function(a){return Math.log(.5+a[b.idx]/d)/Math.log(2)}),{vals:e,name:b.name,parent:b.parent,pos:c}})},a.overlay=function(a,b){var c,d,e;return a.addClass("edit-elem"),e=$('<div class="edit-overlay">'),c=$('<div class="edit-backdrop">'),d=a.offset(),d.top=d.top-4,d.left=d.left-4,c.width(a.innerWidth()+8).height(a.innerHeight()+8).offset(d),$("body").append(e),$("body").append(c),e.on("click",function(){return a.removeClass("edit-elem"),e.remove(),c.remove(),b()})},a}(),window.QC=a}).call(this)},{}],20:[function(a,b,c){(function(){var a;a=function(){function a(a){this.opts=a,this.width=this.opts.width||d3.select(this.opts.elem).node().clientWidth,this.height=300,this.margin_l=80,this.margin_b=120,this.margin_t=30,this.plot_height=this.height-this.margin_t-this.margin_b,this.plot_width=this.width-this.margin_l,this.colour=this.opts.colour||d3.scale.category10(),this.x=d3.scale.ordinal().rangeRoundBands([0,this.plot_width],.1),this.y=d3.scale.linear().range([this.plot_height,0]),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(8,1),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(8,1),this.svg=d3.select(this.opts.elem).append("svg").attr("class","strip-chart").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate("+this.margin_l+", "+this.margin_t+")"),this.tooltip=d3.select(this.opts.elem).append("div").attr("class","tooltip").style("opacity",0),this.jitter_cache={},this.show_cpm=!1,this._make_menu(this.opts.elem)}return a.prototype._get_svg=function(){var a,b;return b=d3.select(this.opts.elem).select("svg"),a=d3.select(b.node().cloneNode(!0)),a.attr("class",""),Print.copy_svg_style_deep(b,a),{svg:a.node(),width:b.node().clientWidth,height:b.node().clientHeight}},a.prototype._make_menu=function(a){var b,c,d=this;return c=new Print(function(){return d._get_svg()},"Gene expression").menu(),b=[{title:function(){return d.show_cpm?"Plot counts":"Plot CPM"},action:function(){return d.show_cpm=!d.show_cpm,d.update()}}],d3.select(a).on("contextmenu",d3.contextMenu(b.concat(c)))},a.prototype.select=function(a,b){return this.data=a,this.rows=b,this.update()},a.prototype.update=function(){var a,b,c,d,e,f=this;return this.svg.selectAll("*").remove(),d=this.rows[0],this.columns=a=this.data.columns_by_type("count"),e=a.map(function(a){var b,c;return b=f.data.get_total(a)/1e6,c=f.show_cpm?d[a.idx]/b:d[a.idx],{lbl:a.name,parent:a.parent,val:c}}),b=this.data.columns_by_type("info"),this.x.domain(e.map(function(a){return a.parent})),this.y.domain([0,d3.max(e,function(a){return a.val})]),this.svg.append("text").attr("class","title").attr("x",this.plot_width/2).attr("y",-this.margin_t/2).style("text-anchor","middle").text(d[b[0].idx]),this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+(this.height-this.margin_b-this.margin_t)+")").call(this.xAxis),this.svg.selectAll(".x.axis .tick text").attr("transform","rotate(-90) translate(-10,-15)").style("text-anchor","end"),this.svg.append("g").attr("class","y axis").call(this.yAxis).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",0).attr("y",10).style("text-anchor","end").text(this.show_cpm?"CPM":"Counts"),c=this.svg.selectAll(".pts").data(e).enter().append("circle").attr("class","circle").attr("r",4).attr("fill",function(a){return f.colour(a.parent)}).attr("cx",function(a){return f.x(a.parent)+f.x.rangeBand()/2+f.jitter(a)}).attr("cy",function(a){return f.y(a.val)}),c.on("mouseover",function(a){return f._show_tooltip(a)}),c.on("mouseout",function(){return f._hide_tooltip()})},a.prototype.jitter=function(a){var b,c;return null!=(b=this.jitter_cache)[c=a.lbl]?(b=this.jitter_cache)[c=a.lbl]:b[c]=8*Math.random()-4},a.prototype._hide_tooltip=function(){return this.tooltip.style("opacity",0)},a.prototype._show_tooltip=function(a){var b,c,d;return a?(d=[d3.event.pageX,d3.event.pageY],b=this.show_cpm?function(a){return a.toFixed(2)}:function(a){return a},this.tooltip.transition().duration(200).style("opacity",.8),c="<table>",c+="<tr><td><b>"+a.lbl+"</b>:<td>"+b(a.val),c+="</table>",this.tooltip.html(c).style("left",d[0]-60+"px").style("top",d[1]+15+"px")):void this._hide_tooltip()},a}(),window.GeneExpression=a}).call(this)},{}],11:[function(a,b,c){(function(){var b,c,d,e,f,g;g=a("./lib/scale-color-perceptual/hex/viridis.json"),d=a("./lib/scale-color-perceptual/hex/inferno.json"),e=a("./lib/scale-color-perceptual/hex/magma.json"),f=a("./lib/scale-color-perceptual/hex/plasma.json"),c=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(r=a.data,g=r[0],e=r[1],o=new Date,null==g)return void self.postMessage({error:"Data missing"});if(null==e)return void self.postMessage({error:"Columns missing"});if(null!=g&&0===g.length)return void self.postMessage({done:[]});for(h=function(a,b){var c,d,f,g,h;for(d=0,g=0,h=e.length;g<h;g++)c=e[g],f=a[c.idx]-b[c.idx],d+=f*f;return d},d=function(){var a,b,c,d,f,i,j,k,l,m;a=[],j=0,g.forEach(function(b){return e.map(function(c){var d;return a[d=c.idx]||(a[d]=0),a[c.idx]+=b[c.idx]}),j+=1});for(d in a)k=a[d],a[d]=k/j;for(i=0,f=0,c=l=0,m=g.length-1;0<=m?l<=m:l>=m;c=0<=m?++l:--l)(b=h(a,g[c]))>f&&(f=b,i=c);return i},p={},k=[d()],p[k[0]]=!0,j=0;k.length<g.length;){for(j++>=50&&(j=0,postMessage({upto:k.length})),n=g[k[k.length-1]],c=b=null,i=q=0,s=g.length-1;0<=s?q<=s:q>=s;i=0<=s?++q:--q)p[i]||(m=g[i],f=h(n,m),(!b||f<b)&&(b=f,c=i));k.push(c),p[c]=!0}return l=k.map(function(a){return g[a].id}),postMessage({done:l,took:new Date-o})},b=function(){function a(a){var b,d,e,f,g=this;this.opts=a,null==(b=this.opts).h_pad&&(b.h_pad=20),null==(d=this.opts).h&&(d.h=20),null==(e=this.opts).label_width&&(e.label_width=120),null==(f=this.opts).legend_height&&(f.legend_height=50),this.opts.width=d3.select(this.opts.elem).node().clientWidth-20,null!=this.opts.show_elem&&$(this.opts.show_elem).click(function(a){return a.preventDefault(),g.enabled(!0),g.dispatch.need_update()}),this.svg=d3.select(this.opts.elem).append("svg"),this.svg.append("g").attr("class","labels"),this.svg.append("g").attr("class","genes").attr("transform","translate("+this.opts.label_width+",0)"),this.svg.attr("width","100%").attr("height",100),this.mk_highlight(),this.info=this.svg.append("text").attr("class","info").attr("x",this.opts.width-200).attr("y",10),this.legend=this.svg.append("g").attr("class","legend"),this.dispatch=d3.dispatch("mouseover","mouseout","need_update"),this.get_color_scale=this._color_red_blue,this.worker=new WorkerWrapper(c,function(a){return g._worker_callback(a)}),this._enabled=!0,this.show_replicates=!1,this.columns_changed=!1,this._make_menu(this.opts.elem)}return a.prototype.mk_highlight=function(){return this.svg.append("defs").append("marker").attr({id:"arrow",viewBox:"0 -5 10 10",refX:5,refY:0,markerWidth:4,markerHeight:4,orient:"auto"}).append("path").attr("d","M0,-5L10,0L0,5").attr("class","arrowHead")},a.prototype.resize=function(){if(this._enabled)return this.opts.width=d3.max([0,d3.select(this.opts.elem).node().clientWidth-20]),this.info.attr("x",this.opts.width-200),this._redraw_all()},a.prototype.enabled=function(a){return null==a?this._enabled:(this._enabled=a,$(this.opts.elem).toggle(a),null!=this.opts.show_elem?$(this.opts.show_elem).toggle(!a):void 0)},a.prototype._get_svg=function(){var a;return a=d3.select(this.svg.node().cloneNode(!0)),a.attr("class",""),Print.copy_svg_style_deep(this.svg,a),{svg:a.node(),width:this.svg.node().clientWidth,height:this.svg.node().clientHeight}},a.prototype._make_menu=function(a){var b,c,h=this;return c=new Print(function(){return h._get_svg()},"heatmap").menu(),b=[{title:"Hide heatmap",action:function(){return h.enabled(!1)}},{title:function(){return(h.show_replicates?"Hide":"Show")+" replicates"},action:function(){return h.show_replicates=!h.show_replicates,h.dispatch.need_update()}},{divider:!0},{title:"Colour scheme"},{title:"Red/white/blue",action:function(a,b,c){return h.get_color_scale=h._color_red_blue,h._redraw_all()}},{title:"Red/black/green",action:function(a,b,c){return h.get_color_scale=h._color_red_green,h._redraw_all()}},{title:"Viridis",action:function(a,b,c){return h.get_color_scale=h._color_viridis(g),h._redraw_all()}},{title:"Inferno",action:function(a,b,c){return h.get_color_scale=h._color_viridis(d),h._redraw_all()}},{title:"Magma",action:function(a,b,c){return h.get_color_scale=h._color_viridis(e),h._redraw_all()}},{title:"Plasma",action:function(a,b,c){return h.get_color_scale=h._color_viridis(f),h._redraw_all()}},{divider:!0}],d3.select(a).on("contextmenu",d3.contextMenu(b.concat(c)))},a.prototype._color_red_blue=function(){return d3.scale.linear().domain([-this.max,0,this.max]).range(["blue","white","red"])},a.prototype._color_red_green=function(){return d3.scale.linear().domain([-this.max/2,0,this.max/2]).range(["green","black","red"])},a.prototype._color_viridis=function(a){return function(){return d3.scale.quantize().domain([-this.max,this.max]).range(a)}},a.prototype._redraw_all=function(){return this._draw_columns(),this._render_heatmap()},a.prototype._make_legend=function(){var a,b,c,d,e,f,g,h,i,j=this;return this.colorScale=this.get_color_scale(),this.legend.selectAll("*").remove(),this.legend.append("text").attr("x",-10).attr("y",20).attr("text-anchor","end").text("Heatmap log-fold-change "),i=100,this.legend.attr("transform","translate("+(this.opts.width-i-20)+", "+(this.height-this.opts.legend_height)+")"),f=i,e=d3.scale.linear().domain([0,f-1]).range([-this.max,this.max]),h=function(){var a,b;for(b=[],g=a=0;0<=f?a<f:a>f;g=0<=f?++a:--a)b.push(g);return b}(),b=this.legend.append("g"),c=b.selectAll("rect").data(h),c.enter().append("rect").attr("x",function(a){return 1*a*i/f}).attr("height",20).attr("width",1*i/f).style("fill",function(a){return j.colorScale(e(a))}),d=d3.scale.linear().domain([-this.max,this.max]).range([0,i]),a=d3.svg.axis().scale(d).orient("bottom").tickSize(5),b.append("g").attr("transform","translate(0, 20)").call(a).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy","-0.4em").attr("transform","rotate(-90)")},a.prototype.set_order=function(a){this.order=a},a.prototype._show_calc_info=function(a){return this.info.text(a)},a.prototype._worker_callback=function(a){if(null!=a.error&&log_error("Worker error : "+a.error),null!=a.upto&&this._show_calc_info("Clustered "+a.upto+" of "+this.data.length),null!=a.done&&(this.order=a.done,this._render_heatmap(),this._show_calc_info("")),null!=a.took)return log_debug("calc_order: took="+a.took+"ms for "+this.data.length+" points")},a.prototype._calc_order=function(){return this.worker.start([this.data,this.columns.map(function(a){return{idx:a.idx}})])},a.prototype._thinking=function(a){return this._is_thinking=a,this.svg.select("g.genes").attr("opacity",a?.4:1)},a.prototype.schedule_update=function(a){var b=this;if(a&&(this.rows=a),null!=this.rows&&null!=this.columns&&this._enabled)return scheduler.schedule("heatmap.render",function(){}),this.data=this.rows.map(function(a){return b.data_all[a.id]}),this._thinking(!0),this._calc_order()},a.prototype.update_columns=function(a,b,c){var d,e=this;return this.data_object=a,this.columns=b,this.height=this.opts.legend_height+this.opts.h_pad+this.opts.h*this.columns.length,this.svg.attr("width",this.opts.width).attr("height",this.height),this.data_all={},this.data_object.get_data().forEach(function(a){return e.data_all[a.id]=c?e._centre(a):a}),d=ParCoords.calc_extent(d3.values(this.data_all),this.columns),this.max=d3.max(d.map(Math.abs)),this._draw_columns(),this.schedule_update(this.data_object.get_data())},a.prototype._centre=function(a){var b,c;return b=d3.mean(this.columns.map(function(b){return a[b.idx]
})),c={},c.id=a.id,this.columns.map(function(d){return c[d.idx]=a[d.idx]-b}),c},a.prototype.reorder_columns=function(a){var b=this;return this.columns=a,this.columns_changed=!0,scheduler.schedule("heatmap.render",function(){if(!b._is_thinking)return b._render_heatmap()},200)},a.prototype._draw_columns=function(){var a,b=this;return a=this.svg.select(".labels").selectAll(".label").data(this.columns,function(a){return a.name}),a.enter().append("text").attr("class","label"),a.exit().remove(),a.attr("text-anchor","end").text(function(a){return a.name}).transition().attr("x",this.opts.label_width).attr("y",function(a,c){return c*b.opts.h+b.opts.h/2}),this._make_legend(),this.columns_changed=!1},a.prototype._render_heatmap=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this;for(this._thinking(!1),this.columns_changed&&this._draw_columns(),d={},m=this.data,j=0,l=m.length;j<l;j++)b=m[j],d[b.id]=b;for(this.cell_w=h=d3.min([this.opts.h,(this.opts.width-this.opts.label_width)/this.data.length]),g=[],e=void 0,f=k=0,n=this.order.length;0<=n?k<n:k>n;f=0<=n?++k:--k)i=Math.round(f*h),null!=e&&i===e||(g.push({x:i,rest:d[this.order[f]]}),e=i);return c=this.svg.select(".genes").selectAll("g.gene").data(g),c.enter().append("g").attr("class","gene"),c.exit().remove(),a=c.selectAll(".cell").data(function(a,b){var c,d,e,f;e=[],f=o.columns;for(d in f)c=f[d],e.push({x:a.x,col:d,score:a.rest[c.idx],id:a.rest.id});return e},function(a){return a.col}),a.enter().append("rect").attr("class","cell"),a.attr("width",Math.ceil(h)).attr("height",this.opts.h).style("fill",function(a){return o.colorScale(a.score)}).attr("x",function(a){return a.x}).attr("y",function(a){return a.col*o.opts.h}),a.exit().remove(),c.on("mouseover",function(a){return o.dispatch.mouseover(o.data_object.row_by_id(a.rest.id))}),c.on("mouseout",function(){return o.dispatch.mouseout()})},a.prototype.on=function(a,b){return this.dispatch.on(a,b)},a.prototype.highlight=function(a){var b,c,d=this;if(this._enabled&&!this._is_thinking)return c=a.map(function(a){return d.order.indexOf(a.id)}).filter(function(a){return a>=0}),0===c.length?void this.unhighlight():(b=this.svg.select(".genes").selectAll(".highlight").data(c),b.exit().remove(),b.enter().append("line").attr({class:"arrow highlight"}).attr({"marker-end":"url(#arrow)"}).attr("y1",this.opts.h*this.columns.length+20).attr("y2",this.opts.h*this.columns.length),b.transition().attr("x1",function(a){return Math.round((a+.5)*d.cell_w)}).attr("y1",this.opts.h*this.columns.length+20).attr({x2:function(a){return Math.round((a+.5)*d.cell_w)}}).attr("y2",this.opts.h*this.columns.length))},a.prototype.unhighlight=function(){return this.svg.select(".genes").selectAll(".highlight").remove()},a.prototype._create_brush=function(a){var b,c,d,e=this;return d=d3.scale.identity().domain([0,this.opts.width-this.opts.label_width]),b=d3.svg.brush().x(d).on("brushend",function(){var c,d;return d=b.extent(),c=e.svg.selectAll("rect.cell").data(),c.filter(function(b){return"0"===b.col&&d[0]<=b.row*a&&d[1]>=b.row*a})}),this.svg.select("g.brush").remove(),c=this.svg.append("g").attr("class","brush").attr("transform","translate("+this.opts.label_width+",0)").call(b),c.selectAll("rect").attr("height",100*this.opts.h_pad+this.opts.h*this.columns.length)},a}(),window.Heatmap=b}).call(this)},{"./lib/scale-color-perceptual/hex/viridis.json":22,"./lib/scale-color-perceptual/hex/inferno.json":23,"./lib/scale-color-perceptual/hex/magma.json":24,"./lib/scale-color-perceptual/hex/plasma.json":25}],21:[function(a,b,c){(function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};ia=0,Ea=function(){return ia+=1,$("#loading").show(),$("#dge-pc,#dge-ma,#dge-pca").css("opacity",.4)},u=function(){if(0===(ia-=1))return $("#loading").hide(),$("#dge-pc,#dge-ma,#dge-pca").css("opacity",1)},R=function(a){return $("<div/>").text(a).html()},e=function(){function a(a,b){this.settings=a,this.process_dge_data=b,$(".conditions").hide(),$(".config").hide(),$("a.show-r-code").hide()}return a.prototype.request_init_data=function(){var a=this;return Ea(),this.settings.csv_data?(log_info("Using embedded csv"),this._data_ready(this.settings.csv_data)):d3.text(this.settings.csv_file,"text/csv",function(b,c){return log_info("Downloaded csv"),log_debug("Downloaded csv",c,b),b?void log_error(b):a._data_ready(c)})},a.prototype._data_ready=function(a){var b;return b=this.settings.csv_format?d3.csv.parse(a):d3.tsv.parse(a),this.process_dge_data(b,this.settings.columns),u()},a.prototype.request_kegg_data=function(a){return log_error("Get KEGG data not supported without backend")},a}(),b=function(){function a(b,c,d){this.settings=b,this.full_settings=d,c||(window.location=a.config_url()),this.settings.config_locked&&!this.full_settings.is_owner?$("a.config").hide():($("a.config").removeClass("hide"),$("a.config").attr("href",a.config_url()))}return a.config_url=function(){return"config.html?code="+window.my_code},a.script=function(a,b){return window.my_code+"/"+a+(b?"?"+b:"")},a.prototype.request_kegg_data=function(b){return d3.tsv(a.script("kegg_titles"),function(a,c){return log_info("Downloaded kegg : rows="+c.length),log_debug("Downloaded kegg : rows="+c.length,c,a),b(c)})},a}(),d=function(){function a(a,c,d){this.settings=a,this.process_dge_data=c,this.full_settings=d,this.backend=new b(this.settings,this.settings.fc_columns.length>0,this.full_settings),$(".conditions").hide(),$("a.show-r-code").hide()}return a.prototype.request_kegg_data=function(a){return this.backend.request_kegg_data(a)},a.prototype.request_init_data=function(){var a,c=this;return a=b.script("csv"),Ea(),d3.text(a,function(a,b){var d,e;return log_info("Downloaded DGE CSV: len="+b.length),u(),a?void log_error(a):(d=c.settings.csv_format?d3.csv.parse(b):d3.tsv.parse(b),log_info("Parsed DGE CSV : rows="+d.length),log_debug("Parsed DGE CSV : rows="+d.length,d,a),e=c.settings.info_columns.map(function(a){return{idx:a,name:a,type:"info"}}),e.push({idx:"_dummy",type:"primary",name:c.settings.primary_name}),c.settings.fc_columns.forEach(function(a){return e.push({idx:a,type:"fc",name:a})}),e.push({idx:c.settings.fdr_column,name:c.settings.fdr_column,type:"fdr"}),e.push({idx:c.settings.avg_column,name:c.settings.avg_column,type:"avg"}),null!=c.settings.ec_column&&e.push({idx:c.settings.ec_column,name:"EC",type:"ec"}),null!=c.settings.link_column&&e.push({idx:c.settings.link_column,name:"link",type:"link"}),c.process_dge_data(d,e))})},a}(),c=function(){function a(a,c,d){var e=this;this.settings=a,this.process_dge_data=c,this.full_settings=d,this.backend=new b(this.settings,this.settings.replicates.length>0,this.full_settings),$(".conditions").show(),$("a.show-r-code").show(),$("select#dge-method").click(function(a){return e._select_sample()})}return a.prototype.request_kegg_data=function(a){return this.backend.request_kegg_data(a)},a.prototype.request_init_data=function(){return this._init_condition_selector()},a.prototype._extra_info=function(a){var b,c,d,e;if(b="",null!=a.sample_weights)for($(".weights-toggle").show(),b=$("<div></div>"),c=d=0,e=a.sample_weights.length;0<=e?d<e:d>e;c=0<=e?++d:--d)b.append("<div><span class='name'>"+a.samples[c]+"</span><span class='val'>"+a.sample_weights[c]+"</span></div>");else $(".weights-toggle").hide();return $(".weights").html(b)},a.prototype._request_dge_data=function(){var a,c,d,e=this;if(a=this.current_selection,!(a.length<=1))return c=this._get_dge_method(),d=b.script("dge","method="+c+"&fields="+encodeURIComponent(JSON.stringify(a))),Ea(),d3.json(d,function(b,c){var d,f,g;return u(),b?void log_error(b):null!=c.error?(log_error("Error doing DGE",c.error),$("div#error-modal .modal-body pre.error-msg").text(c.error.msg),$("div#error-modal .modal-body pre.error-input").text(c.error.input),void $("div#error-modal").modal()):(d=d3.csv.parse(c.csv),log_info("Downloaded DGE counts : rows="+d.length),log_debug("Downloaded DGE counts : rows="+d.length,d,b),log_info("Extra info : ",c.extra),e._extra_info(c.extra),f=e.settings.info_columns.map(function(a){return{idx:a,name:a,type:"info"}}),g=!0,a.forEach(function(a){var b;return b=g?"primary":"fc",f.push({idx:a,type:b,name:a}),g=!1}),f.push({idx:"adj.P.Val",name:"FDR",type:"fdr"}),f.push({idx:"AveExpr",name:"AveExpr",type:"avg"}),null!=d[0]["P.Value"]&&f.push({idx:"P.Value",name:"P value",type:"p"}),null!=e.settings.ec_column&&f.push({idx:e.settings.ec_column,name:"EC",type:"ec"}),null!=e.settings.link_column&&f.push({idx:e.settings.link_column,name:"link",type:"link"}),e.settings.replicates.forEach(function(a){var b,c;return b=a[0],c=a[1],c.forEach(function(a){return f.push({idx:a,name:a,type:"count",parent:b})})}),e.process_dge_data(d,f))})},a.prototype.request_r_code=function(a){var c,d,e;return c=this.current_selection,d=this._get_dge_method(),e=b.script("dge_r_code","method="+d+"&fields="+encodeURIComponent(JSON.stringify(c))),d3.text(e,function(b,c){return log_debug("Downloaded R Code : len="+c.length,c,b),a(c)})},a.prototype._get_dge_method=function(){return $("select#dge-method option:selected").val()},a.prototype._set_dge_method=function(a){return $("select#dge-method").val(a)},a.prototype._select_sample=function(a){var b,c=this;return b=this._get_dge_method(),new EditList({elem:".conditions",apply:function(){return c._update_samples()},cancel:function(){return c._set_selected_cols(c.current_selection),c._set_dge_method(b)}})},a.prototype._update_selected_cols=function(){var a;return a=[],$("#files input:checked").each(function(b,c){var d;return d=$(c).data("rep"),a.push(d)}),this.current_selection=a},a.prototype._set_selected_cols=function(a){return $("#files input:checkbox").each(function(b,c){var d;return d=$(c).data("rep"),$(c).prop("checked",La.call(a,d)>=0)})},a.prototype._update_samples=function(){return this._update_selected_cols(),this._request_dge_data()},a.prototype._init_condition_selector=function(){var a,b,c,d=this;return c=this.settings.init_select||[],b=this.settings.hidden_factor||[],a=$("<div></div>"),$.each(this.settings.replicates,function(c,d){var e,f;return f=d[0],La.call(b,f)>=0?a.append($("<div><label>"+f+"</label></div>")):(e=$("<label>\n <input type='checkbox' title='Select this condition' data-placement='right'> "+f+"\n</label>"),$("#files").append(e),$("input",e).data("rep",f))}),$("#files input").change(function(a){return d._select_sample(a)}),b.length>0&&($("#hidden-factors").append(a),$("#hidden-factors").show()),this._set_selected_cols(c),this._update_samples()},a}(),l=d3.scale.linear().domain([0,.05,1]).range(["brown","steelblue","steelblue"]).interpolate(d3.interpolateLab),p=d3.scale.category20().domain([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),o=function(a){return function(b){return l(b[a])}},ka=null,da=null,Ka=null,na=null,r=null,F=null,G=null,_=null,Q=null,D=null,B=null,ua=!1,za="no",A=1,x=0,Da=!0,z=null,w=null,ma=null,ha=50,ga=null,Ca=50,Ba=null,la=1,ma=null,va="",aa=[],P=null,E=!1,C=d3.scale.category10(),ba=function(a){var b,c,d,e,f,g,h;if(b=a.id,e=[],null!==(c=D.column_by_type("ec"))){for(h=D.get_data(),f=0,g=h.length;f<g;f++)d=h[f],d[c.idx]===b&&e.push(d);return r.highlight(e)}},K=function(a){var b;return r.highlight([a]),b=D.column_by_type("ec"),null!=b&&_.highlight(a[b.idx]),Q.highlight([a]),F.select(D,[a])},J=function(){return r.unhighlight(),$("#gene-info").html(""),_.unhighlight(),Q.unhighlight()},O=[{re:/^ENS/,link:"http://ensembl.org/Multi/Search/Results?q=%s;site=ensembl"},{re:/^CG/,link:"http://flybase.org/cgi-bin/uniq.html?species=Dmel&cs=yes&db=fbgn&caller=genejump&context=%s"},{re:/^/,link:"http://www.ncbi.nlm.nih.gov/gene/?&term=%s"}],N=function(a){var b,c,d;if(null!=a){for(c=0,d=O.length;c<d;c++)if(b=O[c],a.match(b.re))return b.link;return null}},H=function(a){var b,c,d;if(b=D.columns_by_type(["link"]),0===b.length&&(b=D.columns_by_type(["info"])),b.length>0&&(c=a[b[0].idx],d=null!=settings.link_url?settings.link_url:N(c),log_debug("Dbl click.  Using info/link",c,d),null!=d))return d=d.replace(/%s/,c),window.open(d),window.focus()},L=function(){return D.columns_by_type(["fc","primary"]).length>2?"parcoords":"ma"},ea=function(a){return a===L()?set_hash_var({plot:null}):set_hash_var({plot:a})},Ia=function(){return set_hash_var(M())},Ha=function(a){return ya(get_hash_vars(),a)},xa=function(a,b){var c,d;switch(a){case"mds":d=na,c=i;break;case"ma":d=da,c=f;break;case"parcoords":d=ka,c=h;break;case"volcano":d=Ka,c=k}if(r!==d||b)return c(),fa()},fa=function(){return r===na?($(".fdr-fld").toggleClass("warning",A<1),$(".fc-fld").toggleClass("warning",x>0)):($(".fdr-fld").toggleClass("warning",!1),$(".fc-fld").toggleClass("warning",!1))},M=function(){var a,b,c,d;return c=$("#select-pc").hasClass("active")?"parcoords":$("#select-ma").hasClass("active")?"ma":$("#select-pca").hasClass("active")?"mds":void 0,d={},d.plot=c,a=function(a,b){return a===b?null:a},d.show_counts=a(za,"no"),d.fdrThreshold=a(A,1),d.fcThreshold=a(x,0),d.sortAbsLogFC=a(Da,!0),b=$("select#fc-relative option:selected").val(),d.fc_relative=a(+b,0),"mds"===c&&(d.numGenesThreshold=ha,d.skipGenesThreshold=Ca,d.pcaDimension=la),d.searchStr=a(va,""),d.single_gene_expr=a($("#select-single-gene-expr").hasClass("active"),!1),d},ya=function(a,b){return null!=a.plot?xa(a.plot,b):xa(L(),b),null!=a.fdrThreshold&&z.set_val(a.fdrThreshold,!0),null!=a.fcThreshold&&w.set_val(a.fcThreshold,!0),null!=a.show_counts&&($("select#show-counts").val(a.show_counts),Ga(),G.invalidate()),null!=a.numGenesSlider&&ga.set_val(+a.numGenesThreshold,!0),null!=a.skipGenesSlider&&Ba.set_val(+a.skipGenesSlider,!0),null!=a.pcaDimension&&ma.set_val(+a.pcaDimension,!0),null!=a.searchStr&&Ja(a.searchStr,!0),Da=null==a.sortAbsLogFC||"false"!==a.sortAbsLogFC,a.single_gene_expr?j():g()},g=function(){return $("#select-options").addClass("active"),$("#select-single-gene-expr").removeClass("active"),$(".options").show(),$(".single-gene-expr").hide()},j=function(){return $("#select-single-gene-expr").addClass("active"),$("#select-options").removeClass("active"),$(".options").hide(),$(".single-gene-expr").show()},h=function(){return ea("parcoords"),r=ka,$("#dge-ma,#dge-pca,#dge-volcano").hide(),$("#dge-pc").show(),$("#select-pc").addClass("active"),$("#select-ma,#select-pca,#select-volcano").removeClass("active"),$(".ma-fc-col-opt").hide(),$(".pca-opts").hide(),Q.enabled(!0),Fa()},f=function(){return ea("ma"),r=da,$("#dge-pc,#dge-pca,#dge-volcano").hide(),$("#dge-ma").show(),$("#select-ma").addClass("active"),$("#select-pc,#select-pca,#select-volcano").removeClass("active"),$(".ma-fc-col-opt").show(),$(".pca-opts").hide(),Q.enabled(!0),Fa()},k=function(){return ea("volcano"),r=Ka,$("#dge-pc,#dge-pca,#dge-ma").hide(),$("#dge-volcano").show(),$("#select-volcano").addClass("active"),$("#select-pc,#select-pca,#select-ma").removeClass("active"),$(".ma-fc-col-opt").show(),$(".pca-opts").hide(),Q.enabled(!0),Fa()},i=function(){return ea("mds"),r=na,$("#dge-pc,#dge-ma,#dge-volcano").hide(),$("#dge-pca").show(),$("#select-pca").addClass("active"),$("#select-pc,#select-ma,#select-volcano").removeClass("active"),$(".ma-fc-col-opt").hide(),Q.enabled(!1),$(".pca-opts").show(),ga.set_max(100,1,D.get_data().length,!0),Ba.set_max(0,0,D.get_data().length,!0),Fa()},n=function(){var a;if(a=$(".container").width(),$(".conditions").is(":visible")&&(a-=$(".conditions").outerWidth(!0)),$("div.filter").is(":visible"))return a-=$("div.filter").outerWidth(!0)},V=function(){var a;return a=[{title:function(){return"<input type='checkbox' style='margin-right:10px;' "+(Da?"checked":"")+"/><label>Sorting by ABSOLUTE logFC</label>"},action:function(){return Da=!Da,G.resort()}}],d3.select("#grid").on("contextmenu",d3.contextMenu(a)),d3.select(".gene-table-settings").on("click",function(b){var c;return d3.event.preventDefault(),c={onPostOpen:function(a){return console.log("move!"),a.style("left",d3.event.pageX-250+"px")}},d3.contextMenu(a,c)()})},T=function(){var a;return G=new GeneTable({elem:"#grid",elem_info:"#grid-info",sorter:t,mouseover:K,mouseout:J,dblclick:H,filter:I}),V(),ka=new ParCoords({elem:"#dge-pc",width:n(),filter:v}),da=new MAPlot({elem:"#dge-ma",filter:v,xaxis_loc:"zero",brush_enable:!0,canvas:!0,height:300,width:600}),da.on("mouseover.main",function(a){return Q.highlight(a),F.select(D,a)}),da.on("mouseout.main",function(){return Q.unhighlight()}),Ka=new VolcanoPlot({elem:"#dge-volcano",filter:v,yaxis_loc:"zero",brush_enable:!0,canvas:!0,height:300,width:600}),Ka.on("mouseover.main",function(a){return Q.highlight(a),F.select(D,a)}),Ka.on("mouseout.main",function(){return Q.unhighlight()}),na=new GenePCA({elem:"#dge-pca",filter:v,colour:C,sel_dimension:function(a){return ma.set_val(+a,!0)},params:function(){return{skip:+Ca,num:+ha,dims:[+la,+la+1,+la+2],plot_2d3d:$("select#mds-2d3d option:selected").val()}}}),na.on("top_genes",function(a){return G.set_data(a),Q.schedule_update(a)}),_=new Kegg({elem:"div#kegg-image",mouseover:ba,mouseout:function(){return r.unhighlight()}}),ka.on("brush",function(a){return G.set_data(a),Q.schedule_update(a)}),da.on("brush",function(a){return G.set_data(a),Q.schedule_update(a)}),Ka.on("brush",function(a){return G.set_data(a),Q.schedule_update(a)}),a=function(a,b){var c,d,e,f,g;for(e={},c=f=0,g=b.length;0<=g?f<g:f>g;c=0<=g?++f:--f)e[b[c]]=c;return d=a.slice(),d.sort(function(a,b){return e[a.parent]===e[b.parent]?0:e[a.parent]<e[b.parent]?-1:1}),d},ka.on("render",function(){var b,c,d;if(Q.columns)return b=ka.dimension_names(),c=ka.dimensions().map(function(a){return b[a]}),d=a(Q.columns,c),Q.reorder_columns(d)}),Q=new Heatmap({elem:"#heatmap",show_elem:".show-heatmap"}),Q.on("mouseover",function(a){var b,c,d,e,f;for(r.highlight([a]),c="",f=D.columns_by_type(["info"]),d=0,e=f.length;d<e;d++)b=f[d],c+="<span class='lbl'>"+b.name+": </span><span>"+a[b.idx]+"</span>";return $("#heatmap-info").html(c),F.select(D,[a])}),Q.on("mouseout",function(a){return r.unhighlight(),$("#heatmap-info").html("")}),Q.on("need_update",function(){return Fa()}),F=new GeneExpression({elem:".single-gene-expr",width:233,colour:C})},q=function(a,b){return a===b?0:a>b?1:-1},t=function(a){var b;return b=D.column_by_idx(a.sortCol.field),G.sort(function(c,d){var e,f;return 0,e=c[b.idx],f=d[b.idx],("fc_calc"===b.type?Da?q(Math.abs(e),Math.abs(f)):q(e,f):(b.type,q(e,f)))*(a.sortAsc?1:-1)})},wa=function(a){var b,c;return b=D.columns_by_type(["info","fdr","p"]),b=b.concat(D.columns_by_type("fc_calc")),c=b.map(function(a){var b,c;switch(b={id:a.idx,name:a.name,field:a.idx,sortable:!0,formatter:function(b,c,d,e,f){var g;return"fc_calc"===a.type?y(d,a,f):"fdr"===(g=a.type)||"p"===g?d<.01?d.toExponential(2):d.toFixed(2):d}},"fdr"!==(c=a.type)&&"p"!==c||(b.width=70,b.maxWidth=70),a.type){case"fdr":b.toolTip="False Discovery Rate";break;case"p":b.toolTip="Raw P value";break;case"fc_calc":b.toolTip="Log<sub>2</sub> Fold-change"}return b}),G.set_data(a,c)},y=function(a,b,c){var d,e,f,g;return d=a>.1?"pos":a<-.1?"neg":"",e="","yes"===za?(f=D.assoc_column_by_type("count",b.name),g=f.map(function(a,b){return"<span>"+c[a.idx]+"</span>"}),e="<span class='counts'>("+g.join(" ")+")</span>"):"cpm"===za&&(f=D.assoc_column_by_type("count",b.name),g=f.map(function(a){var b;return b=D.get_total(a),"<span>"+(1e6*c[a.idx]/b).toFixed(1)+"</span>"}),e="<span class='counts'>("+g.join(" ")+")</span>"),"<div class='"+d+"'>"+a.toFixed(2)+e+"</div>"},I=function(a){var b,c,d,e,f;if(""===va)return!0;for(f=D.columns_by_type("info"),d=0,e=f.length;d<e;d++)if(b=f[d],null!=(c=a[b.idx])&&"string"==typeof c&&c.toLowerCase().indexOf(va)>=0)return!0;return!1},v=function(a){var b,c,d,e,f;return!(x>0&&(d=D.columns_by_type("fc").map(function(b){return a[b.idx]}),c=d3.extent(d.concat([0])),Math.abs(c[0]-c[1])<x))&&(e=D.columns_by_type("fdr")[0],!(a[e.idx]>A)&&(!(aa.length>0)||(b=D.column_by_type("ec"),f=a[b.idx],La.call(aa,f)>=0)))},Ja=function(a,b){if(null==b&&(b=!1),va=a.toLowerCase(),$(".tab-search input").toggleClass("active",""!==va),G.refresh(),b)return $(".tab-search input").val(a)},Y=function(){return $(".tab-search input").keyup(function(a){return Slick.GlobalEditorLock.cancelCurrentEdit(),27===a.which&&(this.value=""),Ja(this.value)})},ja=function(a,b){return["ODF 1.0","HeaderLines=4","Model= Dataset","DataLines="+b.length,"COLUMN_TYPES: "+a.map(function(a){return"info"===a.type?"String":"double"}).join("\t"),"COLUMN_NAMES: "+a.map(function(a){return a.name}).join("\t")].concat(b.map(function(a){return a.join("\t")})).join("\n")},s=function(a){var b,c,d,e,f,g,h,i,j,k;if(f=G.get_data(),0!==f.length){switch(b=D.columns_by_type(["info","fc_calc","count","fdr","avg","p"]),d=D.columns_by_type("count"),g=b.map(function(a){return a.name}).concat(d.map(function(a){return a.name+" CPM"})),k=f.map(function(a){var c;return c=d.map(function(b){return(a[b.idx]/(D.get_total(b)/1e6)).toFixed(3)}),b.map(function(b){return a[b.idx]}).concat(c)}),i="text/csv",a){case"csv":e="degust.csv",j=d3.csv.format([g].concat(k));break;case"tsv":e="degust.tsv",j=d3.tsv.format([g].concat(k));break;case"odf":i="text/plain",e="degust.odf",c=b.concat(d.map(function(a){return{type:"cpm",name:a.name+" CPM"}})),j=ja(c,k)}return h=document.createElement("a"),h.setAttribute("href",window.URL.createObjectURL(new Blob([j],{type:i}))),h.setAttribute("download",e),document.body.appendChild(h),h.click(),h.remove()}},U=function(){return $("a#csv-download").on("click",function(a){return a.preventDefault(),s("csv")}),$("a.download-csv").on("click",function(a){return a.preventDefault(),s("csv")}),$("a.download-tsv").on("click",function(a){return a.preventDefault(),s("tsv")}),$("a.download-odf").on("click",function(a){return a.preventDefault(),s("odf")})},W=function(){return $(".geneset-save").on("click",function(){return console.log("SAVE")}),$(".geneset-search input.search").autocomplete({source:"/gene-sets",minLength:2,select:function(a,b){if(b.item)return d3.json("/gene-sets/"+b.item.id,function(a,c){return console.log("JSON",b,c)})}})},qa=function(){return r.brush()},Z=function(){var a;return z=new Slider({id:"#fdrSlider",input_id:"input.fdr-fld",step_values:[0,1e-6,1e-5,1e-4,.001,.01,.02,.03,.04,.05,.1,1],val:A,validator:function(a){var b;return b=Number(a),!(isNaN(b)||b<0||b>1)},on_change:function(a){if(Slick.GlobalEditorLock.cancelCurrentEdit(),A!==a)return window.clearTimeout(P),P=window.setTimeout(qa,10),A=a,fa()}}),$(".shortcut-fdr a").click(function(a){return a.preventDefault(),z.set_val($(this).data("val"),!0)}),w=new Slider({id:"#fcSlider",input_id:"input.fc-fld",step_values:function(){var b,c;for(c=[],a=b=0;b<=5;a=b+=.01)c.push(Number(a.toFixed(2)));return c}(),val:x,validator:function(a){var b;return b=Number(a),!(isNaN(b)||b<0)},on_change:function(a){if(Slick.GlobalEditorLock.cancelCurrentEdit(),x!==a)return window.clearTimeout(P),P=window.setTimeout(qa,10),x=a,fa()}}),$(".shortcut-fc a").click(function(a){return a.preventDefault(),w.set_val($(this).data("val"),!0)}),ga=new Slider({id:"#numGenesSlider",input_id:"input.num-genes-fld",val:ha,validator:function(a){var b;return b=Number(a),!(isNaN(b)||b<0)},on_change:function(a){if(Slick.GlobalEditorLock.cancelCurrentEdit(),ha!==a)return window.clearTimeout(P),P=window.setTimeout(qa,10),ha=a}}),Ba=new Slider({id:"#skipGenesSlider",input_id:"input.skip-genes-fld",val:Ca,validator:function(a){var b;return b=Number(a),!(isNaN(b)||b<0)},on_change:function(a){if(Slick.GlobalEditorLock.cancelCurrentEdit(),Ca!==a)return window.clearTimeout(P),P=window.setTimeout(qa,10),Ca=a}}),ma=new Slider({id:"#pcaDimsSlider",input_id:"input.pca-dims-fld",step_values:[1,2,3,4,5,6,7,8,9,10],val:la,fmt:function(a){return a+" vs "+(a+1)},validator:function(a){var b;return b=Number(a),!(isNaN(b)||b<0)},on_change:function(a){if(la!==a)return window.clearTimeout(P),P=window.setTimeout(qa,10),la=a}}),$("#fc-relative").change(function(a){return Fa()}),$("#ma-fc-col").change(function(a){return Fa()}),$("#show-counts").change(function(a){return Ga(),G.invalidate()}),$("#mds-2d3d").change(function(a){return qa()})},m=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;if(e={},null!==(d=D.column_by_type("ec"))){for(f=D.columns_by_type("fc_calc").slice(1),m=D.get_data(),i=0,k=m.length;i<k;i++)if(g=m[i],c=g[d.idx])for(j=0,l=f.length;j<l;j++)a=f[j],h=g[a.idx],b=h>.1?"up":h<-.1?"down":"same",e[c]||(e[c]=b),e[c]!==b&&(e[c]="mixed");return e}},ca=function(){var a,b,c,d;return a=$("select#kegg option:selected").val(),d=$("select#kegg option:selected").text(),c=function(a){return aa=a,Fa()},a?(b=m(),_.load(a,b,c),$("div#kegg-image").dialog({width:500,height:600,title:d,position:{my:"right top",at:"right top+60",of:$("body")}})):c([])},pa=function(a){var b,c,d,e,f,g,h;if(!ua){for(ua=!0,d="<option value=''>--- No pathway selected ---</option>",c={},b=D.column_by_type("ec"),h=D.get_data(),f=0,g=h.length;f<g;f++)e=h[f],c[e[b.idx]]=1;return a.sort(function(a,b){return a=a.title.toLowerCase(),b=b.title.toLowerCase(),a===b?0:a<b?-1:1}),a.forEach(function(a){var b,e,f,g,h;for(e=0,h=a.ec.split(" ").filter(function(a){return a.length>0}),f=0,g=h.length;f<g;f++)b=h[f],c[b]&&e++;if(e>0)return d+="<option value='"+a.code+"'>"+a.title+" ("+e+")</option>"}),$("select#kegg").html(d),$(".kegg-filter").show()}},oa=function(a,b){var c,d,e,f,g,h,i,j,k;for(D=new GeneData(a,b),e="",j=D.columns_by_type(["fc","primary"]),d=f=0,h=j.length;f<h;d=++f)c=j[d],e+="<option value='"+d+"'>"+R(c.name)+"</option>";for(e+="<option value='-1'>Average</option>",$("select#fc-relative").html(e),e="",k=D.columns_by_type(["fc","primary"]),d=g=0,i=k.length;g<i;d=++g)c=k[d],e+="<option value='"+d+"' "+(1===d?"selected":"")+">"+R(c.name)+"</option>";if($("select#ma-fc-col").html(e),null===D.column_by_type("ec")?$(".kegg-filter").hide():ua||B.request_kegg_data(pa),0===D.columns_by_type("count").length?($(".show-counts-opt").hide(),$("#select-pca").hide()):($(".show-counts-opt").show(),$("#select-pca").show()),Ha(!0),!E)return E=!0,setup_tour(null==settings.show_tour||settings.show_tour)},Ga=function(){return za=$("select#show-counts option:selected").val()},Fa=function(){var a,b,c,d,e,f,g,h,i,j;return Ga(),g=$("select#fc-relative option:selected").val(),g=g<0?"avg":D.columns_by_type(["fc","primary"])[g],D.set_relative(g),d=D.columns_by_type("fc_calc"),j=D.column_by_type("fdr"),r===ka?(e=ParCoords.calc_extent(D.get_data(),d),ka.update_data(D.get_data(),d,e,o(j.idx))):r===da?(i=$("select#ma-fc-col option:selected").val(),i=D.columns_by_type(["fc","primary"])[i].name,f=D.columns_by_type("fc_calc").filter(function(a){return a.name===i})[0],da.update_data(D.get_data(),D.columns_by_type("avg")[0],f,o(j.idx),D.columns_by_type("info"),j)):r===Ka?(i=$("select#ma-fc-col option:selected").val(),i=D.columns_by_type(["fc","primary"])[i].name,f=D.columns_by_type("fc_calc").filter(function(a){return a.name===i})[0],Ka.update_data(D.get_data(),f,j,o(j.idx),D.columns_by_type("info"))):r===na&&(b=D.columns_by_type("fc_calc").map(function(a){return a.name}),c=D.columns_by_type("count").filter(function(a){return b.indexOf(a.parent)>=0}),na.update_data(D,c)),wa(D.get_data()),Q.enabled()&&(Q.show_replicates?(c=d.map(function(a){return D.assoc_column_by_type("count",a.name)}),c=[].concat.apply([],c),h=Normalize.normalize(D,c),a=!0):(h=D.columns_by_type("fc_calc_avg"),a=!0),Q.update_columns(D,h,a)),r.brush()},Aa=function(){return B.request_r_code(function(a){return $("div#code-modal .modal-body pre").text(a),$("div#code-modal").modal()})},ta=function(a){var b,c;return c={asset_base:settings.asset_base||"",home_link:settings.home_link||"/"},b=$(a(c)),$("#replace-me").replaceWith(b),$("#main-loading").hide(),setup_nav_bar(),$("[title]").tooltip()},sa=function(){return ta(a("../templates/compare-body.hbs"))},ra=function(){return ta(a("../templates/fail.hbs"))},X=function(a){var b;return sa(),D=new GeneData([],[]),B=a?settings.analyze_server_side?new c(settings,oa,full_settings):new d(settings,oa,full_settings):new e(settings,oa),b=settings.name||"Unnamed",$(".exp-name").text(b),document.title=b,void 0!==settings.fdrThreshold&&(A=settings.fdrThreshold),void 0!==settings.fcThreshold&&(x=settings.fcThreshold),"undefined"!=typeof full_settings&&null!==full_settings&&full_settings.extra_menu_html&&$("#right-navbar-collapse").append(full_settings.extra_menu_html),$("select#kegg").change(ca),$("#select-pc a").click(function(a){return a.preventDefault(),xa("parcoords")}),$("#select-ma a").click(function(a){return a.preventDefault(),xa("ma")}),$("#select-pca a").click(function(a){return a.preventDefault(),xa("mds")}),$("#select-volcano a").click(function(a){return a.preventDefault(),xa("volcano")}),$("#select-options a").click(function(a){return a.preventDefault(),g()}),$("#select-single-gene-expr a").click(function(a){return a.preventDefault(),j()}),$("a.show-r-code").click(function(a){return a.preventDefault(),Aa()}),$("a.update-link").click(function(a){return a.preventDefault(),Ia()}),$("a.p-value-histogram").click(function(a){return a.preventDefault(),QC.pvalue_histogram(D)}),$("a.bargraph-libsize").click(function(a){return a.preventDefault(),QC.library_size_bargraph(D,C)}),$("a.expression-boxplot").click(function(a){return a.preventDefault(),QC.expression_boxplot(D,C)}),T(),Y(),Z(),U(),W(),B.request_init_data(),$(window).bind("resize",function(){return Q.resize()})},S=function(){var a;return a=get_url_vars().code,null==a?X(!1):(window.my_code=a,$.ajax({type:"GET",url:b.script("settings"),dataType:"json"}).done(function(a){return window.full_settings=a,window.settings=a.settings,X(!0)}).fail(function(a){var b;return log_error("Failed to get settings!",a),ra(),b=$("<pre></pre>"),b.text("Error failed to get settings : "+a.responseText),$(".error-msg").append(b)}))},$(document).ready(function(){return S()})}).call(this)},{"../templates/compare-body.hbs":26,"../templates/fail.hbs":27}],2:[function(a,b,c){!function(a,b){var c,d;d=b.document,c=function(){function c(c){this._options=a.extend({name:"tour",steps:[],container:"body",keyboard:!0,storage:b.localStorage,debug:!1,backdrop:!1,redirect:!0,orphan:!1,duration:!1,basePath:"",template:"<div class='popover'>          <div class='arrow'></div>          <h3 class='popover-title'></h3>          <div class='popover-content'></div>          <div class='popover-navigation'>            <div class='btn-group'>              <button class='btn btn-sm btn-default' data-role='prev'>&laquo; Prev</button>              <button class='btn btn-sm btn-default' data-role='next'>Next &raquo;</button>              <button class='btn btn-sm btn-default' data-role='pause-resume' data-pause-text='Pause' data-resume-text='Resume'>Pause</button>            </div>            <button class='btn btn-sm btn-default' data-role='end'>End tour</button>          </div>        </div>",afterSetState:function(a,b){},afterGetState:function(a,b){},afterRemoveState:function(a){},onStart:function(a){},onEnd:function(a){},onShow:function(a){},onShown:function(a){},onHide:function(a){},onHidden:function(a){},onNext:function(a){},onPrev:function(a){},onPause:function(a,b){},onResume:function(a,b){}},c),this._force=!1,this._inited=!1,this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:!1,overlayElementShown:!1}}return c.prototype.addSteps=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)b=a[c],this.addStep(b);return this},c.prototype.addStep=function(a){return this._options.steps.push(a),this},c.prototype.getStep=function(b){if(null!=this._options.steps[b])return a.extend({id:"step-"+b,path:"",placement:"right",title:"",content:"<p></p>",next:b===this._options.steps.length-1?-1:b+1,prev:b-1,animation:!0,container:this._options.container,backdrop:this._options.backdrop,redirect:this._options.redirect,orphan:this._options.orphan,duration:this._options.duration,template:this._options.template,
onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume},this._options.steps[b])},c.prototype.init=function(a){var b=this;return this._force=a,this.ended()?(this._debug("Tour ended, init prevented."),this):(this.setCurrentStep(),this._initMouseNavigation(),this._initKeyboardNavigation(),this._onResize(function(){return b.showStep(b._current)}),null!==this._current&&this.showStep(this._current),this._inited=!0,this)},c.prototype.start=function(a){var b;return null==a&&(a=!1),this._inited||this.init(a),null===this._current&&(b=this._makePromise(null!=this._options.onStart?this._options.onStart(this):void 0),this._callOnPromiseDone(b,this.showStep,0)),this},c.prototype.next=function(){var a;return a=this.hideStep(this._current),this._callOnPromiseDone(a,this._showNextStep)},c.prototype.prev=function(){var a;return a=this.hideStep(this._current),this._callOnPromiseDone(a,this._showPrevStep)},c.prototype.goTo=function(a){var b;return b=this.hideStep(this._current),this._callOnPromiseDone(b,this.showStep,a)},c.prototype.end=function(){var c,e,f=this;return c=function(c){if(a(d).off("click.tour-"+f._options.name),a(d).off("keyup.tour-"+f._options.name),a(b).off("resize.tour-"+f._options.name),f._setState("end","yes"),f._inited=!1,f._force=!1,f._clearTimer(),null!=f._options.onEnd)return f._options.onEnd(f)},e=this.hideStep(this._current),this._callOnPromiseDone(e,c)},c.prototype.ended=function(){return!this._force&&!!this._getState("end")},c.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this.setCurrentStep(0),this.start()},c.prototype.pause=function(){var a;return(a=this.getStep(this._current))&&a.duration?(this._paused=!0,this._duration-=(new Date).getTime()-this._start,b.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining)."),null!=a.onPause?a.onPause(this,this._duration):void 0):this},c.prototype.resume=function(){var a,c=this;return(a=this.getStep(this._current))&&a.duration?(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||a.duration,this._timer=b.setTimeout(function(){return c._isLast()?c.next():c.end()},this._duration),this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration),null!=a.onResume&&this._duration!==a.duration?a.onResume(this,this._duration):void 0):this},c.prototype.hideStep=function(b){var c,d,e,f=this;if(e=this.getStep(b))return this._clearTimer(),d=this._makePromise(null!=e.onHide?e.onHide(this,b):void 0),c=function(b){var c;if(c=a(e.element),c.data("bs.popover")||c.data("popover")||(c=a("body")),c.popover("destroy"),e.reflex&&c.css("cursor","").off("click.tour-"+f._options.name),e.backdrop&&f._hideBackdrop(),null!=e.onHidden)return e.onHidden(f)},this._callOnPromiseDone(d,c),d},c.prototype.showStep=function(a){var b,c,e,f,g=this;return this.ended()?(this._debug("Tour ended, showStep prevented."),this):(f=this.getStep(a))?(e=a<this._current,b=this._makePromise(null!=f.onShow?f.onShow(this,a):void 0),c=function(b){var c,h;if(g.setCurrentStep(a),h=function(){switch(toString.call(f.path)){case"[object Function]":return f.path();case"[object String]":return this._options.basePath+f.path;default:return f.path}}.call(g),c=[d.location.pathname,d.location.hash].join(""),g._isRedirect(h,c))return void g._redirect(f,h);if(g._isOrphan(f)){if(!f.orphan)return g._debug("Skip the orphan step "+(g._current+1)+". Orphan option is false and the element doesn't exist or is hidden."),void(e?g._showPrevStep():g._showNextStep());g._debug("Show the orphan step "+(g._current+1)+". Orphans option is true.")}return f.backdrop&&g._showBackdrop(g._isOrphan(f)?void 0:f.element),g._scrollIntoView(f.element,function(){return null!=f.element&&f.backdrop&&g._showOverlayElement(f.element),g._showPopover(f,a),null!=f.onShown&&f.onShown(g),g._debug("Step "+(g._current+1)+" of "+g._options.steps.length)}),f.duration?g.resume():void 0},this._callOnPromiseDone(b,c),b):void 0},c.prototype.getCurrentStep=function(){return this._current},c.prototype.setCurrentStep=function(a){return null!=a?(this._current=a,this._setState("current_step",a)):(this._current=this._getState("current_step"),this._current=null===this._current?null:parseInt(this._current,10)),this},c.prototype._setState=function(a,b){var c,d;if(this._options.storage){d=this._options.name+"_"+a;try{this._options.storage.setItem(d,b)}catch(e){c=e,c.code===DOMException.QUOTA_EXCEEDED_ERR&&this.debug("LocalStorage quota exceeded. State storage failed.")}return this._options.afterSetState(d,b)}return null==this._state&&(this._state={}),this._state[a]=b},c.prototype._removeState=function(a){var b;return this._options.storage?(b=this._options.name+"_"+a,this._options.storage.removeItem(b),this._options.afterRemoveState(b)):null!=this._state?delete this._state[a]:void 0},c.prototype._getState=function(a){var b,c;return this._options.storage?(b=this._options.name+"_"+a,c=this._options.storage.getItem(b)):null!=this._state&&(c=this._state[a]),void 0!==c&&"null"!==c||(c=null),this._options.afterGetState(a,c),c},c.prototype._showNextStep=function(){var a,b,c,d=this;return c=this.getStep(this._current),b=function(a){return d.showStep(c.next)},a=this._makePromise(null!=c.onNext?c.onNext(this):void 0),this._callOnPromiseDone(a,b)},c.prototype._showPrevStep=function(){var a,b,c,d=this;return c=this.getStep(this._current),b=function(a){return d.showStep(c.prev)},a=this._makePromise(null!=c.onPrev?c.onPrev(this):void 0),this._callOnPromiseDone(a,b)},c.prototype._debug=function(a){if(this._options.debug)return b.console.log("Bootstrap Tour '"+this._options.name+"' | "+a)},c.prototype._isRedirect=function(a,b){return null!=a&&""!==a&&("[object RegExp]"===toString.call(a)&&!a.test(b)||"[object String]"===toString.call(a)&&a.replace(/\?.*$/,"").replace(/\/?$/,"")!==b.replace(/\/?$/,""))},c.prototype._redirect=function(b,c){return a.isFunction(b.redirect)?b.redirect.call(this,c):!0===b.redirect?(this._debug("Redirect to "+c),d.location.href=c):void 0},c.prototype._isOrphan=function(b){return null==b.element||!a(b.element).length||a(b.element).is(":hidden")&&"http://www.w3.org/2000/svg"!==a(b.element)[0].namespaceURI},c.prototype._isLast=function(){return this._current<this._options.steps.length-1},c.prototype._showPopover=function(b,c){var d,e,f,g,h,i,j=this;if(i=a.extend({},this._options),f=a(a.isFunction(b.template)?b.template(c,b):b.template),e=f.find(".popover-navigation"),h=this._isOrphan(b),h&&(b.element="body",b.placement="top",f=f.addClass("orphan")),d=a(b.element),f.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+c),b.options&&a.extend(i,b.options),b.reflex&&d.css("cursor","pointer").on("click.tour-"+this._options.name,function(){return j._isLast()?j.next():j.end()}),b.prev<0&&e.find("[data-role='prev']").addClass("disabled"),b.next<0&&e.find("[data-role='next']").addClass("disabled"),b.duration||e.find("[data-role='pause-resume']").remove(),b.template=f.clone().wrap("<div>").parent().html(),d.popover({placement:b.placement,trigger:"manual",title:b.title,content:b.content,html:!0,animation:b.animation,container:b.container,template:b.template,selector:b.element}).popover("show"),g=d.data("bs.popover")?d.data("bs.popover").tip():d.data("popover").tip(),g.attr("id",b.id),this._reposition(g,b),h)return this._center(g)},c.prototype._reposition=function(b,c){var e,f,g,h,i,j,k;if(h=b[0].offsetWidth,f=b[0].offsetHeight,k=b.offset(),i=k.left,j=k.top,e=a(d).outerHeight()-k.top-b.outerHeight(),e<0&&(k.top=k.top+e),g=a("html").outerWidth()-k.left-b.outerWidth(),g<0&&(k.left=k.left+g),k.top<0&&(k.top=0),k.left<0&&(k.left=0),b.offset(k),"bottom"===c.placement||"top"===c.placement){if(i!==k.left)return this._replaceArrow(b,2*(k.left-i),h,"left")}else if(j!==k.top)return this._replaceArrow(b,2*(k.top-j),f,"top")},c.prototype._center=function(a){return a.css("top",b.innerHeight/2-a.outerHeight()/2)},c.prototype._replaceArrow=function(a,b,c,d){return a.find(".arrow").css(d,b?50*(1-b/c)+"%":"")},c.prototype._scrollIntoView=function(c,d){var e,f,g,h,i,j,k=this;return e=a(c),e.length?(f=a(b),h=e.offset().top,j=f.height(),i=Math.max(0,h-j/2),this._debug("Scroll into view. ScrollTop: "+i+". Element offset: "+h+". Window height: "+j+"."),g=0,a("body,html").stop(!0,!0).animate({scrollTop:Math.ceil(i)},function(){if(2==++g)return d(),k._debug("Scroll into view. Animation end element offset: "+e.offset().top+". Window height: "+f.height()+".")})):d()},c.prototype._onResize=function(c,d){return a(b).on("resize.tour-"+this._options.name,function(){return clearTimeout(d),d=setTimeout(c,100)})},c.prototype._initMouseNavigation=function(){var b=this;return b=this,a(d).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']:not(.disabled)").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']:not(.disabled)").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']:not(.disabled)",function(a){return a.preventDefault(),b.next()}).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']:not(.disabled)",function(a){return a.preventDefault(),b.prev()}).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",function(a){return a.preventDefault(),b.end()}).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(c){var d;return c.preventDefault(),d=a(this),d.text(b._paused?d.data("pause-text"):d.data("resume-text")),b._paused?b.resume():b.pause()})},c.prototype._initKeyboardNavigation=function(){var b=this;if(this._options.keyboard)return a(d).on("keyup.tour-"+this._options.name,function(a){if(a.which)switch(a.which){case 39:return a.preventDefault(),b._isLast()?b.next():b.end();case 37:if(a.preventDefault(),b._current>0)return b.prev();break;case 27:return a.preventDefault(),b.end()}})},c.prototype._makePromise=function(b){return b&&a.isFunction(b.then)?b:null},c.prototype._callOnPromiseDone=function(a,b,c){var d=this;return a?a.then(function(a){return b.call(d,c)}):b.call(this,c)},c.prototype._showBackdrop=function(b){if(!this.backdrop.backgroundShown)return this.backdrop=a("<div/>",{class:"tour-backdrop"}),this.backdrop.backgroundShown=!0,a("body").append(this.backdrop)},c.prototype._hideBackdrop=function(){return this._hideOverlayElement(),this._hideBackground()},c.prototype._hideBackground=function(){return this.backdrop.remove(),this.backdrop.overlay=null,this.backdrop.backgroundShown=!1},c.prototype._showOverlayElement=function(b){var c,d,e;if((d=a(b))&&0!==d.length&&!this.backdrop.overlayElementShown)return this.backdrop.overlayElementShown=!0,c=a("<div/>"),e=d.offset(),e.top=e.top,e.left=e.left,c.width(d.innerWidth()).height(d.innerHeight()).addClass("tour-step-background").offset(e),d.addClass("tour-step-backdrop"),a("body").append(c),this.backdrop.$element=d,this.backdrop.$background=c},c.prototype._hideOverlayElement=function(){if(this.backdrop.overlayElementShown)return this.backdrop.$element.removeClass("tour-step-backdrop"),this.backdrop.$background.remove(),this.backdrop.$element=null,this.backdrop.$background=null,this.backdrop.overlayElementShown=!1},c.prototype._clearTimer=function(){return b.clearTimeout(this._timer),this._timer=null,this._duration=null},c}(),b.Tour=c}(jQuery,window)},{}],3:[function(require,module,exports){!function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(a,b){var c,d,e,f;for(void 0===b&&(b=15),e=.5,c=new Date;;){for(e*=2,f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;if((d=new Date)-c>b)break}for(f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;return d=new Date,1e3*(3*e-1)/(d-c)},numeric._myIndexOf=function(a){var b,c=this.length;for(b=0;b<c;++b)if(this[b]===a)return b;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(a){function b(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+b(-a);if(isFinite(a)){var c=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,c),e=d.toPrecision(numeric.precision);return 10===parseFloat(e)&&(c++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+c.toString()}return"Infinity"}function c(a){var e;if(void 0===a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof a)return d.push('"'+a+'"'),!1;if("boolean"==typeof a)return d.push(a.toString()),!1;if("number"==typeof a){var f=b(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(e=1;e<i.length;e++)i[e].length<f.length&&(f=i[e]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(null===a)return d.push("null"),!1;if("function"==typeof a){d.push(a.toString());var j=!1;for(e in a)a.hasOwnProperty(e)&&(j?d.push(",\n"):d.push("\n{"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;for(d.push("["),e=0;e<a.length;e++)e>0&&(d.push(","),j&&d.push("\n ")),j=c(a[e]);return d.push("]"),!0}d.push("{");var j=!1;for(e in a)a.hasOwnProperty(e)&&(j&&d.push(",\n"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return d.push("}"),!0}var d=[];return c(a),d.join("")},numeric.parseDate=function(a){function b(a){if("string"==typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseFloat=function(a){function b(a){if("string"==typeof a)return parseFloat(a);if(!(a instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseCSV=function(a){var b,c,d=a.split("\n"),e=[],f=/(([^'",]*)|('[^']*')|("[^"]*")),/g,g=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,h=function(a){return a.substr(0,a.length-1)},i=0;for(c=0;c<d.length;c++){var j,k=(d[c]+",").match(f);if(k.length>0){for(e[i]=[],b=0;b<k.length;b++)j=h(k[b]),g.test(j)?e[i][b]=parseFloat(j):e[i][b]=j;i++}}return e},numeric.toCSV=function(a){var b,c,d,e,f,g=numeric.dim(a);for(d=g[0],g[1],f=[],b=0;b<d;b++){for(e=[],c=0;c<d;c++)e[c]=a[b][c].toString();f[b]=e.join(", ")}return f.join("\n")+"\n"},numeric.getURL=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.send(),b},numeric.imageURL=function(a){function b(a){var b,c,d,e,f,g,h,i,j=a.length,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(b=0;b<j;b+=3)c=a[b],d=a[b+1],e=a[b+2],f=c>>2,g=((3&c)<<4)+(d>>4),h=((15&d)<<2)+(e>>6),i=63&e,b+1>=j?h=i=64:b+2>=j&&(i=64),l+=k.charAt(f)+k.charAt(g)+k.charAt(h)+k.charAt(i);return l}function c(a,b,c){void 0===b&&(b=0),void 0===c&&(c=a.length);var d,e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=-1,g=0;a.length;for(d=b;d<c;d++)g=255&(f^a[d]),f=f>>>8^e[g];return-1^f}var d,e,f,g,h,i,j,k,l,m,n=a[0].length,o=a[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,o>>24&255,o>>16&255,o>>8&255,255&o,n>>24&255,n>>16&255,n>>8&255,255&n,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=c(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,d=1,e=0,j=0;j<n;j++){for(j<n-1?p.push(0):p.push(1),h=3*o+1+(0===j)&255,i=3*o+1+(0===j)>>8&255,p.push(h),p.push(i),p.push(255&~h),p.push(255&~i),0===j&&p.push(0),k=0;k<o;k++)for(f=0;f<3;f++)h=a[f][j][k],h=h>255?255:h<0?0:Math.round(h),d=(d+h)%65521,e=(e+d)%65521,p.push(h);p.push(0)}return l=(e<<16)+d,p.push(l>>24&255),p.push(l>>16&255),p.push(l>>8&255),p.push(255&l),g=p.length-41,p[33]=g>>24&255,p[34]=g>>16&255,p[35]=g>>8&255,p[36]=255&g,m=c(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+b(p)},numeric._dim=function(a){for(var b=[];"object"==typeof a;)b.push(a.length),a=a[0];return b},numeric.dim=function(a){var b,c;return"object"==typeof a?(b=a[0],"object"==typeof b?(c=b[0],"object"==typeof c?numeric._dim(a):[a.length,b.length]):[a.length]):[]},numeric.mapreduce=function(a,b){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+b+';\nif(typeof x === "number") { var xi = x; '+a+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+a+";\n    xi = x[i-1];\n    "+a+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+a+"\n}\nreturn accum;")},numeric.mapreduce2=function(a,b){return Function("x","var n = x.length;\nvar i,xi;\n"+b+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+a+";\n}\nreturn accum;")},numeric.same=function a(b,c){var d,e;if(!(b instanceof Array&&c instanceof Array))return!1;if((e=b.length)!==c.length)return!1;for(d=0;d<e;d++)if(b[d]!==c[d]){if("object"!=typeof b[d])return!1;if(!a(b[d],c[d]))return!1}return!0},numeric.rep=function(a,b,c){void 0===c&&(c=0);var d,e=a[c],f=Array(e);if(c===a.length-1){for(d=e-2;d>=0;d-=2)f[d+1]=b,f[d]=b;return-1===d&&(f[0]=b),f}for(d=e-1;d>=0;d--)f[d]=numeric.rep(a,b,c+1);return f},numeric.dotMMsmall=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(f=a.length,g=b.length,h=b[0].length,i=Array(f),c=f-1;c>=0;c--){for(j=Array(h),k=a[c],e=h-1;e>=0;e--){for(l=k[g-1]*b[g-1][e],d=g-2;d>=1;d-=2)m=d-1,l+=k[d]*b[d][e]+k[m]*b[m][e];0===d&&(l+=k[0]*b[0][e]),j[e]=l}i[c]=j}return i},numeric._getCol=function(a,b,c){var d,e=a.length;for(d=e-1;d>0;--d)c[d]=a[d][b],--d,c[d]=a[d][b];0===d&&(c[0]=a[0][b])},numeric.dotMMbig=function(a,b){var c,d,e,f=numeric._getCol,g=b.length,h=Array(g),i=a.length,j=b[0].length,k=new Array(i),l=numeric.dotVV;for(--g,--i,d=i;-1!==d;--d)k[d]=Array(j);for(--j,d=j;-1!==d;--d)for(f(b,d,h),e=i;-1!==e;--e)0,c=a[e],k[e][d]=l(c,h);return k},numeric.dotMV=function(a,b){var c,d=a.length,e=(b.length,Array(d)),f=numeric.dotVV;for(c=d-1;c>=0;c--)e[c]=f(a[c],b);return e},numeric.dotVM=function(a,b){var c,d,e,f,g,h,i;for(e=a.length,f=b[0].length,g=Array(f),d=f-1;d>=0;d--){for(h=a[e-1]*b[e-1][d],c=e-2;c>=1;c-=2)i=c-1,h+=a[c]*b[c][d]+a[i]*b[i][d];0===c&&(h+=a[0]*b[0][d]),g[d]=h}return g},numeric.dotVV=function(a,b){var c,d,e=a.length,f=a[e-1]*b[e-1];for(c=e-2;c>=1;c-=2)d=c-1,f+=a[c]*b[c]+a[d]*b[d];return 0===c&&(f+=a[0]*b[0]),f},numeric.dot=function(a,b){var c=numeric.dim;switch(1e3*c(a).length+c(b).length){case 2002:return b.length<10?numeric.dotMMsmall(a,b):numeric.dotMMbig(a,b);case 2001:return numeric.dotMV(a,b);case 1002:return numeric.dotVM(a,b);case 1001:return numeric.dotVV(a,b);case 1e3:return numeric.mulVS(a,b);case 1:return numeric.mulSV(a,b);case 0:return a*b;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(a){var b,c,d,e,f=a.length,g=Array(f);for(b=f-1;b>=0;b--){for(e=Array(f),c=b+2,d=f-1;d>=c;d-=2)e[d]=0,e[d-1]=0;for(d>b&&(e[d]=0),e[b]=a[b],d=b-1;d>=1;d-=2)e[d]=0,e[d-1]=0;0===d&&(e[0]=0),g[b]=e}return g},numeric.getDiag=function(a){var b,c=Math.min(a.length,a[0].length),d=Array(c);for(b=c-1;b>=1;--b)d[b]=a[b][b],--b,d[b]=a[b][b];return 0===b&&(d[0]=a[0][0]),d},numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))},numeric.pointwise=function(a,b,c){void 0===c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="_s",f[a.length+1]="_k",f[a.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+h+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(i?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+a.join(",")+",_s,_k+1);\n    return ret;\n}\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n    "+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric.pointwise2=function(a,b,c){void 0===c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="var _n = "+h+".length;\nvar i"+(i?"":", ret = Array(_n)")+";\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n"+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric._biforeach=function a(b,c,d,e,f){if(e===d.length-1)return void f(b,c);var g,h=d[e];for(g=h-1;g>=0;g--)a("object"==typeof b?b[g]:b,"object"==typeof c?c[g]:c,d,e+1,f)},numeric._biforeach2=function a(b,c,d,e,f){if(e===d.length-1)return f(b,c);var g,h=d[e],i=Array(h);for(g=h-1;g>=0;--g)i[g]=a("object"==typeof b?b[g]:b,"object"==typeof c?c[g]:c,d,e+1,f);return i},numeric._foreach=function a(b,c,d,e){if(d===c.length-1)return void e(b);var f,g=c[d];for(f=g-1;f>=0;f--)a(b[f],c,d+1,e)},numeric._foreach2=function a(b,c,d,e){if(d===c.length-1)return e(b);var f,g=c[d],h=Array(g);for(f=g-1;f>=0;f--)h[f]=a(b[f],c,d+1,e);return h},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var c,d,e="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)?(e="var "+b+" = Math."+b+";\n",c=function(a,c,d){return a+" = "+b+"("+c+","+d+")"},d=function(a,c){return a+" = "+b+"("+a+","+c+")"}):(c=function(a,c,d){return a+" = "+c+" "+b+" "+d},d=numeric.opseq.hasOwnProperty(a+"eq")?function(a,c){return a+" "+b+"= "+c}:function(a,c){return a+" = "+a+" "+b+" "+c}),numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],c("ret[i]","x[i]","y[i]"),e),numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],c("ret[i]","x","y[i]"),e),numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],c("ret[i]","x[i]","y"),e),numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+d("x","y")+"\n}\nreturn x;\n"),numeric[b]=numeric[a],numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],d("ret[i]","x[i]"),e),numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],d("ret[i]","x"),e),numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(e="",b=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,a)&&Math.hasOwnProperty(b)&&(e="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",e),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",e),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(a,b){return"object"==typeof a?"object"==typeof b?numeric.truncVV(a,b):numeric.truncVS(a,b):"object"==typeof b?numeric.truncSV(a,b):Math.round(a/b)*b},numeric.inv=function(a){var b,c,d,e,f,g,h,a,i=numeric.dim(a),j=Math.abs,k=i[0],l=i[1],m=numeric.clone(a),n=numeric.identity(k);for(g=0;g<l;++g){var o=-1,p=-1;for(f=g;f!==k;++f)(h=j(m[f][g]))>p&&(o=f,p=h);for(c=m[o],m[o]=m[g],m[g]=c,e=n[o],n[o]=n[g],n[g]=e,a=c[g],h=g;h!==l;++h)c[h]/=a;for(h=l-1;-1!==h;--h)e[h]/=a;for(f=k-1;-1!==f;--f)if(f!==g){for(b=m[f],d=n[f],a=b[g],h=g+1;h!==l;++h)b[h]-=c[h]*a;for(h=l-1;h>0;--h)d[h]-=e[h]*a,--h,d[h]-=e[h]*a;0===h&&(d[0]-=e[0]*a)}}return n},numeric.det=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: det() only works on square matrices");var c,d,e,f,g,h,i,j,k=b[0],l=1,m=numeric.clone(a);for(d=0;d<k-1;d++){for(e=d,c=d+1;c<k;c++)Math.abs(m[c][d])>Math.abs(m[e][d])&&(e=c);for(e!==d&&(i=m[e],m[e]=m[d],m[d]=i,l*=-1),f=m[d],c=d+1;c<k;c++){for(g=m[c],h=g[d]/f[d],e=d+1;e<k-1;e+=2)j=e+1,g[e]-=f[e]*h,g[j]-=f[j]*h;e!==k&&(g[e]-=f[e]*h)}if(0===f[d])return 0;l*=f[d]}return l*m[d][d]},numeric.transpose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;c<h;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=e[c],f[b-1]=d[c],--c,f=i[c],f[b]=e[c],f[b-1]=d[c];0===c&&(f=i[0],f[b]=e[0],f[b-1]=d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=d[c],--c,i[c][0]=d[c];0===c&&(i[0][0]=d[0])}return i},numeric.negtranspose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;c<h;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=-e[c],f[b-1]=-d[c],--c,f=i[c],f[b]=-e[c],f[b-1]=-d[c];0===c&&(f=i[0],f[b]=-e[0],f[b-1]=-d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=-d[c],--c,i[c][0]=-d[c];0===c&&(i[0][0]=-d[0])}return i},numeric._random=function a(b,c){var d,e,f=b[c],g=Array(f);if(c===b.length-1){for(e=Math.random,d=f-1;d>=1;d-=2)g[d]=e(),g[d-1]=e();return 0===d&&(g[0]=e()),g}for(d=f-1;d>=0;d--)g[d]=a(b,c+1);return g},numeric.random=function(a){return numeric._random(a,0)},numeric.norm2=function(a){return Math.sqrt(numeric.norm2Squared(a))},numeric.linspace=function(a,b,c){if(void 0===c&&(c=Math.max(Math.round(b-a)+1,1)),c<2)return 1===c?[a]:[];var d,e=Array(c);for(c--,d=c;d>=0;d--)e[d]=(d*b+(c-d)*a)/c;return e},numeric.getBlock=function(a,b,c){function d(a,f){var g,h=b[f],i=c[f]-h,j=Array(i);if(f===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=d(a[g+h],f+1);return j}var e=numeric.dim(a);return d(a,0)},numeric.setBlock=function(a,b,c,d){function e(a,d,g){var h,i=b[g],j=c[g]-i;if(g===f.length-1)for(h=j;h>=0;h--)a[h+i]=d[h];for(h=j;h>=0;h--)e(a[h+i],d[h],g+1)}var f=numeric.dim(a);return e(a,d,0),a},numeric.getRange=function(a,b,c){var d,e,f,g,h=b.length,i=c.length,j=Array(h);for(d=h-1;-1!==d;--d)for(j[d]=Array(i),f=j[d],g=a[b[d]],e=i-1;-1!==e;--e)f[e]=g[c[e]];return j},numeric.blockMatrix=function(a){
var b=numeric.dim(a);if(b.length<4)return numeric.blockMatrix([a]);var c,d,e,f,g,h=b[0],i=b[1];for(c=0,d=0,e=0;e<h;++e)c+=a[e][0].length;for(f=0;f<i;++f)d+=a[0][f][0].length;var j=Array(c);for(e=0;e<c;++e)j[e]=Array(d);var k,l,m,n,o,p=0;for(e=0;e<h;++e){for(k=d,f=i-1;-1!==f;--f)for(g=a[e][f],k-=g[0].length,m=g.length-1;-1!==m;--m)for(o=g[m],l=j[p+m],n=o.length-1;-1!==n;--n)l[k+n]=o[n];p+=a[e][0].length}return j},numeric.tensor=function(a,b){if("number"==typeof a||"number"==typeof b)return numeric.mul(a,b);var c=numeric.dim(a),d=numeric.dim(b);if(1!==c.length||1!==d.length)throw new Error("numeric: tensor product is only defined for vectors");var e,f,g,h,i=c[0],j=d[0],k=Array(i);for(f=i-1;f>=0;f--){for(e=Array(j),h=a[f],g=j-1;g>=3;--g)e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g];for(;g>=0;)e[g]=h*b[g],--g;k[f]=e}return k},numeric.T=function(a,b){this.x=a,this.y=b},numeric.t=function(a,b){return new numeric.T(a,b)},numeric.Tbinop=function(a,b,c,d,e){numeric.indexOf;if("string"!=typeof e){var f;e="";for(f in numeric)numeric.hasOwnProperty(f)&&(a.indexOf(f)>=0||b.indexOf(f)>=0||c.indexOf(f)>=0||d.indexOf(f)>=0)&&f.length>1&&(e+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+d+");\n  }\n  return new numeric.T("+c+");\n}\nif(y.y) {\n  return new numeric.T("+b+");\n}\nreturn new numeric.T("+a+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var a=numeric.mul,b=numeric.div;if(this.y){var c=numeric.add(a(this.x,this.x),a(this.y,this.y));return new numeric.T(b(this.x,c),b(numeric.neg(this.y),c))}return new T(b(1,this.x))},numeric.T.prototype.div=function(a){if(a instanceof numeric.T||(a=new numeric.T(a)),a.y)return this.mul(a.reciprocal());var b=numeric.div;return this.y?new numeric.T(b(this.x,a.x),b(this.y,a.x)):new numeric.T(b(this.x,a.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),a(c)):new numeric.T(a(b))},numeric.T.prototype.transjugate=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),numeric.negtranspose(c)):new numeric.T(a(b))},numeric.Tunop=function(a,b,c){return"string"!=typeof c&&(c=""),Function("var x = this;\n"+c+"\nif(x.y) {  "+b+";\n}\n"+a+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var a=this;if(void 0===a.y)return new numeric.T(numeric.inv(a.x));var b,c,d,e,f,g,h,i,j,k,l,b,c,d,m,n,o,p,q,r,s,t=a.x.length,u=numeric.identity(t),v=numeric.rep([t,t],0),w=numeric.clone(a.x),x=numeric.clone(a.y);for(b=0;b<t;b++){for(o=w[b][b],p=x[b][b],m=o*o+p*p,d=b,c=b+1;c<t;c++)o=w[c][b],p=x[c][b],(n=o*o+p*p)>m&&(d=c,m=n);for(d!==b&&(s=w[b],w[b]=w[d],w[d]=s,s=x[b],x[b]=x[d],x[d]=s,s=u[b],u[b]=u[d],u[d]=s,s=v[b],v[b]=v[d],v[d]=s),e=w[b],f=x[b],i=u[b],j=v[b],o=e[b],p=f[b],c=b+1;c<t;c++)q=e[c],r=f[c],e[c]=(q*o+r*p)/m,f[c]=(r*o-q*p)/m;for(c=0;c<t;c++)q=i[c],r=j[c],i[c]=(q*o+r*p)/m,j[c]=(r*o-q*p)/m;for(c=b+1;c<t;c++){for(g=w[c],h=x[c],k=u[c],l=v[c],o=g[b],p=h[b],d=b+1;d<t;d++)q=e[d],r=f[d],g[d]-=q*o-r*p,h[d]-=r*o+q*p;for(d=0;d<t;d++)q=i[d],r=j[d],k[d]-=q*o-r*p,l[d]-=r*o+q*p}}for(b=t-1;b>0;b--)for(i=u[b],j=v[b],c=b-1;c>=0;c--)for(k=u[c],l=v[c],o=w[c][b],p=x[c][b],d=t-1;d>=0;d--)q=i[d],r=j[d],k[d]-=o*q-p*r,l[d]-=o*r+p*q;return new numeric.T(u,v)},numeric.T.prototype.get=function(a){var b,c=this.x,d=this.y,e=0,f=a.length;if(d){for(;e<f;)b=a[e],c=c[b],d=d[b],e++;return new numeric.T(c,d)}for(;e<f;)b=a[e],c=c[b],e++;return new numeric.T(c)},numeric.T.prototype.set=function(a,b){var c,d=this.x,e=this.y,f=0,g=a.length,h=b.x,i=b.y;if(0===g)return i?this.y=i:e&&(this.y=void 0),this.x=d,this;if(i){for(e||(e=numeric.rep(numeric.dim(d),0),this.y=e);f<g-1;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=i,this}if(e){for(;f<g-1;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,h instanceof Array?e[c]=numeric.rep(numeric.dim(h),0):e[c]=0,this}for(;f<g-1;)c=a[f],d=d[c],f++;return c=a[f],d[c]=h,this},numeric.T.prototype.getRows=function(a,b){var c,d,e=b-a+1,f=Array(e),g=this.x,h=this.y;for(c=a;c<=b;c++)f[c-a]=g[c];if(h){for(d=Array(e),c=a;c<=b;c++)d[c-a]=h[c];return new numeric.T(f,d)}return new numeric.T(f)},numeric.T.prototype.setRows=function(a,b,c){var d,e=this.x,f=this.y,g=c.x,h=c.y;for(d=a;d<=b;d++)e[d]=g[d-a];if(h)for(f||(f=numeric.rep(numeric.dim(e),0),this.y=f),d=a;d<=b;d++)f[d]=h[d-a];else if(f)for(d=a;d<=b;d++)f[d]=numeric.rep([g[d-a].length],0);return this},numeric.T.prototype.getRow=function(a){var b=this.x,c=this.y;return c?new numeric.T(b[a],c[a]):new numeric.T(b[a])},numeric.T.prototype.setRow=function(a,b){var c=this.x,d=this.y,e=b.x,f=b.y;return c[a]=e,f?(d||(d=numeric.rep(numeric.dim(c),0),this.y=d),d[a]=f):d&&(d=numeric.rep([e.length],0)),this},numeric.T.prototype.getBlock=function(a,b){var c=this.x,d=this.y,e=numeric.getBlock;return d?new numeric.T(e(c,a,b),e(d,a,b)):new numeric.T(e(c,a,b))},numeric.T.prototype.setBlock=function(a,b,c){c instanceof numeric.T||(c=new numeric.T(c));var d=this.x,e=this.y,f=numeric.setBlock,g=c.x,h=c.y;if(h)return e||(this.y=numeric.rep(numeric.dim(this),0),e=this.y),f(d,a,b,g),f(e,a,b,h),this;f(d,a,b,g),e&&f(e,a,b,numeric.rep(numeric.dim(g),0))},numeric.T.rep=function(a,b){var c=numeric.T;b instanceof c||(b=new c(b));var d=b.x,e=b.y,f=numeric.rep;return e?new c(f(a,d),f(a,e)):new c(f(a,d))},numeric.T.diag=function(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x,c=a.y,d=numeric.diag;return c?new numeric.T(d(b),d(c)):new numeric.T(d(b))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))},numeric.T.prototype.getDiag=function(){var a=numeric,b=this.x,c=this.y;return c?new a.T(a.getDiag(b),a.getDiag(c)):new a.T(a.getDiag(b))},numeric.house=function(a){var b=numeric.clone(a),c=a[0]>=0?1:-1,d=c*numeric.norm2(a);b[0]+=d;var e=numeric.norm2(b);if(0===e)throw new Error("eig: internal error");return numeric.div(b,e)},numeric.toUpperHessenberg=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var c,d,e,f,g,h,i,j,k,l,m=b[0],n=numeric.clone(a),o=numeric.identity(m);for(d=0;d<m-2;d++){for(f=Array(m-d-1),c=d+1;c<m;c++)f[c-d-1]=n[c][d];if(numeric.norm2(f)>0){for(g=numeric.house(f),h=numeric.getBlock(n,[d+1,d],[m-1,m-1]),i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;c<m;c++)for(j=n[c],k=i[c-d-1],e=d;e<m;e++)j[e]-=2*k[e-d];for(h=numeric.getBlock(n,[0,d+1],[m-1,m-1]),i=numeric.tensor(numeric.dot(h,g),g),c=0;c<m;c++)for(j=n[c],k=i[c],e=d+1;e<m;e++)j[e]-=2*k[e-d-1];for(h=Array(m-d-1),c=d+1;c<m;c++)h[c-d-1]=o[c];for(i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;c<m;c++)for(l=o[c],k=i[c-d-1],e=0;e<m;e++)l[e]-=2*k[e]}}return{H:n,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){void 0===b&&(b=1e4),a=numeric.clone(a);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=(numeric.clone(a),numeric.dim(a)),v=u[0],w=numeric.identity(v);if(v<3)return{Q:w,B:[[0,v-1]]};var x=numeric.epsilon;for(t=0;t<b;t++){for(r=0;r<v-1;r++)if(Math.abs(a[r+1][r])<x*(Math.abs(a[r][r])+Math.abs(a[r+1][r+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[r,r]),b),z=numeric.QRFrancis(numeric.getBlock(a,[r+1,r+1],[v-1,v-1]),b);for(n=Array(r+1),q=0;q<=r;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;q<=r;q++)w[q]=o[q];for(n=Array(v-r-1),q=r+1;q<v;q++)n[q-r-1]=w[q];for(o=numeric.dot(z.Q,n),q=r+1;q<v;q++)w[q]=o[q-r-1];return{Q:w,B:y.B.concat(numeric.add(z.B,r+1))}}if(e=a[v-2][v-2],f=a[v-2][v-1],g=a[v-1][v-2],h=a[v-1][v-1],j=e+h,i=e*h-f*g,k=numeric.getBlock(a,[0,0],[2,2]),j*j>=4*i){var A,B;A=.5*(j+Math.sqrt(j*j-4*i)),B=.5*(j-Math.sqrt(j*j-4*i)),k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,A+B)),numeric.diag(numeric.rep([3],A*B)))}else k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,j)),numeric.diag(numeric.rep([3],i)));for(c=[k[0][0],k[1][0],k[2][0]],d=numeric.house(c),n=[a[0],a[1],a[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;q<3;q++)for(m=a[q],p=o[q],s=0;s<v;s++)m[s]-=2*p[s];for(n=numeric.getBlock(a,[0,0],[v-1,2]),o=numeric.tensor(numeric.dot(n,d),d),q=0;q<v;q++)for(m=a[q],p=o[q],s=0;s<3;s++)m[s]-=2*p[s];for(n=[w[0],w[1],w[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;q<3;q++)for(l=w[q],p=o[q],s=0;s<v;s++)l[s]-=2*p[s];var C;for(r=0;r<v-2;r++){for(s=r;s<=r+1;s++)if(Math.abs(a[s+1][s])<x*(Math.abs(a[s][s])+Math.abs(a[s+1][s+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[s,s]),b),z=numeric.QRFrancis(numeric.getBlock(a,[s+1,s+1],[v-1,v-1]),b);for(n=Array(s+1),q=0;q<=s;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;q<=s;q++)w[q]=o[q];for(n=Array(v-s-1),q=s+1;q<v;q++)n[q-s-1]=w[q];for(o=numeric.dot(z.Q,n),q=s+1;q<v;q++)w[q]=o[q-s-1];return{Q:w,B:y.B.concat(numeric.add(z.B,s+1))}}for(C=Math.min(v-1,r+3),c=Array(C-r),q=r+1;q<=C;q++)c[q-r-1]=a[q][r];for(d=numeric.house(c),n=numeric.getBlock(a,[r+1,r],[C,v-1]),o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;q<=C;q++)for(m=a[q],p=o[q-r-1],s=r;s<v;s++)m[s]-=2*p[s-r];for(n=numeric.getBlock(a,[0,r+1],[v-1,C]),o=numeric.tensor(numeric.dot(n,d),d),q=0;q<v;q++)for(m=a[q],p=o[q],s=r+1;s<=C;s++)m[s]-=2*p[s-r-1];for(n=Array(C-r),q=r+1;q<=C;q++)n[q-r-1]=w[q];for(o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;q<=C;q++)for(l=w[q],p=o[q-r-1],s=0;s<v;s++)l[s]-=2*p[s]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=numeric.toUpperHessenberg(a),u=numeric.QRFrancis(t.H,b),v=numeric.T,w=a.length,x=u.B,y=numeric.dot(u.Q,numeric.dot(t.H,numeric.transpose(u.Q))),z=new v(numeric.dot(u.Q,t.Q)),A=x.length,B=Math.sqrt;for(d=0;d<A;d++)if((c=x[d][0])===x[d][1]);else{if(f=c+1,g=y[c][c],h=y[c][f],i=y[f][c],j=y[f][f],0===h&&0===i)continue;k=-g-j,l=g*j-h*i,m=k*k-4*l,m>=0?(n=k<0?-.5*(k-B(m)):-.5*(k+B(m)),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r),p=(g-n)/r,q=h/r):(s=B(s),p=i/s,q=(j-n)/s),e=new v([[q,-p],[p,q]]),z.setRows(c,f,e.dot(z.getRows(c,f)))):(n=-.5*k,o=.5*B(-m),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r+o*o),p=(g-n)/r,q=h/r,n=0,o/=r):(s=B(s+o*o),p=i/s,q=(j-n)/s,n=o/s,o=0),e=new v([[q,-p],[p,q]],[[n,o],[o,-n]]),z.setRows(c,f,e.dot(z.getRows(c,f))))}var C=z.dot(a).dot(z.transjugate()),w=a.length,D=numeric.T.identity(w);for(f=0;f<w;f++)if(f>0)for(d=f-1;d>=0;d--){var E=C.get([d,d]),F=C.get([f,f]);numeric.neq(E.x,F.x)||numeric.neq(E.y,F.y)?(n=C.getRow(d).getBlock([d],[f-1]),o=D.getRow(f).getBlock([d],[f-1]),D.set([f,d],C.get([d,f]).neg().sub(n.dot(o)).div(E.sub(F)))):D.setRow(f,D.getRow(d))}for(f=0;f<w;f++)n=D.getRow(f),D.setRow(f,n.div(n.norm2()));return D=D.transpose(),D=z.transjugate().dot(D),{lambda:C.getDiag(),E:D}},numeric.ccsSparse=function(a){var b,c,d,e,f=a.length,g=[];for(d=f-1;-1!==d;--d){c=a[d];for(e in c){for(e=parseInt(e);e>=g.length;)g[g.length]=0;0!==c[e]&&g[e]++}}var b=g.length,h=Array(b+1);for(h[0]=0,d=0;d<b;++d)h[d+1]=h[d]+g[d];var i=Array(h[b]),j=Array(h[b]);for(d=f-1;-1!==d;--d){c=a[d];for(e in c)0!==c[e]&&(g[e]--,i[h[e]+g[e]]=d,j[h[e]+g[e]]=c[e])}return[h,i,j]},numeric.ccsFull=function(a){var b,c,d,e,f=a[0],g=a[1],h=a[2],i=numeric.ccsDim(a),j=i[0],k=i[1],l=numeric.rep([j,k],0);for(b=0;b<k;b++)for(d=f[b],e=f[b+1],c=d;c<e;++c)l[g[c]][b]=h[c];return l},numeric.ccsTSolve=function(a,b,c,d,e){function f(a){var b;if(0===c[a]){for(c[a]=1,b=g[a];b<g[a+1];++b)f(h[b]);e[l]=a,++l}}var g=a[0],h=a[1],i=a[2],j=g.length-1,k=Math.max,l=0;void 0===d&&(c=numeric.rep([j],0)),void 0===d&&(d=numeric.linspace(0,c.length-1)),void 0===e&&(e=[]);var m,n,o,p,q,r,s;for(m=d.length-1;-1!==m;--m)f(d[m]);for(e.length=l,m=e.length-1;-1!==m;--m)c[e[m]]=0;for(m=d.length-1;-1!==m;--m)n=d[m],c[n]=b[n];for(m=e.length-1;-1!==m;--m){for(n=e[m],o=g[n],p=k(g[n+1],o),q=o;q!==p;++q)if(h[q]===n){c[n]/=i[q];break}for(s=c[n],q=o;q!==p;++q)(r=h[q])!==n&&(c[r]-=s*i[q])}return c},numeric.ccsDFS=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[a],m[0]=i=b[a+1];;)if(h>=i){if(e[k]=n[j],0===j)return;++k,--j,h=l[j],i=m[j]}else g=f[c[h]],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,h=b[g],m[j]=i=b[g+1]):++h},numeric.ccsLPSolve=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=a[0],r=a[1],s=a[2],t=(q.length,b[0]),u=b[1],v=b[2];for(i=t[e],j=t[e+1],d.length=0,h=i;h<j;++h)g.dfs(f[u[h]],q,r,c,d,f);for(h=d.length-1;-1!==h;--h)c[d[h]]=0;for(h=i;h!==j;++h)k=f[u[h]],c[k]=v[h];for(h=d.length-1;-1!==h;--h){for(k=d[h],l=q[k],m=q[k+1],n=l;n<m;++n)if(f[r[n]]===k){c[k]/=s[n];break}for(p=c[k],n=l;n<m;++n)(o=f[r[n]])!==k&&(c[o]-=p*s[n])}return c},numeric.ccsLUP1=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS(j);for(void 0===b&&(b=1),c=0;c<j;++c){for(u(k,a,s,t,c,x,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)(e=t[d])<=c||(h=v(s[e]))>f&&(g=e,f=h);for(v(s[c])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g,f=s[c],s[c]=s[g],s[g]=f),f=m[c],g=p[c],i=s[c],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[e],t[d]=0,s[e]=0,e<=c?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsDFS0=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS0.prototype.dfs=function(a,b,c,d,e,f,g){var h,i,j,k=0,l=e.length,m=this.k,n=this.k1,o=this.j;if(0===d[a])for(d[a]=1,o[0]=a,m[0]=i=b[f[a]],n[0]=j=b[f[a]+1];;){if(isNaN(i))throw new Error("Ow!");if(i>=j){if(e[l]=f[o[k]],0===k)return;++l,--k,i=m[k],j=n[k]}else h=c[i],0===d[h]?(d[h]=1,m[k]=i,++k,o[k]=h,h=f[h],i=b[h],n[k]=j=b[h+1]):++i}},numeric.ccsLPSolve0=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=a[0],s=a[1],t=a[2],u=(r.length,b[0]),v=b[1],w=b[2];for(j=u[e],k=u[e+1],d.length=0,i=j;i<k;++i)h.dfs(v[i],r,s,c,d,f,g);for(i=d.length-1;-1!==i;--i)l=d[i],c[g[l]]=0;for(i=j;i!==k;++i)l=v[i],c[l]=w[i];for(i=d.length-1;-1!==i;--i){for(l=d[i],p=g[l],m=r[l],n=r[l+1],o=m;o<n;++o)if(s[o]===p){c[p]/=t[o];break}for(q=c[p],o=m;o<n;++o)c[s[o]]-=q*t[o];c[p]=q}},numeric.ccsLUP0=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve0,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS0(j);for(void 0===b&&(b=1),c=0;c<j;++c){for(u(k,a,s,t,c,x,w,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)(e=t[d])<=c||(h=v(s[w[e]]))>f&&(g=e,f=h);for(v(s[w[c]])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g),f=m[c],g=p[c],i=s[w[c]],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[w[e]],t[d]=0,s[w[e]]=0,e<=c?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]},numeric.ccsGetBlock=function(a,b,c){var d=numeric.ccsDim(a),e=d[0],f=d[1];void 0===b?b=numeric.linspace(0,e-1):"number"==typeof b&&(b=[b]),void 0===c?c=numeric.linspace(0,f-1):"number"==typeof c&&(c=[c]);var g,h,i,j,k,l=b.length,m=c.length,n=numeric.rep([f],0),o=[],p=[],q=[n,o,p],r=a[0],s=a[1],t=a[2],u=numeric.rep([e],0),v=0,w=numeric.rep([e],0);for(h=0;h<m;++h){j=c[h];var x=r[j],y=r[j+1];for(g=x;g<y;++g)i=s[g],w[i]=1,u[i]=t[g];for(g=0;g<l;++g)k=b[g],w[k]&&(o[v]=g,p[v]=u[b[g]],++v);for(g=x;g<y;++g)i=s[g],w[i]=0;n[h+1]=v}return q},numeric.ccsDot=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a[0],o=a[1],p=a[2],q=b[0],r=b[1],s=b[2],t=numeric.ccsDim(a),u=numeric.ccsDim(b),v=t[0],w=(t[1],u[1]),x=numeric.rep([v],0),y=numeric.rep([v],0),z=Array(v),A=numeric.rep([w],0),B=[],C=[],D=[A,B,C];for(e=0;e!==w;++e){for(f=q[e],g=q[e+1],k=0,d=f;d<g;++d)for(l=r[d],m=s[d],h=n[l],i=n[l+1],c=h;c<i;++c)j=o[c],0===y[j]&&(z[k]=j,y[j]=1,k+=1),x[j]=x[j]+p[c]*m;for(f=A[e],g=f+k,A[e+1]=g,d=k-1;-1!==d;--d)m=f+d,c=z[d],B[m]=c,C[m]=x[c],y[c]=0,x[c]=0;A[e+1]=A[e]+k}return D},numeric.ccsLUPSolve=function(a,b){var c=a.L,d=a.U,e=(a.P,b[0]),f=!1;"object"!=typeof e&&(b=[[0,b.length],numeric.linspace(0,b.length-1),b],e=b[0],f=!0);var g,h,i,j,k,l,m=b[1],n=b[2],o=c[0].length-1,p=e.length-1,q=numeric.rep([o],0),r=Array(o),s=numeric.rep([o],0),t=Array(o),u=numeric.rep([p+1],0),v=[],w=[],x=numeric.ccsTSolve,y=0;for(g=0;g<p;++g){for(k=0,i=e[g],j=e[g+1],h=i;h<j;++h)l=a.Pinv[m[h]],t[k]=l,s[l]=n[h],++k;for(t.length=k,x(c,s,q,t,r),h=t.length-1;-1!==h;--h)s[t[h]]=0;if(x(d,q,s,r,t),f)return s;for(h=r.length-1;-1!==h;--h)q[r[h]]=0;for(h=t.length-1;-1!==h;--h)l=t[h],v[y]=l,w[y]=s[l],s[l]=0,++y;u[g+1]=y}return[u,v,w]},numeric.ccsbinop=function(a,b){return void 0===b&&(b=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+b+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+a+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(a){var b,c=a[0],d=a[1],e=a[2],f=numeric.sup(d)+1,g=c.length,h=numeric.rep([f],0),i=Array(g),j=Array(g),k=numeric.rep([f],0);for(b=0;b<g;++b)k[d[b]]++;for(b=0;b<f;++b)h[b+1]=h[b]+k[b];var l,m,n=h.slice(0);for(b=0;b<g;++b)m=d[b],l=n[m],i[l]=c[b],j[l]=e[b],n[m]=n[m]+1;return[h,i,j]},numeric.ccsGather=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2],j=g.length-1,k=h.length,l=Array(k),m=Array(k),n=Array(k);for(f=0,b=0;b<j;++b)for(d=g[b],e=g[b+1],c=d;c!==e;++c)m[f]=b,l[f]=h[c],n[f]=i[c],++f;return[l,m,n]},numeric.sdim=function a(b,c,d){if(void 0===c&&(c=[]),"object"!=typeof b)return c;void 0===d&&(d=0),d in c||(c[d]=0),b.length>c[d]&&(c[d]=b.length);var e;for(e in b)b.hasOwnProperty(e)&&a(b[e],c,d+1);return c},numeric.sclone=function a(b,c,d){void 0===c&&(c=0),void 0===d&&(d=numeric.sdim(b).length);var e,f=Array(b.length);if(c===d-1){for(e in b)b.hasOwnProperty(e)&&(f[e]=b[e]);return f}for(e in b)b.hasOwnProperty(e)&&(f[e]=a(b[e],c+1,d));return f},numeric.sdiag=function(a){var b,c,d=a.length,e=Array(d);for(b=d-1;b>=1;b-=2)c=b-1,e[b]=[],e[b][b]=a[b],e[c]=[],e[c][c]=a[c];return 0===b&&(e[0]=[],e[0][0]=a[b]),e},numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))},numeric.stranspose=function(a){var b,c,d,e=[];a.length;for(b in a)if(a.hasOwnProperty(b)){d=a[b];for(c in d)d.hasOwnProperty(c)&&("object"!=typeof e[c]&&(e[c]=[]),e[c][b]=d[c])}return e},numeric.sLUP=function(a,b){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(a,b){var c,d,e,f,g,h,i,j=a.length,k=(b.length,numeric.stranspose(b)),l=k.length,m=Array(j);for(e=j-1;e>=0;e--){for(i=[],c=a[e],g=l-1;g>=0;g--){h=0,d=k[g];for(f in c)c.hasOwnProperty(f)&&f in d&&(h+=c[f]*d[f]);h&&(i[g]=h)}m[e]=i}return m},numeric.sdotMV=function(a,b){var c,d,e,f,g=a.length,h=Array(g);for(d=g-1;d>=0;d--){c=a[d],f=0;for(e in c)c.hasOwnProperty(e)&&b[e]&&(f+=c[e]*b[e]);f&&(h[d]=f)}return h},numeric.sdotVM=function(a,b){var c,d,e,f,g=[];for(c in a)if(a.hasOwnProperty(c)){e=b[c],f=a[c];for(d in e)e.hasOwnProperty(d)&&(g[d]||(g[d]=0),g[d]+=f*e[d])}return g},numeric.sdotVV=function(a,b){var c,d=0;for(c in a)a[c]&&b[c]&&(d+=a[c]*b[c]);return d},numeric.sdot=function(a,b){var c=numeric.sdim(a).length,d=numeric.sdim(b).length;switch(1e3*c+d){case 0:return a*b;case 1001:return numeric.sdotVV(a,b);case 2001:return numeric.sdotMV(a,b);case 1002:return numeric.sdotVM(a,b);case 2002:return numeric.sdotMM(a,b);default:throw new Error("numeric.sdot not implemented for tensors of order "+c+" and "+d)}},numeric.sscatter=function(a){var b,c,d,e,f=a[0].length,g=a.length,h=[];for(c=f-1;c>=0;--c)if(a[g-1][c]){for(e=h,d=0;d<g-2;d++)b=a[d][c],e[b]||(e[b]=[]),e=e[b];e[a[d][c]]=a[d+1][c]}return h},numeric.sgather=function a(b,c,d){void 0===c&&(c=[]),void 0===d&&(d=[]);var e,f,g;e=d.length;for(f in b)if(b.hasOwnProperty(f))if(d[e]=parseInt(f),"number"==typeof(g=b[f])){if(g){if(0===c.length)for(f=e+1;f>=0;--f)c[f]=[];for(f=e;f>=0;--f)c[f].push(d[f]);c[e+1].push(g)}}else a(g,c,d);return d.length>e&&d.pop(),c},numeric.cLU=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2],k=h.length,l=0;for(b=0;b<k;b++)h[b]>l&&(l=h[b]);l++;var m,n,o,p=Array(l),q=Array(l),r=numeric.rep([l],1/0),s=numeric.rep([l],-1/0);for(d=0;d<k;d++)b=h[d],c=i[d],c<r[b]&&(r[b]=c),c>s[b]&&(s[b]=c);for(b=0;b<l-1;b++)s[b]>s[b+1]&&(s[b+1]=s[b]);for(b=l-1;b>=1;b--)r[b]<r[b-1]&&(r[b-1]=r[b]);var t=0,u=0;for(b=0;b<l;b++)q[b]=numeric.rep([s[b]-r[b]+1],0),p[b]=numeric.rep([b-r[b]],0),t+=b-r[b]+1,u+=s[b]-b+1;for(d=0;d<k;d++)b=h[d],q[b][i[d]-r[b]]=j[d];for(b=0;b<l-1;b++)for(e=b-r[b],m=q[b],c=b+1;r[c]<=b&&c<l;c++)if(f=b-r[c],g=s[b]-b,n=q[c],o=n[f]/m[e]){for(d=1;d<=g;d++)n[d+f]-=o*m[d+e];p[c][b-r[c]]=o}var k,v,w,m=[],n=[],x=[],y=[],z=[],A=[];for(k=0,v=0,b=0;b<l;b++){for(e=r[b],f=s[b],w=q[b],c=b;c<=f;c++)w[c-e]&&(m[k]=b,n[k]=c,x[k]=w[c-e],k++);for(w=p[b],c=e;c<b;c++)w[c-e]&&(y[v]=b,z[v]=c,A[v]=w[c-e],v++);y[v]=b,z[v]=b,A[v]=1,v++}return{U:[m,n,x],L:[y,z,A]}},numeric.cLUsolve=function(a,b){var c,d,e=a.L,f=a.U,g=numeric.clone(b),h=e[0],i=e[1],j=e[2],k=f[0],l=f[1],m=f[2],n=k.length,o=(h.length,g.length);for(d=0,c=0;c<o;c++){for(;i[d]<c;)g[c]-=j[d]*g[i[d]],d++;d++}for(d=n-1,c=o-1;c>=0;c--){for(;l[d]>c;)g[c]-=m[d]*g[l[d]],d--;g[c]/=m[d],d--}return g},numeric.cgrid=function(a,b){"number"==typeof a&&(a=[a,a]);var c,d,e,f=numeric.rep(a,-1);if("function"!=typeof b)switch(b){case"L":b=function(b,c){return b>=a[0]/2||c<a[1]/2};break;default:b=function(a,b){return!0}}for(e=0,c=1;c<a[0]-1;c++)for(d=1;d<a[1]-1;d++)b(c,d)&&(f[c][d]=e,e++);return f},numeric.cdelsq=function(a){var b,c,d,e,f,g=[[-1,0],[0,-1],[0,1],[1,0]],h=numeric.dim(a),i=h[0],j=h[1],k=[],l=[],m=[];for(b=1;b<i-1;b++)for(c=1;c<j-1;c++)if(!(a[b][c]<0)){for(d=0;d<4;d++)e=b+g[d][0],f=c+g[d][1],a[e][f]<0||(k.push(a[b][c]),l.push(a[e][f]),m.push(-1));k.push(a[b][c]),l.push(a[b][c]),m.push(4)}return[k,l,m]},numeric.cdotMV=function(a,b){var c,d,e,f=a[0],g=a[1],h=a[2],i=f.length;for(e=0,d=0;d<i;d++)f[d]>e&&(e=f[d]);for(e++,c=numeric.rep([e],0),d=0;d<i;d++)c[f[d]]+=h[d]*b[g[d]];return c},numeric.Spline=function(a,b,c,d,e){this.x=a,this.yl=b,this.yr=c,this.kl=d,this.kr=e},numeric.Spline.prototype._at=function(a,b){var a,c,d,e,f=this.x,g=this.yl,h=this.yr,i=this.kl,j=this.kr,k=numeric.add,l=numeric.sub,m=numeric.mul;c=l(m(i[b],f[b+1]-f[b]),l(h[b+1],g[b])),d=k(m(j[b+1],f[b]-f[b+1]),l(h[b+1],g[b])),e=(a-f[b])/(f[b+1]-f[b]);var n=e*(1-e);return k(k(k(m(1-e,g[b]),m(e,h[b+1])),m(c,n*(1-e))),m(d,n*e))},numeric.Spline.prototype.at=function(a){if("number"==typeof a){var b,c,d,e=this.x,f=e.length,g=Math.floor;for(b=0,c=f-1;c-b>1;)d=g((b+c)/2),e[d]<=a?b=d:c=d;return this._at(a,b)}var h,f=a.length,i=Array(f);for(h=f-1;-1!==h;--h)i[h]=this.at(a[h]);return i},numeric.Spline.prototype.diff=function(){var a,b,c,d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,i=e.length,j=g,k=h,l=Array(i),m=Array(i),n=numeric.add,o=numeric.mul,p=numeric.div,q=numeric.sub;for(a=i-1;-1!==a;--a)b=d[a+1]-d[a],c=q(f[a+1],e[a]),l[a]=p(n(o(c,6),o(g[a],-4*b),o(h[a+1],-2*b)),b*b),m[a+1]=p(n(o(c,-6),o(g[a],2*b),o(h[a+1],4*b)),b*b);return new numeric.Spline(d,j,k,l,m)},numeric.Spline.prototype.roots=function(){function a(a){return a*a}var b=[],c=this.x,d=this.yl,e=this.yr,f=this.kl,g=this.kr;"number"==typeof d[0]&&(d=[d],e=[e],f=[f],g=[g]);var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=d.length,F=c.length-1,b=Array(E),G=Math.sqrt;for(h=0;h!==E;++h){for(k=d[h],l=e[h],m=f[h],n=g[h],o=[],i=0;i!==F;i++){for(i>0&&l[i]*k[i]<0&&o.push(c[i]),w=c[i+1]-c[i],c[i],r=k[i],s=l[i+1],p=m[i]/w,q=n[i+1]/w,v=a(p-q+3*(r-s))+12*q*r,t=q+3*r+2*p-3*s,u=3*(q+p+2*(r-s)),v<=0?(y=t/u,x=y>c[i]&&y<c[i+1]?[c[i],y,c[i+1]]:[c[i],c[i+1]]):(y=(t-G(v))/u,z=(t+G(v))/u,x=[c[i]],y>c[i]&&y<c[i+1]&&x.push(y),z>c[i]&&z<c[i+1]&&x.push(z),x.push(c[i+1])),B=x[0],y=this._at(B,i),j=0;j<x.length-1;j++)if(C=x[j+1],z=this._at(C,i),0!==y)if(0===z||y*z>0)B=C,y=z;else{for(var H=0;;){if((D=(y*C-z*B)/(y-z))<=B||D>=C)break;if((A=this._at(D,i))*z>0)C=D,z=A,-1===H&&(y*=.5),H=-1;else{if(!(A*y>0))break;B=D,y=A,1===H&&(z*=.5),H=1}}o.push(D),B=x[j+1],y=this._at(B,i)}else o.push(B),B=C,y=z;0===z&&o.push(C)}b[h]=o}return"number"==typeof this.yl[0]?b[0]:b},numeric.spline=function(a,b,c,d){var e,f=a.length,g=[],h=[],i=[],j=numeric.sub,k=numeric.mul,l=numeric.add;for(e=f-2;e>=0;e--)h[e]=a[e+1]-a[e],i[e]=j(b[e+1],b[e]);"string"!=typeof c&&"string"!=typeof d||(c=d="periodic");var m=[[],[],[]];switch(typeof c){case"undefined":g[0]=k(3/(h[0]*h[0]),i[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/h[0],1/h[0]);break;case"string":g[0]=l(k(3/(h[f-2]*h[f-2]),i[f-2]),k(3/(h[0]*h[0]),i[0])),m[0].push(0,0,0),m[1].push(f-2,0,1),m[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=c,m[0].push(0),m[1].push(0),m[2].push(1)}for(e=1;e<f-1;e++)g[e]=l(k(3/(h[e-1]*h[e-1]),i[e-1]),k(3/(h[e]*h[e]),i[e])),m[0].push(e,e,e),m[1].push(e-1,e,e+1),m[2].push(1/h[e-1],2/h[e-1]+2/h[e],1/h[e]);switch(typeof d){case"undefined":g[f-1]=k(3/(h[f-2]*h[f-2]),i[f-2]),m[0].push(f-1,f-1),m[1].push(f-2,f-1),m[2].push(1/h[f-2],2/h[f-2]);break;case"string":m[1][m[1].length-1]=0;break;default:g[f-1]=d,m[0].push(f-1),m[1].push(f-1),m[2].push(1)}g="number"!=typeof g[0]?numeric.transpose(g):[g];var n=Array(g.length);if("string"==typeof c)for(e=n.length-1;-1!==e;--e)n[e]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),g[e]),n[e][f-1]=n[e][0];else for(e=n.length-1;-1!==e;--e)n[e]=numeric.cLUsolve(numeric.cLU(m),g[e]);return n="number"==typeof b[0]?n[0]:numeric.transpose(n),new numeric.Spline(a,b,b,n,n)},numeric.fftpow2=function a(b,c){var d=b.length;if(1!==d){var e,f,g=Math.cos,h=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(f=d/2,e=d-1;-1!==e;--e)--f,k[f]=b[e],l[f]=c[e],--e,i[f]=b[e],j[f]=c[e];a(i,j),a(k,l),f=d/2;var m,n,o,p=-6.283185307179586/d;for(e=d-1;-1!==e;--e)--f,-1===f&&(f=d/2-1),m=p*e,n=g(m),o=h(m),b[e]=i[f]+n*k[f]-o*l[f],c[e]=j[f]+n*l[f]+o*k[f]}},numeric._ifftpow2=function a(b,c){var d=b.length;if(1!==d){var e,f,g=Math.cos,h=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(f=d/2,e=d-1;-1!==e;--e)--f,k[f]=b[e],l[f]=c[e],--e,i[f]=b[e],j[f]=c[e];a(i,j),a(k,l),f=d/2;var m,n,o,p=6.283185307179586/d;for(e=d-1;-1!==e;--e)--f,-1===f&&(f=d/2-1),m=p*e,n=g(m),o=h(m),b[e]=i[f]+n*k[f]-o*l[f],c[e]=j[f]+n*l[f]+o*k[f]}},numeric.ifftpow2=function(a,b){numeric._ifftpow2(a,b),numeric.diveq(a,a.length),numeric.diveq(b,b.length)},numeric.convpow2=function(a,b,c,d){numeric.fftpow2(a,b),numeric.fftpow2(c,d);var e,f,g,h,i,j=a.length;for(e=j-1;-1!==e;--e)f=a[e],h=b[e],g=c[e],i=d[e],a[e]=f*g-h*i,b[e]=f*i+h*g;numeric.ifftpow2(a,b)},numeric.T.prototype.fft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=-3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2);for(a=0;a<e;a++)o[a]=c[a];if(void 0!==d)for(a=0;a<e;a++)p[a]=d[a];for(j[0]=1,a=1;a<=i/2;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q},numeric.T.prototype.ifft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2);for(a=0;a<e;a++)o[a]=c[a];if(void 0!==d)for(a=0;a<e;a++)p[a]=d[a];for(j[0]=1,a=1;a<=i/2;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q.div(e)},numeric.gradient=function(a,b){var c=b.length,d=a(b);if(isNaN(d))throw new Error("gradient: f(x) is a NaN!");var e,f,g,h,i,j,k,l,m,n=Math.max,o=numeric.clone(b),p=Array(c),n=(numeric.div,numeric.sub,Math.max),q=.001,r=Math.abs,s=Math.min,t=0;for(e=0;e<c;e++)for(var u=n(1e-6*d,1e-8);;){if(++t>20)throw new Error("Numerical gradient fails");if(o[e]=b[e]+u,f=a(o),o[e]=b[e]-u,g=a(o),o[e]=b[e],isNaN(f)||isNaN(g))u/=16;else{if(p[e]=(f-g)/(2*u),h=b[e]-u,i=b[e],j=b[e]+u,k=(f-d)/u,l=(d-g)/u,m=n(r(p[e]),r(d),r(f),r(g),r(h),r(i),r(j),1e-8),!(s(n(r(k-p[e]),r(l-p[e]),r(k-l))/m,u/m)>q))break;u/=16}}return p},numeric.uncmin=function(a,b,c,d,e,f,g){var h=numeric.gradient;void 0===g&&(g={}),void 0===c&&(c=1e-8),void 0===d&&(d=function(b){return h(a,b)}),void 0===e&&(e=1e3),b=numeric.clone(b);var i,j,k=b.length,l=a(b);if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,n=numeric.norm2
;c=m(c,numeric.epsilon);var o,p,q,r,s,t,u,v,w,x,y=g.Hinv||numeric.identity(k),z=numeric.dot,A=(numeric.inv,numeric.sub),B=numeric.add,C=numeric.tensor,D=numeric.div,E=numeric.mul,F=numeric.all,G=numeric.isFinite,H=numeric.neg,I=0,J="";for(p=d(b);I<e;){if("function"==typeof f&&f(I,b,l,p,y)){J="Callback returned true";break}if(!F(G(p))){J="Gradient has Infinity or NaN";break}if(o=H(z(y,p)),!F(G(o))){J="Search direction has Infinity or NaN";break}if((x=n(o))<c){J="Newton step smaller than tol";break}for(w=1,j=z(p,o),s=b;I<e&&!(w*x<c)&&(r=E(o,w),s=B(b,r),(i=a(s))-l>=.1*w*j||isNaN(i));)w*=.5,++I;if(w*x<c){J="Line search step size smaller than tol";break}if(I===e){J="maxit reached during line search";break}q=d(s),t=A(q,p),v=z(t,r),u=z(y,t),y=A(B(y,E((v+z(t,u))/(v*v),C(r,r))),D(B(C(u,r),C(r,u)),v)),b=s,l=i,p=q,++I}return{solution:b,f:l,gradient:p,invHessian:y,iterations:I,message:J}},numeric.Dopri=function(a,b,c,d,e,f,g){this.x=a,this.y=b,this.f=c,this.ymid=d,this.iterations=e,this.events=g,this.message=f},numeric.Dopri.prototype._at=function(a,b){function c(a){return a*a}var d,e,f,g,h,i,a,j,k,l,m,n=this,o=n.x,p=n.y,q=n.f,r=n.ymid,s=(o.length,Math.floor,.5),t=numeric.add,u=numeric.mul,v=numeric.sub;return d=o[b],e=o[b+1],g=p[b],h=p[b+1],j=e-d,f=d+s*j,i=r[b],k=v(q[b],u(g,1/(d-f)+2/(d-e))),l=v(q[b+1],u(h,1/(e-f)+2/(e-d))),m=[c(a-e)*(a-f)/c(d-e)/(d-f),c(a-d)*c(a-e)/c(d-f)/c(e-f),c(a-d)*(a-f)/c(e-d)/(e-f),(a-d)*c(a-e)*(a-f)/c(d-e)/(d-f),(a-e)*c(a-d)*(a-f)/c(d-e)/(e-f)],t(t(t(t(u(g,m[0]),u(i,m[1])),u(h,m[2])),u(k,m[3])),u(l,m[4]))},numeric.Dopri.prototype.at=function(a){var b,c,d,e=Math.floor;if("number"!=typeof a){var f=a.length,g=Array(f);for(b=f-1;-1!==b;--b)g[b]=this.at(a[b]);return g}var h=this.x;for(b=0,c=h.length-1;c-b>1;)d=e(.5*(b+c)),h[d]<=a?b=d:c=d;return this._at(a,b)},numeric.dopri=function(a,b,c,d,e,f,g){void 0===e&&(e=1e-6),void 0===f&&(f=1e3);var h,i,j,k,l,m,n,o,p,q,r,s,t,u=[a],v=[c],w=[d(a,c)],x=[],y=.2,z=[.075,.225],A=[44/45,-56/15,32/9],B=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],D=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],F=[.2,.3,.8,8/9,1,1],G=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],H=0,I=(b-a)/10,J=0,K=numeric.add,L=numeric.mul,M=(Math.max,Math.min),N=Math.abs,O=numeric.norminf,P=Math.pow,Q=numeric.any,R=numeric.lt,S=numeric.and,T=(numeric.sub,new numeric.Dopri(u,v,w,x,-1,""));for("function"==typeof g&&(r=g(a,c));a<b&&J<f;)if(++J,a+I>b&&(I=b-a),h=d(a+F[0]*I,K(c,L(y*I,w[H]))),i=d(a+F[1]*I,K(K(c,L(z[0]*I,w[H])),L(z[1]*I,h))),j=d(a+F[2]*I,K(K(K(c,L(A[0]*I,w[H])),L(A[1]*I,h)),L(A[2]*I,i))),k=d(a+F[3]*I,K(K(K(K(c,L(B[0]*I,w[H])),L(B[1]*I,h)),L(B[2]*I,i)),L(B[3]*I,j))),l=d(a+F[4]*I,K(K(K(K(K(c,L(C[0]*I,w[H])),L(C[1]*I,h)),L(C[2]*I,i)),L(C[3]*I,j)),L(C[4]*I,k))),p=K(K(K(K(K(c,L(w[H],I*D[0])),L(i,I*D[2])),L(j,I*D[3])),L(k,I*D[4])),L(l,I*D[5])),m=d(a+I,p),n=K(K(K(K(K(L(w[H],I*G[0]),L(i,I*G[2])),L(j,I*G[3])),L(k,I*G[4])),L(l,I*G[5])),L(m,I*G[6])),(q="number"==typeof n?N(n):O(n))>e){if(I=.2*I*P(e/q,.25),a+I===a){T.msg="Step size became too small";break}}else{if(x[H]=K(K(K(K(K(K(c,L(w[H],I*E[0])),L(i,I*E[2])),L(j,I*E[3])),L(k,I*E[4])),L(l,I*E[5])),L(m,I*E[6])),++H,u[H]=a+I,v[H]=p,w[H]=m,"function"==typeof g){var U,V,W=a,X=a+.5*I;if(s=g(X,x[H-1]),t=S(R(r,0),R(0,s)),Q(t)||(W=X,X=a+I,r=s,s=g(X,p),t=S(R(r,0),R(0,s))),Q(t)){for(var Y,Z,$=0,_=1,aa=1;;){if("number"==typeof r)V=(aa*s*W-_*r*X)/(aa*s-_*r);else for(V=X,o=r.length-1;-1!==o;--o)r[o]<0&&s[o]>0&&(V=M(V,(aa*s[o]*W-_*r[o]*X)/(aa*s[o]-_*r[o])));if(V<=W||V>=X)break;U=T._at(V,H-1),Z=g(V,U),Y=S(R(r,0),R(0,Z)),Q(Y)?(X=V,s=Z,t=Y,aa=1,-1===$?_*=.5:_=1,$=-1):(W=V,r=Z,_=1,1===$?aa*=.5:aa=1,$=1)}return p=T._at(.5*(a+V),H-1),T.f[H]=d(V,U),T.x[H]=V,T.y[H]=U,T.ymid[H-1]=p,T.events=t,T.iterations=J,T}}a+=I,c=p,r=s,I=M(.8*I*P(e/q,.25),4*I)}return T.iterations=J,T},numeric.LU=function(a,b){b=b||!1;var c,d,e,f,g,h,i,j,k,l=Math.abs,m=a.length,n=m-1,o=new Array(m);for(b||(a=numeric.clone(a)),e=0;e<m;++e){for(i=e,h=a[e],k=l(h[e]),d=e+1;d<m;++d)f=l(a[d][e]),k<f&&(k=f,i=d);for(o[e]=i,i!=e&&(a[e]=a[i],a[i]=h,h=a[e]),g=h[e],c=e+1;c<m;++c)a[c][e]/=g;for(c=e+1;c<m;++c){for(j=a[c],d=e+1;d<n;++d)j[d]-=j[e]*h[d],++d,j[d]-=j[e]*h[d];d===n&&(j[d]-=j[e]*h[d])}}return{LU:a,P:o}},numeric.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=numeric.clone(b),k=a.P;for(c=i-1;-1!==c;--c)j[c]=b[c];for(c=0;c<i;++c)for(e=k[c],k[c]!==c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;d<c;++d)j[c]-=j[d]*f[d];for(c=i-1;c>=0;--c){for(f=h[c],d=c+1;d<i;++d)j[c]-=j[d]*f[d];j[c]/=f[c]}return j},numeric.solve=function(a,b,c){return numeric.LUsolve(numeric.LU(a,c),b)},numeric.echelonize=function(a){var b,c,d,e,f,g,h,i,j=numeric.dim(a),k=j[0],l=j[1],m=numeric.identity(k),n=Array(k),o=Math.abs,p=numeric.diveq;for(a=numeric.clone(a),b=0;b<k;++b){for(d=0,f=a[b],g=m[b],c=1;c<l;++c)o(f[d])<o(f[c])&&(d=c);for(n[b]=d,p(g,f[d]),p(f,f[d]),c=0;c<k;++c)if(c!==b){for(h=a[c],i=h[d],e=l-1;-1!==e;--e)h[e]-=f[e]*i;for(h=m[c],e=k-1;-1!==e;--e)h[e]-=g[e]*i}}return{I:m,A:a,P:n}},numeric.__solveLP=function(a,b,c,d,e,f,g){var h,i,j,k,l=numeric.sum,m=(numeric.log,numeric.mul),n=numeric.sub,o=numeric.dot,p=numeric.div,q=numeric.add,r=a.length,s=c.length,t=!1,u=0,v=1,w=(numeric.transpose(b),numeric.svd,numeric.transpose),x=(numeric.leq,Math.sqrt),y=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,B=numeric.gt,C=Array(r),D=Array(s),E=(numeric.rep([s],1),numeric.solve),F=n(c,o(b,f)),G=o(a,a);for(j=u;j<e;++j){var H,I;for(H=s-1;-1!==H;--H)D[H]=p(b[H],F[H]);var J=w(D);for(H=r-1;-1!==H;--H)C[H]=l(J[H]);v=.25*y(G/o(a,C));var K=100*x(G/o(C,C));for((!isFinite(v)||v>K)&&(v=K),k=q(a,m(v,C)),i=o(J,D),H=r-1;-1!==H;--H)i[H][H]+=1;I=E(i,p(k,v),!0);var L=p(F,o(b,I)),M=1;for(H=s-1;-1!==H;--H)L[H]<0&&(M=z(M,-.999*L[H]));if(h=n(f,m(I,M)),F=n(c,o(b,h)),!A(B(F,0)))return{solution:f,message:"",iterations:j};if(f=h,v<d)return{solution:h,message:"",iterations:j};if(g){var N=o(a,k),O=o(b,k);for(t=!0,H=s-1;-1!==H;--H)if(N*O[H]<0){t=!1;break}}else t=!(f[r-1]>=0);if(t)return{solution:h,message:"Unbounded",iterations:j}}return{solution:f,message:"maximum iteration count exceeded",iterations:j}},numeric._solveLP=function(a,b,c,d,e){var f,g=a.length,h=c.length,i=(numeric.sum,numeric.log,numeric.mul,numeric.sub),j=numeric.dot,k=(numeric.div,numeric.add,numeric.rep([g],0).concat([1])),l=numeric.rep([h,1],-1),m=numeric.blockMatrix([[b,l]]),n=c,f=numeric.rep([g],0).concat(Math.max(0,numeric.sup(numeric.neg(c)))+1),o=numeric.__solveLP(k,m,n,d,e,f,!1),p=numeric.clone(o.solution);if(p.length=g,numeric.inf(i(c,j(b,p)))<0)return{solution:NaN,message:"Infeasible",iterations:o.iterations};var q=numeric.__solveLP(a,b,c,d,e-o.iterations,p,!0);return q.iterations+=o.iterations,q},numeric.solveLP=function(a,b,c,d,e,f,g){if(void 0===g&&(g=1e3),void 0===f&&(f=numeric.epsilon),void 0===d)return numeric._solveLP(a,b,c,f,g);var h,i=d.length,j=d[0].length,k=b.length,l=numeric.echelonize(d),m=numeric.rep([j],0),n=l.P,o=[];for(h=n.length-1;-1!==h;--h)m[n[h]]=1;for(h=j-1;-1!==h;--h)0===m[h]&&o.push(h);var p=numeric.getRange,q=numeric.linspace(0,i-1),r=numeric.linspace(0,k-1),s=p(d,q,o),t=p(b,r,n),u=p(b,r,o),v=numeric.dot,w=numeric.sub,x=v(t,l.I),y=w(u,v(x,s)),z=w(c,v(x,e)),A=Array(n.length),B=Array(o.length);for(h=n.length-1;-1!==h;--h)A[h]=a[n[h]];for(h=o.length-1;-1!==h;--h)B[h]=a[o[h]];var C=w(B,v(A,v(l.I,s))),D=numeric._solveLP(C,y,z,f,g),E=D.solution;if(E!==E)return D;var F=v(l.I,w(e,v(s,E))),G=Array(a.length);for(h=n.length-1;-1!==h;--h)G[n[h]]=F[h];for(h=o.length-1;-1!==h;--h)G[o[h]]=E[h];return{solution:G,message:D.message,iterations:D.iterations}},numeric.MPStoLP=function(a){function b(b){throw new Error("MPStoLP: "+b+"\nLine "+c+": "+a[c]+"\nCurrent state: "+h[g]+"\n")}a instanceof String&&a.split("\n");var c,d,e,f,g=0,h=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=a.length,j=0,k={},l=[],m=0,n={},o=0,p=[],q=[],r=[];for(c=0;c<i;++c){e=a[c];var s=e.match(/\S*/g),t=[];for(d=0;d<s.length;++d)""!==s[d]&&t.push(s[d]);if(0!==t.length){for(d=0;d<h.length&&e.substr(0,h[d].length)!==h[d];++d);if(d<h.length){if(g=d,1===d&&(f=t[1]),6===d)return{name:f,c:p,A:numeric.transpose(q),b:r,rows:k,vars:n}}else switch(g){case 0:case 1:b("Unexpected line");case 2:switch(t[0]){case"N":0===j?j=t[1]:b("Two or more N rows");break;case"L":k[t[1]]=m,l[m]=1,r[m]=0,++m;break;case"G":k[t[1]]=m,l[m]=-1,r[m]=0,++m;break;case"E":k[t[1]]=m,l[m]=0,r[m]=0,++m;break;default:b("Parse error "+numeric.prettyPrint(t))}break;case 3:n.hasOwnProperty(t[0])||(n[t[0]]=o,p[o]=0,q[o]=numeric.rep([m],0),++o);var u=n[t[0]];for(d=1;d<t.length;d+=2)if(t[d]!==j){var v=k[t[d]];q[u][v]=(l[v]<0?-1:1)*parseFloat(t[d+1])}else p[u]=parseFloat(t[d+1]);break;case 4:for(d=1;d<t.length;d+=2)r[k[t[d]]]=(l[k[t[d]]]<0?-1:1)*parseFloat(t[d+1]);break;case 5:break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);g<c;)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+("string"!=e?"\0":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;a<e;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if("object"!=typeof a)return a;var c,d=[],e=a.length;for(c=0;c<e;c++)d[c+1]=b(a[c]);return d}function c(a){if("object"!=typeof a)return a;var b,d=[],e=a.length;for(b=1;b<e;b++)d[b-1]=c(a[b]);return d}function d(a,b,c){var d,e,f,g,h;for(f=1;f<=c;f+=1){for(a[f][f]=1/a[f][f],h=-a[f][f],d=1;d<f;d+=1)a[d][f]=h*a[d][f];if(g=f+1,c<g)break;for(e=g;e<=c;e+=1)for(h=a[f][e],a[f][e]=0,d=1;d<=f;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}function e(a,b,c,d){var e,f,g,h;for(f=1;f<=c;f+=1){for(h=0,e=1;e<f;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;g<=c;g+=1)for(f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f],e=1;e<f;e+=1)d[e]=d[e]+h*a[e][f]}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;f<=c;f+=1){if(d[1]=f,j=0,(g=f-1)<1){if((j=a[f][f]-j)<=0)break;a[f][f]=Math.sqrt(j)}else{for(h=1;h<=g;h+=1){for(i=a[h][f],e=1;e<h;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}if((j=a[f][f]-j)<=0)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){for(q[1]=q[1]+1,A=H,y=1;y<=m;y+=1){for(A+=1,N=-k[y],z=1;z<=g;z+=1)N+=j[z][y]*h[z];if(Math.abs(N)<V&&(N=0),y>n)r[A]=N;else if(r[A]=-Math.abs(N),N>0){for(z=1;z<=g;z+=1)j[z][y]=-j[z][y];k[y]=-k[y]}}for(y=1;y<=p;y+=1)r[H+o[y]]=0;for(J=0,M=0,y=1;y<=m;y+=1)r[H+y]<M*r[L+y]&&(J=y,M=r[H+y]/r[L+y]);return 0===J?999:0}function u(){for(y=1;y<=g;y+=1){for(N=0,z=1;z<=g;z+=1)N+=a[z][y]*j[z][J];r[y]=N}for(B=E,y=1;y<=g;y+=1)r[B+y]=0;for(z=p+1;z<=g;z+=1)for(y=1;y<=g;y+=1)r[B+y]=r[B+y]+a[y][z]*r[z];for(T=!0,y=p;y>=1;y-=1){for(N=r[y],A=G+y*(y+3)/2,B=A-y,z=y+1;z<=p;z+=1)N-=r[A]*r[F+z],A+=z;if(N/=r[B],r[F+y]=N,o[y]<n)break;if(N<0)break;T=!1,D=y}if(!T)for(O=r[I+D]/r[F+D],y=1;y<=p&&!(o[y]<n)&&!(r[F+y]<0);y+=1)(M=r[I+y]/r[F+y])<O&&(O=M,D=y);for(N=0,y=E+1;y<=E+g;y+=1)N+=r[y]*r[y];if(Math.abs(N)<=V){if(T)return s[1]=1,999;for(y=1;y<=p;y+=1)r[I+y]=r[I+y]-O*r[F+y];return r[I+p+1]=r[I+p+1]+O,700}for(N=0,y=1;y<=g;y+=1)N+=r[E+y]*j[y][J];for(P=-r[H+J]/N,U=!0,T||O<P&&(P=O,U=!1),y=1;y<=g;y+=1)h[y]=h[y]+P*r[E+y],Math.abs(h[y])<V&&(h[y]=0);for(i[1]=i[1]+P*N*(P/2+r[I+p+1]),y=1;y<=p;y+=1)r[I+y]=r[I+y]-P*r[F+y];if(r[I+p+1]=r[I+p+1]+P,!U){for(N=-k[J],z=1;z<=g;z+=1)N+=h[z]*j[z][J];if(J>n)r[H+J]=N;else if(r[H+J]=-Math.abs(N),N>0){for(z=1;z<=g;z+=1)j[z][J]=-j[z][J];k[J]=-k[J]}return 700}for(p+=1,o[p]=J,A=G+(p-1)*p/2+1,y=1;y<=p-1;y+=1)r[A]=r[y],A+=1;if(p===g)r[A]=r[g];else{for(y=g;y>=p+1&&0!==r[y]&&(Q=Math.max(Math.abs(r[y-1]),Math.abs(r[y])),R=Math.min(Math.abs(r[y-1]),Math.abs(r[y])),M=r[y-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[y-1]/M,R=r[y]/M,1!==Q);y-=1)if(0===Q)for(r[y-1]=R*M,z=1;z<=g;z+=1)M=a[z][y-1],a[z][y-1]=a[z][y],a[z][y]=M;else for(r[y-1]=M,S=R/(1+Q),z=1;z<=g;z+=1)M=Q*a[z][y-1]+R*a[z][y],a[z][y]=S*(a[z][y-1]+M)-a[z][y],a[z][y-1]=M;r[A]=r[p]}return 0}function v(){if(A=G+D*(D+1)/2+1,B=A+D,0===r[B])return 798;if(Q=Math.max(Math.abs(r[B-1]),Math.abs(r[B])),R=Math.min(Math.abs(r[B-1]),Math.abs(r[B])),M=r[B-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[B-1]/M,R=r[B]/M,1===Q)return 798;if(0===Q){for(y=D+1;y<=p;y+=1)M=r[B-1],r[B-1]=r[B],r[B]=M,B+=y;for(y=1;y<=g;y+=1)M=a[y][D],a[y][D]=a[y][D+1],a[y][D+1]=M}else{for(S=R/(1+Q),y=D+1;y<=p;y+=1)M=Q*r[B-1]+R*r[B],r[B]=S*(r[B-1]+M)-r[B],r[B-1]=M,B+=y;for(y=1;y<=g;y+=1)M=Q*a[y][D]+R*a[y][D+1],a[y][D+1]=S*(a[y][D]+M)-a[y][D+1],a[y][D]=M}return 0}function w(){for(B=A-D,y=1;y<=D;y+=1)r[B]=r[A],A+=1,B+=1;return r[I+D]=r[I+D+1],o[D]=o[D+1],D+=1,D<p?797:0}function x(){return r[I+p]=r[I+p+1],r[I+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;K=Math.min(g,m),A=2*g+K*(K+5)/2+2*m+1,V=1e-60;do{V+=V,W=1+.1*V,X=1+.2*V}while(W<=1||X<=1);for(y=1;y<=g;y+=1)r[y]=b[y];for(y=g+1;y<=A;y+=1)r[y]=0;for(y=1;y<=m;y+=1)o[y]=0;if(C=[],0===s[1]){if(f(a,c,g,C),0!==C[1])return void(s[1]=2);e(a,c,g,b),d(a,c,g)}else{for(z=1;z<=g;z+=1)for(h[z]=0,y=1;y<=z;y+=1)h[z]=h[z]+a[y][z]*b[y];for(z=1;z<=g;z+=1)for(b[z]=0,y=z;y<=g;y+=1)b[z]=b[z]+a[z][y]*h[y]}for(i[1]=0,z=1;z<=g;z+=1)for(h[z]=b[z],i[1]=i[1]+r[z]*h[z],r[z]=0,y=z+1;y<=g;y+=1)a[y][z]=0;for(i[1]=-i[1]/2,s[1]=0,E=g,F=E+g,I=F+K,G=I+K+1,H=G+K*(K+1)/2,L=H+m,y=1;y<=m;y+=1){for(N=0,z=1;z<=g;z+=1)N+=j[z][y]*j[z][y];r[L+y]=Math.sqrt(N)}for(p=0,q[1]=0,q[2]=0,Y=0;;){if(999===(Y=t()))return;for(;;){if(0===(Y=u()))break;if(999===Y)return;if(700===Y)if(D===p)x();else{for(;;)if(v(),797!==(Y=w()))break;x()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o,p=[],q=[],r=[],s=[],t=[];if(h=h||0,i=i?b(i):[void 0,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1,!f)for(j=1;j<=l;j+=1)f[j]=0;for(j=1;j<=l;j+=1)q[j]=0;for(m=0,n=Math.min(k,l),j=1;j<=k;j+=1)r[j]=0;for(p[1]=0,j=1;j<=2*k+n*(n+5)/2+2*l+1;j+=1)s[j]=0;for(j=1;j<=2;j+=1)t[j]=0;return g(a,d,k,k,r,p,e,f,k,l,h,q,m,t,s,i),o="",1===i[1]&&(o="constraints are inconsistent, no solution!"),2===i[1]&&(o="matrix D in quadratic function is not positive definite!"),{solution:c(r),value:c(p),unconstrained_solution:c(d),iterations:c(t),iact:c(q),message:o}}a.solveQP=h}(numeric),numeric.svd=function(a){function b(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(a),m=l.length,n=l[0].length;if(m<n)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;h<n;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),r=0,s=0,t=0,u=0,v=0,w=0,x=0;for(h=0;h<n;h++){for(o[h]=s,x=0,k=h+1,i=h;i<m;i++)x+=l[i][h]*l[i][h];if(x<=e)s=0;else for(r=l[h][h],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h]=r-s,i=k;i<n;i++){for(x=0,j=h;j<m;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;j<m;j++)l[j][i]+=r*l[j][h]}for(p[h]=s,x=0,i=k;i<n;i++)x+=l[h][i]*l[h][i];if(x<=e)s=0;else{for(r=l[h][h+1],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h+1]=r-s,i=k;i<n;i++)o[i]=l[h][i]/t;for(i=k;i<m;i++){for(x=0,j=k;j<n;j++)x+=l[i][j]*l[h][j];for(j=k;j<n;j++)l[i][j]+=x*o[j]}}v=Math.abs(p[h])+Math.abs(o[h]),v>u&&(u=v)}for(h=n-1;-1!=h;h+=-1){if(0!=s){for(t=s*l[h][h+1],i=k;i<n;i++)q[i][h]=l[h][i]/t;for(i=k;i<n;i++){for(x=0,j=k;j<n;j++)x+=l[h][j]*q[j][i];for(j=k;j<n;j++)q[j][i]+=x*q[j][h]}}for(i=k;i<n;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,s=o[h],k=h}for(h=n-1;-1!=h;h+=-1){for(k=h+1,s=p[h],i=k;i<n;i++)l[h][i]=0;if(0!=s){for(t=l[h][h]*s,i=k;i<n;i++){for(x=0,j=k;j<m;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;j<m;j++)l[j][i]+=r*l[j][h]}for(i=h;i<m;i++)l[i][h]=l[i][h]/s}else for(i=h;i<m;i++)l[i][h]=0;l[h][h]+=1}for(d*=u,j=n-1;-1!=j;j+=-1)for(var y=0;y<f;y++){var z=!1;for(k=j;-1!=k;k+=-1){if(Math.abs(o[k])<=d){z=!0;break}if(Math.abs(p[k-1])<=d)break}if(!z){g=0,x=1;var A=k-1;for(h=k;h<j+1&&(r=x*o[h],o[h]=g*o[h],!(Math.abs(r)<=d));h++)for(s=p[h],t=b(r,s),p[h]=t,g=s/t,x=-r/t,i=0;i<m;i++)v=l[i][A],w=l[i][h],l[i][A]=v*g+w*x,l[i][h]=-v*x+w*g}if(w=p[j],k==j){if(w<0)for(p[j]=-w,i=0;i<n;i++)q[i][j]=-q[i][j];break}if(y>=f-1)throw"Error: no convergence.";for(u=p[k],v=p[j-1],s=o[j-1],t=o[j],r=((v-w)*(v+w)+(s-t)*(s+t))/(2*t*v),s=b(r,1),r=r<0?((u-w)*(u+w)+t*(v/(r-s)-t))/u:((u-w)*(u+w)+t*(v/(r+s)-t))/u,g=1,x=1,h=k+1;h<j+1;h++){for(s=o[h],v=p[h],t=x*s,s*=g,w=b(r,t),o[h-1]=w,g=r/w,x=t/w,r=u*g+s*x,s=-u*x+s*g,t=v*x,v*=g,i=0;i<n;i++)u=q[i][h-1],w=q[i][h],q[i][h-1]=u*g+w*x,q[i][h]=-u*x+w*g;for(w=b(r,t),p[h-1]=w,g=r/w,x=t/w,r=g*s+x*v,u=-x*s+g*v,i=0;i<m;i++)v=l[i][h-1],w=l[i][h],l[i][h-1]=v*g+w*x,l[i][h]=-v*x+w*g}o[k]=0,o[j]=r,p[j]=u}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;h<n;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){for(g=p[i],p[i]=p[h],p[h]=g,j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}}}(window)},{}],27:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<div class="container">\n  <div class="jumbotron">\n    <h1>Degust</h1>\n    <p><a href=\''+a.escapeExpression((f=null!=(f=c.home_link||(null!=b?b.home_link:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"home_link",hash:{},data:e}):f))+"'>Degust</a> failed to load your data :(</p>\n    <p>Error</p>\n    <div class='error-msg'></div>\n  </div>\n</div>\n"},useData:!0})},{"hbsfy/runtime":28}],26:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{},h=c.helperMissing,i="function",j=a.escapeExpression;return'    <div class="navbar navbar-inverse navbar-static-top">\n      <div class="container">\n        <div class="navbar-header">\n          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#right-navbar-collapse">\n            <span class="sr-only">Toggle navigation</span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n          </button>\n\n          <a class="navbar-brand" href="'+j((f=null!=(f=c.home_link||(null!=b?b.home_link:b))?f:h,typeof f===i?f.call(g,{name:"home_link",hash:{},data:e}):f))+"\">Degust : </a>\n          <span class=\"navbar-brand exp-name\"></span>\n        </div>\n\n        <ul class=\"nav navbar-nav navbar-right navbar-collapse collapse\" id=\"right-navbar-collapse\">\n          <li><a class=\"log-link\" href=\"#\">Logs</a>\n          <li><a id=\"tour\" href=\"#\">Tour</a>\n          <li><a class=\"config hide\" href=\"#\">Configure</a>\n          <li class=\"dropdown\">\n            <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">QC <span class=\"caret\"></span></a>\n            <ul class=\"dropdown-menu\">\n              <li><a href=\"#\" class='p-value-histogram'>P-value histogram</a></li>\n              <li><a href=\"#\" class='bargraph-libsize'>Library size</a></li>\n              <li><a href=\"#\" class='expression-boxplot'>Expression box-whisker</a></li>\n            </ul>\n          </li>\n          <li><a href=\"#about-modal\" data-toggle=\"modal\">About</a>\n        </ul>\n      </div>\n    </div>\n\n    <div class='log-list'>\n      <h4>Log messages</h4>\n    </div>\n\n    <div class='container'>\n      <div class='right'>\n        <ul class=\"nav nav-tabs\">\n          <li id='select-options'><a href=\"#\">Options</a></li>\n          <li id='select-single-gene-expr'><a href=\"#\">Gene</a></li>\n        </ul>\n\n        <div class='single-gene-expr'>\n        </div>\n\n        <div class='filter options'>\n          <h4>Options</h4>\n          <div title='Filter genes by False Discovery Rate' data-placement='left'>\n            <label>FDR cut-off</label>\n            <input class=\"fdr-fld\" type=\"text\" value=\"0.01\" />\n            <div id='fdrSlider'></div>\n            <span class=\"dropdown\">\n              <button class=\"btn-link dropdown-toggle\" type=\"button\" id=\"dropFDR\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu shortcut-fdr\" aria-labelledby=\"dropFDR\">\n                <li><a href=\"#\" data-val='1'>1</a></li>\n                <li><a href=\"#\" data-val='0.05'>0.05</a></li>\n                <li><a href=\"#\" data-val='0.01'>0.01</a></li>\n                <li><a href=\"#\" data-val='0.001'>0.001</a></li>\n                <li><a href=\"#\" data-val='0.0001'>0.0001</a></li>\n              </ul>\n            </span>\n          </div>\n          <div title='Filter genes by absolute log fold change between any pair of samples' data-placement='left'>\n            <label>abs log FC</label>\n            <input class=\"fc-fld\" type=\"text\" value=\"0\" />\n            <div id='fcSlider'></div>\n            <span class=\"dropdown\">\n              <button class=\"btn-link dropdown-toggle\" type=\"button\" id=\"dropFC\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu shortcut-fc\" aria-labelledby=\"dropFC\">\n                <li><a href=\"#\" data-val='0'>0 (all)</a></li>\n                <li><a href=\"#\" data-val='0.585'>0.585 (&gt; 1.5x)</a></li>\n                <li><a href=\"#\" data-val='1'>1 (&gt; 2x)</a></li>\n                <li><a href=\"#\" data-val='2'>2 (&gt; 4x)</a></li>\n                <li><a href=\"#\" data-val='3'>3 (&gt; 8x)</a></li>\n                <li><a href=\"#\" data-val='4'>4 (&gt; 16x)</a></li>\n              </ul>\n            </span>\n          </div>\n          <div title='Show FC from selected condition' data-placement='left'>\n            <label for='fc-relative'>FC relative to</label>\n            <select id='fc-relative'></select>\n          </div>\n          <div title='FC for the MA-plot' data-placement='left' class='ma-fc-col-opt'>\n            <label for='ma-fc-col'>MA-Plot FC</label>\n            <select id='ma-fc-col'></select>\n          </div>\n          <div title='Show raw counts (or counts-per-million) in the table' data-placement='left' class='show-counts-opt'>\n            <label for='show-counts'>Show Counts</label>\n            <select id='show-counts'>\n              <option value='no'>No</option>\n              <option value='yes'>Yes</option>\n              <option value='cpm'>As counts-per-million</option>\n            </select>\n          </div>\n          <div class='pca-opts'>\n            <div class='pca-title'>MDS options</div>\n            <div title='Number of genes to use for the MDS plot' data-placement='left' class='pca-num-genes-opt'>\n              <label>Num genes</label>\n              <input class=\"num-genes-fld\" type=\"text\" value=\"50\" />\n              <div id='numGenesSlider'></div>\n            </div>\n            <div title='Number of genes to ignore for the MDS plot' data-placement='left' class='pca-skip-genes-opt'>\n              <label>Skip genes</label>\n              <input class=\"skip-genes-fld\" type=\"text\" value=\"50\" />\n              <div id='skipGenesSlider'></div>\n            </div>\n            <div title='MDS dimensions to plot' data-placement='left' class='pca-dims-opt'>\n              <label>Dimensions</label>\n              <input class=\"pca-dims-fld\" type=\"text\" value=\"50\" disabled />\n              <div id='pcaDimsSlider'></div>\n            </div>\n            <div title='MDS in 2d or 3d' data-placement='left' class='mds-2d3d-opt'>\n              <label for='mds-2d3d'>MDS plot</label>\n              <select id='mds-2d3d'>\n                <option value='2d'>2d</option>\n                <option value='3d'>3d</option>\n              </select>\n            </div>\n          </div>\x3c!-- div.pca-opts --\x3e\n        </div>\n\n        <div class='filter kegg-filter'>\n          <h4>Kegg Pathway</h4>\n          <select id='kegg'></select>\n        </div>\n\n        <div class='text-right'>\n          <a class=\"genesets-toggle\" role=\"button\" data-toggle=\"collapse\" href=\"#genesets\" aria-expanded=\"false\" aria-controls=\"genesets\">\n              Gene Sets\n          </a>\n        </div>\n        <div class=\"collapse\" id=\"genesets\">\n          <div class='filter'>\n            <h4>Gene Sets</h4>\n            <a class='btn btn-primary btn-xs geneset-save'>Save Current as Gene Set</a>\n            <div class=\"geneset-search\">\n              <label>Search</label>\n              <input type=\"text\" class='search' />\n            </div>\n          </div>\n        </div>\n\n        <div class='text-right'>\n          <a class='show-r-code' href='#'>Show R code</a>\n        </div>\n\n        <div class='text-right'>\n          <a class='update-link' href='#'>Update Link</a>\n        </div>\n\n        <div class='text-right'>\n          <a class='show-heatmap' href='#'>Show heatmap</a>\n        </div>\n      </div>\n\n      <div class='row'>\n        <div class='col-xs-2 conditions'>\n          <h3>Conditions</h3>\n          <div id='files'></div>\n          <div id='hidden-factors'><h4>Hidden Factors</h4></div>\n          <label for='dge-method'>Method</label>\n          <select id='dge-method'>\n            <option value='voom'>Voom/Limma</option>\n            <option value='edgeR-quasi'>edgeR quasi-likelihood</option>\n            <option value='edgeR'>edgeR</option>\n            <option value='voom-weights'>Voom (sample weights)</option>\n          </select>\n          <a class=\"weights-toggle\" role=\"button\" data-toggle=\"collapse\" href=\".weights\" aria-expanded=\"false\" aria-controls=\"genesets\">\n            Sample weights\n          </a>\n          <div class='weights collapse'>\n          </div>\n        </div>\n\n        <div class='col-xs-6' id='expression'>\n          <div id='loading'><img src='"+j((f=null!=(f=c.asset_base||(null!=b?b.asset_base:b))?f:h,typeof f===i?f.call(g,{name:"asset_base",hash:{},data:e}):f))+"images/ajax-loader.gif'></div>\n          <ul class=\"nav nav-tabs\">\n            <li id='select-pc'><a href=\"#\">Parallel Coordinates</a></li>\n            <li id='select-ma'><a href=\"#\">MA plot</a></li>\n            <li id='select-pca'><a href=\"#\">MDS plot</a></li>\n            <li id='select-volcano'><a href=\"#\">Volcano</a></li>\n          </ul>\n          <div id=\"dge-pc\" class=\"parcoords\"></div>\n          <div id=\"dge-ma\" class=\"dge-ma\"></div>\n          <div id=\"dge-pca\"></div>\n          <div id=\"dge-volcano\" class=\"dge-ma\"></div>\n        </div>\x3c!-- expression --\x3e\n      </div>\x3c!-- row --\x3e\n\n      <div class='row'>\n        <div id=\"heatmap-info\"></div>\n        <div id='heatmap'></div>\n      </div>\n\n      <div class='row'>\n        <h2>Genes</h2>\n        <div>\n          <div class=\"tab-search\">\n            Search:\n            <input type=\"text\">\n            <span class='glyphicon glyphicon-cog gene-table-settings'></span>\n          </div>\n          <div id='csv-download-div'>\n            <a id='csv-download' href='#'>Download CSV</a>\n            <span class=\"dropdown\">\n                <button class=\"btn-link dropdown-toggle\" type=\"button\" id=\"dropDownload\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                  <span class=\"caret\"></span>\n                </button>\n              <ul class=\"dropdown-menu download\" aria-labelledby=\"dropDownload\">\n                <li><a href=\"#\" class='download-csv'>Download as CSV</a></li>\n                <li><a href=\"#\" class='download-tsv'>Download as TSV</a></li>\n                <li><a href=\"#\" class='download-odf'>Download as ODF</a></li>\n              <ul>\n            </span>\n          </div>\n          <div id=\"grid-info\"></div>\n        </div>\n        <div id=\"grid\"></div>\n        <div id=\"gene-info\"></div>\n      </div>\n\n    </div>\n\n    <div id='kegg-image'></div>\n\n    \x3c!-- About box Modal --\x3e\n    <div id=\"about-modal\"></div>\n\n    \x3c!-- Error box Modal --\x3e\n    <div id='error-modal' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>\n      <div class='modal-dialog'>\n        <div class='modal-content'>\n          <div class='modal-header'>\n            <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>x</button>\n            <h3>Error</h3>\n          </div>\n          <div class='modal-body'>\n            Error Message:\n            <pre class='error-msg'></pre>\n            Input:\n            <pre class='error-input'></pre>\n          </div>\n          <div class='modal-footer'>\n            <button class='btn btn-primary' data-dismiss='modal' aria-hidden='true'>Close</button>\n          </div>\n        </div>\x3c!-- /.modal-content --\x3e\n      </div>\x3c!-- /.modal-dialog --\x3e\n    </div>\x3c!-- /.modal --\x3e\n\n    \x3c!-- Modal for showing R code --\x3e\n    <div id='code-modal' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>\n      <div class='modal-dialog'>\n        <div class='modal-content'>\n          <div class='modal-header'>\n            <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>x</button>\n            <h3>DGE R Code</h3>\n          </div>\n          <div class='modal-body'>\n            This is the R code the backend used to perform the DGE analysis for the current page.\n            <pre class='r-code'>\n            </pre>\n          </div>\n          <div class='modal-footer'>\n            <button class='btn btn-primary' data-dismiss='modal' aria-hidden='true'>Close</button>\n          </div>\n        </div>\x3c!-- /.modal-content --\x3e\n      </div>\x3c!-- /.modal-dialog --\x3e\n    </div>\x3c!-- /.modal --\x3e\n"},useData:!0})},{"hbsfy/runtime":28}],23:[function(a,b,c){
b.exports=["#000004","#010005","#010106","#010108","#02010a","#02020c","#02020e","#030210","#040312","#040314","#050417","#060419","#07051b","#08051d","#09061f","#0a0722","#0b0724","#0c0826","#0d0829","#0e092b","#10092d","#110a30","#120a32","#140b34","#150b37","#160b39","#180c3c","#190c3e","#1b0c41","#1c0c43","#1e0c45","#1f0c48","#210c4a","#230c4c","#240c4f","#260c51","#280b53","#290b55","#2b0b57","#2d0b59","#2f0a5b","#310a5c","#320a5e","#340a5f","#360961","#380962","#390963","#3b0964","#3d0965","#3e0966","#400a67","#420a68","#440a68","#450a69","#470b6a","#490b6a","#4a0c6b","#4c0c6b","#4d0d6c","#4f0d6c","#510e6c","#520e6d","#540f6d","#550f6d","#57106e","#59106e","#5a116e","#5c126e","#5d126e","#5f136e","#61136e","#62146e","#64156e","#65156e","#67166e","#69166e","#6a176e","#6c186e","#6d186e","#6f196e","#71196e","#721a6e","#741a6e","#751b6e","#771c6d","#781c6d","#7a1d6d","#7c1d6d","#7d1e6d","#7f1e6c","#801f6c","#82206c","#84206b","#85216b","#87216b","#88226a","#8a226a","#8c2369","#8d2369","#8f2469","#902568","#922568","#932667","#952667","#972766","#982766","#9a2865","#9b2964","#9d2964","#9f2a63","#a02a63","#a22b62","#a32c61","#a52c60","#a62d60","#a82e5f","#a92e5e","#ab2f5e","#ad305d","#ae305c","#b0315b","#b1325a","#b3325a","#b43359","#b63458","#b73557","#b93556","#ba3655","#bc3754","#bd3853","#bf3952","#c03a51","#c13a50","#c33b4f","#c43c4e","#c63d4d","#c73e4c","#c83f4b","#ca404a","#cb4149","#cc4248","#ce4347","#cf4446","#d04545","#d24644","#d34743","#d44842","#d54a41","#d74b3f","#d84c3e","#d94d3d","#da4e3c","#db503b","#dd513a","#de5238","#df5337","#e05536","#e15635","#e25734","#e35933","#e45a31","#e55c30","#e65d2f","#e75e2e","#e8602d","#e9612b","#ea632a","#eb6429","#eb6628","#ec6726","#ed6925","#ee6a24","#ef6c23","#ef6e21","#f06f20","#f1711f","#f1731d","#f2741c","#f3761b","#f37819","#f47918","#f57b17","#f57d15","#f67e14","#f68013","#f78212","#f78410","#f8850f","#f8870e","#f8890c","#f98b0b","#f98c0a","#f98e09","#fa9008","#fa9207","#fa9407","#fb9606","#fb9706","#fb9906","#fb9b06","#fb9d07","#fc9f07","#fca108","#fca309","#fca50a","#fca60c","#fca80d","#fcaa0f","#fcac11","#fcae12","#fcb014","#fcb216","#fcb418","#fbb61a","#fbb81d","#fbba1f","#fbbc21","#fbbe23","#fac026","#fac228","#fac42a","#fac62d","#f9c72f","#f9c932","#f9cb35","#f8cd37","#f8cf3a","#f7d13d","#f7d340","#f6d543","#f6d746","#f5d949","#f5db4c","#f4dd4f","#f4df53","#f4e156","#f3e35a","#f3e55d","#f2e661","#f2e865","#f2ea69","#f1ec6d","#f1ed71","#f1ef75","#f1f179","#f2f27d","#f2f482","#f3f586","#f3f68a","#f4f88e","#f5f992","#f6fa96","#f8fb9a","#f9fc9d","#fafda1","#fcffa4"]},{}],24:[function(a,b,c){b.exports=["#000004","#010005","#010106","#010108","#020109","#02020b","#02020d","#03030f","#030312","#040414","#050416","#060518","#06051a","#07061c","#08071e","#090720","#0a0822","#0b0924","#0c0926","#0d0a29","#0e0b2b","#100b2d","#110c2f","#120d31","#130d34","#140e36","#150e38","#160f3b","#180f3d","#19103f","#1a1042","#1c1044","#1d1147","#1e1149","#20114b","#21114e","#221150","#241253","#251255","#271258","#29115a","#2a115c","#2c115f","#2d1161","#2f1163","#311165","#331067","#341069","#36106b","#38106c","#390f6e","#3b0f70","#3d0f71","#3f0f72","#400f74","#420f75","#440f76","#451077","#471078","#491078","#4a1079","#4c117a","#4e117b","#4f127b","#51127c","#52137c","#54137d","#56147d","#57157e","#59157e","#5a167e","#5c167f","#5d177f","#5f187f","#601880","#621980","#641a80","#651a80","#671b80","#681c81","#6a1c81","#6b1d81","#6d1d81","#6e1e81","#701f81","#721f81","#732081","#752181","#762181","#782281","#792282","#7b2382","#7c2382","#7e2482","#802582","#812581","#832681","#842681","#862781","#882781","#892881","#8b2981","#8c2981","#8e2a81","#902a81","#912b81","#932b80","#942c80","#962c80","#982d80","#992d80","#9b2e7f","#9c2e7f","#9e2f7f","#a02f7f","#a1307e","#a3307e","#a5317e","#a6317d","#a8327d","#aa337d","#ab337c","#ad347c","#ae347b","#b0357b","#b2357b","#b3367a","#b5367a","#b73779","#b83779","#ba3878","#bc3978","#bd3977","#bf3a77","#c03a76","#c23b75","#c43c75","#c53c74","#c73d73","#c83e73","#ca3e72","#cc3f71","#cd4071","#cf4070","#d0416f","#d2426f","#d3436e","#d5446d","#d6456c","#d8456c","#d9466b","#db476a","#dc4869","#de4968","#df4a68","#e04c67","#e24d66","#e34e65","#e44f64","#e55064","#e75263","#e85362","#e95462","#ea5661","#eb5760","#ec5860","#ed5a5f","#ee5b5e","#ef5d5e","#f05f5e","#f1605d","#f2625d","#f2645c","#f3655c","#f4675c","#f4695c","#f56b5c","#f66c5c","#f66e5c","#f7705c","#f7725c","#f8745c","#f8765c","#f9785d","#f9795d","#f97b5d","#fa7d5e","#fa7f5e","#fa815f","#fb835f","#fb8560","#fb8761","#fc8961","#fc8a62","#fc8c63","#fc8e64","#fc9065","#fd9266","#fd9467","#fd9668","#fd9869","#fd9a6a","#fd9b6b","#fe9d6c","#fe9f6d","#fea16e","#fea36f","#fea571","#fea772","#fea973","#feaa74","#feac76","#feae77","#feb078","#feb27a","#feb47b","#feb67c","#feb77e","#feb97f","#febb81","#febd82","#febf84","#fec185","#fec287","#fec488","#fec68a","#fec88c","#feca8d","#fecc8f","#fecd90","#fecf92","#fed194","#fed395","#fed597","#fed799","#fed89a","#fdda9c","#fddc9e","#fddea0","#fde0a1","#fde2a3","#fde3a5","#fde5a7","#fde7a9","#fde9aa","#fdebac","#fcecae","#fceeb0","#fcf0b2","#fcf2b4","#fcf4b6","#fcf6b8","#fcf7b9","#fcf9bb","#fcfbbd","#fcfdbf"]},{}],25:[function(a,b,c){b.exports=["#0d0887","#100788","#130789","#16078a","#19068c","#1b068d","#1d068e","#20068f","#220690","#240691","#260591","#280592","#2a0593","#2c0594","#2e0595","#2f0596","#310597","#330597","#350498","#370499","#38049a","#3a049a","#3c049b","#3e049c","#3f049c","#41049d","#43039e","#44039e","#46039f","#48039f","#4903a0","#4b03a1","#4c02a1","#4e02a2","#5002a2","#5102a3","#5302a3","#5502a4","#5601a4","#5801a4","#5901a5","#5b01a5","#5c01a6","#5e01a6","#6001a6","#6100a7","#6300a7","#6400a7","#6600a7","#6700a8","#6900a8","#6a00a8","#6c00a8","#6e00a8","#6f00a8","#7100a8","#7201a8","#7401a8","#7501a8","#7701a8","#7801a8","#7a02a8","#7b02a8","#7d03a8","#7e03a8","#8004a8","#8104a7","#8305a7","#8405a7","#8606a6","#8707a6","#8808a6","#8a09a5","#8b0aa5","#8d0ba5","#8e0ca4","#8f0da4","#910ea3","#920fa3","#9410a2","#9511a1","#9613a1","#9814a0","#99159f","#9a169f","#9c179e","#9d189d","#9e199d","#a01a9c","#a11b9b","#a21d9a","#a31e9a","#a51f99","#a62098","#a72197","#a82296","#aa2395","#ab2494","#ac2694","#ad2793","#ae2892","#b02991","#b12a90","#b22b8f","#b32c8e","#b42e8d","#b52f8c","#b6308b","#b7318a","#b83289","#ba3388","#bb3488","#bc3587","#bd3786","#be3885","#bf3984","#c03a83","#c13b82","#c23c81","#c33d80","#c43e7f","#c5407e","#c6417d","#c7427c","#c8437b","#c9447a","#ca457a","#cb4679","#cc4778","#cc4977","#cd4a76","#ce4b75","#cf4c74","#d04d73","#d14e72","#d24f71","#d35171","#d45270","#d5536f","#d5546e","#d6556d","#d7566c","#d8576b","#d9586a","#da5a6a","#da5b69","#db5c68","#dc5d67","#dd5e66","#de5f65","#de6164","#df6263","#e06363","#e16462","#e26561","#e26660","#e3685f","#e4695e","#e56a5d","#e56b5d","#e66c5c","#e76e5b","#e76f5a","#e87059","#e97158","#e97257","#ea7457","#eb7556","#eb7655","#ec7754","#ed7953","#ed7a52","#ee7b51","#ef7c51","#ef7e50","#f07f4f","#f0804e","#f1814d","#f1834c","#f2844b","#f3854b","#f3874a","#f48849","#f48948","#f58b47","#f58c46","#f68d45","#f68f44","#f79044","#f79143","#f79342","#f89441","#f89540","#f9973f","#f9983e","#f99a3e","#fa9b3d","#fa9c3c","#fa9e3b","#fb9f3a","#fba139","#fba238","#fca338","#fca537","#fca636","#fca835","#fca934","#fdab33","#fdac33","#fdae32","#fdaf31","#fdb130","#fdb22f","#fdb42f","#fdb52e","#feb72d","#feb82c","#feba2c","#febb2b","#febd2a","#febe2a","#fec029","#fdc229","#fdc328","#fdc527","#fdc627","#fdc827","#fdca26","#fdcb26","#fccd25","#fcce25","#fcd025","#fcd225","#fbd324","#fbd524","#fbd724","#fad824","#fada24","#f9dc24","#f9dd25","#f8df25","#f8e125","#f7e225","#f7e425","#f6e626","#f6e826","#f5e926","#f5eb27","#f4ed27","#f3ee27","#f3f027","#f2f227","#f1f426","#f1f525","#f0f724","#f0f921"]},{}],22:[function(a,b,c){b.exports=["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"]},{}],28:[function(a,b,c){b.exports=a("handlebars/runtime").default},{"handlebars/runtime":29}],29:[function(a,b,c){b.exports=a("./dist/cjs/handlebars.runtime").default},{"./dist/cjs/handlebars.runtime":30}],30:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j.default,a.Exception=l.default,a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}c.__esModule=!0;var g=a("./handlebars/base"),h=e(g),i=a("./handlebars/safe-string"),j=d(i),k=a("./handlebars/exception"),l=d(k),m=a("./handlebars/utils"),n=e(m),o=a("./handlebars/runtime"),p=e(o),q=a("./handlebars/no-conflict"),r=d(q),s=f();s.create=f,r.default(s),s.default=s,c.default=s,b.exports=c.default},{"./handlebars/base":31,"./handlebars/safe-string":32,"./handlebars/exception":33,"./handlebars/utils":34,"./handlebars/runtime":35,"./handlebars/no-conflict":36}],32:[function(a,b,c){"use strict";function d(a){this.string=a}c.__esModule=!0,d.prototype.toString=d.prototype.toHTML=function(){return""+this.string},c.default=d,b.exports=c.default},{}],33:[function(a,b,c){"use strict";function d(a,b){var c=b&&b.loc,f=void 0,g=void 0;c&&(f=c.start.line,g=c.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<e.length;i++)this[e[i]]=h[e[i]];Error.captureStackTrace&&Error.captureStackTrace(this,d);try{c&&(this.lineNumber=f,Object.defineProperty?Object.defineProperty(this,"column",{value:g,enumerable:!0}):this.column=g)}catch(j){}}c.__esModule=!0;var e=["description","fileName","lineNumber","message","name","number","stack"];d.prototype=new Error,c.default=d,b.exports=c.default},{}],34:[function(a,b,c){"use strict";function d(a){return l[a]}function e(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function f(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function g(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return n.test(a)?a.replace(m,d):a}function h(a){return!a&&0!==a||!(!q(a)||0!==a.length)}function i(a){var b=e({},a);return b._parent=a,b}function j(a,b){return a.path=b,a}function k(a,b){return(a?a+".":"")+b}c.__esModule=!0,c.extend=e,c.indexOf=f,c.escapeExpression=g,c.isEmpty=h,c.createFrame=i,c.blockParams=j,c.appendContextPath=k;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},m=/[&<>"'`=]/g,n=/[&<>"'`=]/,o=Object.prototype.toString;c.toString=o;var p=function(a){return"function"==typeof a};p(/x/)&&(c.isFunction=p=function(a){return"function"==typeof a&&"[object Function]"===o.call(a)}),c.isFunction=p;var q=Array.isArray||function(a){return!(!a||"object"!=typeof a)&&"[object Array]"===o.call(a)};c.isArray=q},{}],36:[function(a,b,c){!function(a){"use strict";c.__esModule=!0,c.default=function(b){var c=void 0!==a?a:window,d=c.Handlebars;b.noConflict=function(){return c.Handlebars===b&&(c.Handlebars=d),b}},b.exports=c.default}(window)},{}],31:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}c.__esModule=!0,c.HandlebarsEnvironment=e;var f=a("./utils"),g=a("./exception"),h=d(g),i=a("./helpers"),j=a("./decorators"),k=a("./logger"),l=d(k);c.VERSION="4.0.11",c.COMPILER_REVISION=7;var m={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};c.REVISION_CHANGES=m;var n="[object Object]";e.prototype={constructor:e,logger:l.default,log:l.default.log,registerHelper:function(a,b){if(f.toString.call(a)===n){if(b)throw new h.default("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(f.toString.call(a)===n)f.extend(this.partials,a);else{if(void 0===b)throw new h.default('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if(f.toString.call(a)===n){if(b)throw new h.default("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]}};var o=l.default.log;c.log=o,c.createFrame=f.createFrame,c.logger=l.default},{"./utils":34,"./exception":33,"./helpers":37,"./decorators":38,"./logger":39}],35:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function f(a){var b=a&&a[0]||1,c=r.COMPILER_REVISION;if(b!==c){if(b<c){var d=r.REVISION_CHANGES[c],e=r.REVISION_CHANGES[b];throw new q.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new q.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function g(a,b){function c(c,d,e){e.hash&&(d=o.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;h<i&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new q.default("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(e,b,e.helpers,e.partials,g,i,h)}var f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=f.data;d._setup(f),!f.partial&&a.useData&&(g=l(b,g));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=f.depths?b!=f.depths[0]?[b].concat(f.depths):f.depths:[b]),(c=m(a.main,c,e,f.depths||[],g,i))(b,f)}if(!b)throw new q.default("No environment passed to template");if(!a||!a.main)throw new q.default("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new q.default('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:o.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var f=this.programs[a],g=this.fn(a);return b||e||d||c?f=h(this,a,g,b,c,d,e):f||(f=this.programs[a]=h(this,a,g)),f},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=o.extend({},b,a)),c},nullContext:Object.seal({}),noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials,e.decorators=c.decorators):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(e.decorators=e.merge(c.decorators,b.decorators)))},d._child=function(b,c,d,f){if(a.useBlockParams&&!d)throw new q.default("must pass block params");if(a.useDepths&&!f)throw new q.default("must pass parent depths");return h(e,b,a[b],c,0,d,f)},d}function h(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return!g||b==g[0]||b===a.nullContext&&null===g[0]||(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=m(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function i(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function j(a,b,c){var d=c.data&&c.data["partial-block"];c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var e=void 0;if(c.fn&&c.fn!==k&&function(){c.data=r.createFrame(c.data);var a=c.fn;e=c.data["partial-block"]=function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return c.data=r.createFrame(c.data),c.data["partial-block"]=d,a(b,c)},a.partials&&(c.partials=o.extend({},c.partials,a.partials))}(),void 0===a&&e&&(a=e),void 0===a)throw new q.default("The partial "+c.name+" could not be found");if(a instanceof Function)return a(b,c)}function k(){return""}function l(a,b){return b&&"root"in b||(b=b?r.createFrame(b):{},b.root=a),b}function m(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),o.extend(b,g)}return b}c.__esModule=!0,c.checkRevision=f,c.template=g,c.wrapProgram=h,c.resolvePartial=i,c.invokePartial=j,c.noop=k;var n=a("./utils"),o=e(n),p=a("./exception"),q=d(p),r=a("./base")},{"./utils":34,"./exception":33,"./base":31}],37:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){g.default(a),i.default(a),k.default(a),m.default(a),o.default(a),q.default(a),s.default(a)}c.__esModule=!0,c.registerDefaultHelpers=e;var f=a("./helpers/block-helper-missing"),g=d(f),h=a("./helpers/each"),i=d(h),j=a("./helpers/helper-missing"),k=d(j),l=a("./helpers/if"),m=d(l),n=a("./helpers/log"),o=d(n),p=a("./helpers/lookup"),q=d(p),r=a("./helpers/with"),s=d(r)},{"./helpers/block-helper-missing":40,"./helpers/each":41,"./helpers/helper-missing":42,"./helpers/if":43,"./helpers/log":44,"./helpers/lookup":45,"./helpers/with":46}],39:[function(a,b,c){"use strict";c.__esModule=!0;var d=a("./utils"),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};c.default=e,b.exports=c.default},{"./utils":34}],38:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){g.default(a)}c.__esModule=!0,c.registerDefaultDecorators=e;var f=a("./decorators/inline"),g=d(f)},{"./decorators/inline":47}],44:[function(a,b,c){"use strict";c.__esModule=!0,c.default=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},b.exports=c.default},{}],45:[function(a,b,c){"use strict";c.__esModule=!0,c.default=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})},b.exports=c.default},{}],40:[function(a,b,c){"use strict";c.__esModule=!0;var d=a("../utils");c.default=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(!0===b)return f(this);if(!1===b||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},b.exports=c.default},{"../utils":34}],42:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../exception"),f=d(e);c.default=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},b.exports=c.default},{"../exception":33}],43:[function(a,b,c){"use strict";c.__esModule=!0;var d=a("../utils");c.default=function(a){a.registerHelper("if",function(a,b){return d.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||d.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers.if.call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},b.exports=c.default},{"../utils":34}],46:[function(a,b,c){"use strict";c.__esModule=!0;var d=a("../utils");c.default=function(a){a.registerHelper("with",function(a,b){d.isFunction(a)&&(a=a.call(this));var c=b.fn;if(d.isEmpty(a))return b.inverse(this);var e=b.data;return b.data&&b.ids&&(e=d.createFrame(b.data),e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})})},b.exports=c.default},{"../utils":34}],41:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../utils"),f=a("../exception"),g=d(f);c.default=function(a){a.registerHelper("each",function(a,b){function c(b,c,f){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!f,k&&(j.contextPath=k+b)),i+=d(a[b],{data:j,blockParams:e.blockParams([a[b],b],[k+b,null])})}if(!b)throw new g.default("Must pass iterator to #each");var d=b.fn,f=b.inverse,h=0,i="",j=void 0,k=void 0;if(b.data&&b.ids&&(k=e.appendContextPath(b.data.contextPath,b.ids[0])+"."),e.isFunction(a)&&(a=a.call(this)),b.data&&(j=e.createFrame(b.data)),a&&"object"==typeof a)if(e.isArray(a))for(var l=a.length;h<l;h++)h in a&&c(h,h,h===a.length-1);else{var m=void 0;for(var n in a)a.hasOwnProperty(n)&&(void 0!==m&&c(m,h-1),m=n,h++);void 0!==m&&c(m,h-1,!0)}return 0===h&&(i=f(this)),i})},b.exports=c.default},{"../utils":34,"../exception":33}],47:[function(a,b,c){"use strict";c.__esModule=!0;var d=a("../utils");c.default=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},b.exports=c.default},{"../utils":34}]},{},[1]);